<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Vers une Mesure Continue de l’identité de Genre – Pascaline Vincent</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-cc63fce9873912f1bbbccf05079cc9ea.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="custom.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Pascaline Vincent</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Accueil</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-enseignements" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Enseignements</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-enseignements">    
        <li>
    <a class="dropdown-item" href="../enseignements/eco_co_chapitre_1.html">
 <span class="dropdown-text">Economie Contemporaine L1 (CM)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../blog/index.html">
 <span class="dropdown-text"><em>Ressources pour Eco Contemporaine</em></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../enseignements/HE.html">
 <span class="dropdown-text">Histoire économique L1 (CM)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../enseignements/micro.html">
 <span class="dropdown-text">Intro à la Microéconomie L1 (TD)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../enseignements/eco_w.html">
 <span class="dropdown-text">Economie du travail L3 (TD)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-recherche" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Recherche</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-recherche">    
        <li>
    <a class="dropdown-item" href="../recherche/recherche_presentation.html">
 <span class="dropdown-text">Présentation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../normes_identite/CGNI.html">
 <span class="dropdown-text">Travail en cours</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#utilité-et-identité" id="toc-utilité-et-identité" class="nav-link" data-scroll-target="#utilité-et-identité">Utilité et Identité</a></li>
  <li><a href="#modèle-avec-identité" id="toc-modèle-avec-identité" class="nav-link" data-scroll-target="#modèle-avec-identité">Modèle avec Identité</a></li>
  <li><a href="#identité-et-choix-des-individus" id="toc-identité-et-choix-des-individus" class="nav-link" data-scroll-target="#identité-et-choix-des-individus">Identité et choix des individus</a></li>
  <li><a href="#identité-et-performances" id="toc-identité-et-performances" class="nav-link" data-scroll-target="#identité-et-performances">Identité et Performances</a>
  <ul class="collapse">
  <li><a href="#pratiques-culturelles-et-genre" id="toc-pratiques-culturelles-et-genre" class="nav-link" data-scroll-target="#pratiques-culturelles-et-genre">Pratiques culturelles et Genre ?</a></li>
  <li><a href="#construction-de-notre-indice" id="toc-construction-de-notre-indice" class="nav-link" data-scroll-target="#construction-de-notre-indice">Construction de notre indice</a></li>
  <li><a href="#description-de-lindice" id="toc-description-de-lindice" class="nav-link" data-scroll-target="#description-de-lindice">Description de l’indice</a></li>
  <li><a href="#robustesse" id="toc-robustesse" class="nav-link" data-scroll-target="#robustesse">Robustesse</a></li>
  <li><a href="#comparaisons-avec-dautres-mesures" id="toc-comparaisons-avec-dautres-mesures" class="nav-link" data-scroll-target="#comparaisons-avec-dautres-mesures">Comparaisons avec d’autres mesures ?</a></li>
  </ul></li>
  <li><a href="#variables-socio-économiques-et-identité-de-genre" id="toc-variables-socio-économiques-et-identité-de-genre" class="nav-link" data-scroll-target="#variables-socio-économiques-et-identité-de-genre">Variables socio-économiques et identité de genre</a>
  <ul class="collapse">
  <li><a href="#distance-à-la-norme" id="toc-distance-à-la-norme" class="nav-link" data-scroll-target="#distance-à-la-norme">Distance à la norme</a></li>
  <li><a href="#distance-aux-normes-et-satisfaction" id="toc-distance-aux-normes-et-satisfaction" class="nav-link" data-scroll-target="#distance-aux-normes-et-satisfaction">Distance aux normes et satisfaction</a></li>
  </ul></li>
  <li><a href="#indice-alternatif" id="toc-indice-alternatif" class="nav-link" data-scroll-target="#indice-alternatif">Indice Alternatif</a></li>
  <li><a href="#score-distance-à-la-norme" id="toc-score-distance-à-la-norme" class="nav-link" data-scroll-target="#score-distance-à-la-norme">Score-Distance à la norme</a></li>
  <li><a href="#lasso-2" id="toc-lasso-2" class="nav-link" data-scroll-target="#lasso-2">LASSO 2</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Vers une Mesure Continue de l’identité de Genre</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Avec ses cheveux courts, lors de son élection, miss France 2024 a défrayé la chronique.</p>
<p>Au vue des réactions épidermiques, la dunkerquoise Eve Gilles semblait transgresser là une norme de genre instituée.</p>
<p>Avec cet exemple, qui peut sembler trivial, nous souhaitons aborder la question fondamentale de l’identité, et plus spécifiquement, de l’identité de genre.</p>
<p>L’identité peut être définie comme le sentiment que l’on a de soi (“A person’ sense of self”) , c’est une notion multiple, protéiforme, difficile à appréhender et plus encore: à mesurer.</p>
<p>Mais pourquoi les économistes devraient-ils s’intéresser à cette variable identité?</p>
<p>Comment et pourquoi intègrent-ils cette notion dans leurs modèles?</p>
<p>Si la nécessité de proposer des modèles intégrant cette variable nous semble pertinente, vient alors la question de la difficile mesure de ce concept fondamental.</p>
<p>Enfin, quelles répercussions socio-économiques peut-on observer à travers la mise en lien de cette mesure de l’identité et des variables économiques?</p>
<p>L’économie de l’identité est un courant récent de la discipline.</p>
<p>Les travaux fondateurs d’ Akerlof et Kranton (<span class="citation" data-cites="akerlof_economics_2000">George A. Akerlof and Kranton (<a href="#ref-akerlof_economics_2000" role="doc-biblioref">2000b</a>)</span> ) ont mis en lumière la nécessité d’intégrer dans les modèles économiques traditionnels cette notion fondamentale qu’est l’identité.</p>
<section id="utilité-et-identité" class="level2">
<h2 class="anchored" data-anchor-id="utilité-et-identité">Utilité et Identité</h2>
<p>Pour un économiste, le concept d’utilité est central. Il s’agit d’une mesure de la satisfaction individuelle.</p>
<p>Un individu, par exemple un consommateur, réalise ses choix en fonction du niveau de satisfaction qu’il peut retirer. C’est son objectif, modélisé sous forme de fonction.</p>
<p>Dans les modèles traditionnels, l’utilité dépend de quelques variables objectives, qui ont l’intérêt d’être mesurables.</p>
<p>Par exemple, pour un consommateur, <span class="math inline">\(U=F(x,y)\)</span> , où <span class="math inline">\(x\)</span> et <span class="math inline">\(y\)</span> sont les quantités de biens consommées.</p>
<p>L’apport d’Akerlof et Kranton, est d’indiquer que les choix des individus sont influencés par le sentiment qu’ils ont d’eux même, leur identité.</p>
<p>Enrichir les modèles traditionnels de cette nouvelle variable permettrait de mieux comprendre ce qui parfois échappe à la théorie classique.</p>
</section>
<section id="modèle-avec-identité" class="level2">
<h2 class="anchored" data-anchor-id="modèle-avec-identité">Modèle avec Identité</h2>
<p>Reprenons ici le modèle proposé par Akerlof et Kranton,</p>
<p>la fonction d’utilité d’un individu est la suivante:</p>
<p><span class="math inline">\(U_j = U_j(a_j, a_j I_j)\)</span></p>
<p>où :</p>
<ul>
<li><p><span class="math inline">\(a_j\)</span> représente les actions de l’individu <span class="math inline">\(j\)</span></p></li>
<li><p><span class="math inline">\(a_j\)</span> <span class="math inline">\(I_j\)</span> capture les intéractions entre les actions de <span class="math inline">\(j\)</span> et son identité <span class="math inline">\(I_j\)</span></p></li>
</ul>
<p>Cette fonction d’identite <span class="math inline">\(I_j\)</span> dépend elle même de plusieurs facteurs:</p>
<p><span class="math inline">\(I_j = I_j(a_j, a_{-j}, c_j, E_j, P)\)</span></p>
<p>où :</p>
<ul>
<li><p><span class="math inline">\(a_j\)</span> représente les actions de l’individu <span class="math inline">\(j\)</span>,</p></li>
<li><p><span class="math inline">\(a_{-j}\)</span> repésente les actions des autres individus,</p></li>
<li><p><span class="math inline">\(c_j\)</span> est la catégorie sociale à laquelle appartien <span class="math inline">\(j\)</span>,</p></li>
<li><p><span class="math inline">\(E_j\)</span> sont les caractéristiques données de <span class="math inline">\(j\)</span>,</p></li>
<li><p><span class="math inline">\(P\)</span> sont les prescriptions (ou normes sociales) associées à la catégorie <span class="math inline">\(c_j\)</span>.</p></li>
</ul>
<p>Ce modèle formalise cette tension qui peut exister pour les individus entre se conformer ou non aux normes de sa catégorie sociale assignée, en fonction de la distance qui peut exister entre ses propres caractéristiques et les prescriptions assignées.</p>
<p>Il suppose aussi l’existence possible de sanctions de la part des pairs si les normes ne sont pas suivies (moqueries, mise à l’écart ou même violence)</p>
<p>Par exemple, dans leur papier <span class="citation" data-cites="akerlof">(<a href="#ref-akerlof" role="doc-biblioref">George A. Akerlof and Kranton, n.d.</a>)</span> complètent les théories traditionnelles de l’économie de l’éducation en expliquant le plus ou moins grand investissement scolaire des étudiants en fonction de leurs caractéristiques identitaires (les sportifs, les intellos et les rebelles)</p>
</section>
<section id="identité-et-choix-des-individus" class="level2">
<h2 class="anchored" data-anchor-id="identité-et-choix-des-individus">Identité et choix des individus</h2>
<p>L’économie étudie comment les agents font leur choix (de consommation, de production…), ces choix dépendent de l’identité des individus.</p>
<p>En effet, le sens que l’on a de soi, influence nos décisions, et ces décisions influencent notre identité en retour.</p>
<p>Dans un premier temps, la catégorie sociale à laquelle j’appartiens peut influencer mes préférences (<span class="citation" data-cites="chen_group_2009">Chen and Li (<a href="#ref-chen_group_2009" role="doc-biblioref">2009</a>)</span>) ,mes comportements pro-sociaux (<span class="citation" data-cites="charness_identities_2014">Charness, Cobo-Reyes, and Jiménez (<a href="#ref-charness_identities_2014" role="doc-biblioref">2014</a>)</span>) et donc mes décisions.</p>
<p>Dans un second temps, l’individu arbitre entre ses propres caractéristiques et les prescriptions de sa catégorie sociale (ou les prescriptions supposées).</p>
<p>Vais-je me conformer à ce qui est attendu? Mes propres caractéristiques sont-elles plus ou moins proches des normes en vigueur? Si je ne me conforme pas, quelle sera la réaction de mes pairs?</p>
<p>Cet arbitrage et cette possibilité pour autrui de répondre à mes actions a été représenté sous forme d’arbre de décision par <span class="citation" data-cites="akerlof_economics_2000-1">George A. Akerlof and Kranton (<a href="#ref-akerlof_economics_2000-1" role="doc-biblioref">2000a</a>)</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tree.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Cette friction entre adhérer ou non aux normes de ma catégorie sociale a conduit la recherche des économistes de l’identité vers les questions de conflits inter-groupes (<span class="citation" data-cites="austen-smith_economic_2005">Austen-Smith and Fryer (<a href="#ref-austen-smith_economic_2005" role="doc-biblioref">2005</a>)</span>, <span class="citation" data-cites="chakravarty_religious_2015">Chakravarty et al. (<a href="#ref-chakravarty_religious_2015" role="doc-biblioref">2015</a>)</span>, <span class="citation" data-cites="fryer_empirical_2010">Fryer, Fryer, and Torelli (<a href="#ref-fryer_empirical_2010" role="doc-biblioref">2010</a>)</span>, <span class="citation" data-cites="benabou_incentives_2004">Bénabou and Tirole (<a href="#ref-benabou_incentives_2004" role="doc-biblioref">2004</a>)</span>.)</p>
<p>On s’interroge sur les normes, l’adhésion ou non à ces dernières et le rôle que peuvent jouer les politiques publiques sur ces prescriptions.</p>
<p>Mais l’identité joue également un rôle fondamental sur les performances individuelles.</p>
</section>
<section id="identité-et-performances" class="level2">
<h2 class="anchored" data-anchor-id="identité-et-performances">Identité et Performances</h2>
<p>Dans une étude particulièrement intéressante, <span class="citation" data-cites="shih_domain-specific_2006">Shih, Pittinsky, and Trahan (<a href="#ref-shih_domain-specific_2006" role="doc-biblioref">2006</a>)</span> ont montré comment l’activation d’une identité particulière, ou tout du moins comment les stéréotypes associés à cette identité, pouvaient avoir un impact sur les performances individuelles.</p>
<p>En réalisant une étude auprès d’étudiantes asiatiques aux Etats Unis, les chercheurs ont proposé l’expérience suivante:</p>
<p>Un questionnaire était fourni aux participantes avant de réaliser un test de mathématiques.</p>
<p>Une partie des participantes répondaient à un questionnaire dont les questions portaient sur leur identité asiatique, pour les autres participantes le questionnaire activait leur identité féminine, un groupe de contrôle était également implémanté.</p>
<p>Ce simple questionnaire en préambule a eu des effets notables sur les performances aux tests de mathématiques réalisés ensuite, puisque en moyenne, les étudiantes dont l’identité asiatique avait été mise en évidence performaient significativement mieux aux tests de mathématiques que leurs homologues dont l’identité féminine avait été activée.</p>
<p>Cette étude plaide donc pour la nécessité de s’interroger sur la notion d’identité, dès lors que cette variable peut significativement avoir des répercussions sur les résultats socio-économiques des individus.</p>
<p>Cependant, les critiques apportées à ce nouveau courant sont notamment que ce concept fondamental d’identité est trop flou, comment intégrer dans les modèles ou bien encore dans les études empiriques cette dimension si polymorphe?</p>
<p>La question de la mesure de l’identité se pose alors… ## Construction de l’indice</p>
<p>L’indice que nous proposons repose donc sur la dernière approche présentée:</p>
<p>Un indice de mesure continue de l’identité de genre, construit comme un indice composite à partir de dimensions non définies <em>a priori</em> comme genrées.</p>
<p>Mais alors, quelles variables choisir pour représenter ces dimensions du genre?</p>
<p>Notre choix s’est porté sur les pratiques culturelles des français (leurs loisirs culturels) car ces pratiques sont en effet particulièrement genrées (différenciées selon les sexes biologiques), il nous paraissait pertinent de s’appuyer sur ces dernières pour construire notre indice.</p>
<section id="pratiques-culturelles-et-genre" class="level3">
<h3 class="anchored" data-anchor-id="pratiques-culturelles-et-genre">Pratiques culturelles et Genre ?</h3>
<p>En sociologie, la question de la culture et du Genre fait l’objet de travaux ayant montré combien les pratiques culturelles sont différenciées chez les hommes et les femmes (<span class="citation" data-cites="octobre_loisirs_2008">Octobre (<a href="#ref-octobre_loisirs_2008" role="doc-biblioref">2008</a>)</span>) , et ce, dès l’enfance.</p>
<p>Cette différenciation nous permet d’envisager qu’il y ait des pratiques plus ou moins féminines ou masculines, dans la mesure où en moyenne elles sont plus pratiquées par des hommes ou par des femmes.</p>
<p>Cela signifie qu’il existe des normes genrées dans la pratique ou non d’une activité culturelle: le tricot est essentiellement féminin, la chasse est une activité plutôt pratiquée par les hommes.</p>
<p>Ces exemples sont tirés de l’analyse de nos données, en effet, nous avons utilisé la base de données <em>Enquête sur les pratiques culturelles des Français</em>, 2018.</p>
<p>Cette base de données comprend des informations sur les pratiques culturelles des français (9234 individus interrogés) , ainsi que des données socio-démographiques et porte également une question qui va nous intéresser sur le degré de satisfaction en termes de temps libre.</p>
<p>Cette dernière variable (“Vous arrive-t-il d’avoir le sentiment de manquer de temps libre pour faire tout ce dont vous avez envie?”) a retenu notre attention car elle pourrait être une mesure de l’utilité (satisfaction) de l’individu.</p>
<section id="statistiques-descriptives-de-la-base-de-données" class="level4">
<h4 class="anchored" data-anchor-id="statistiques-descriptives-de-la-base-de-données">Statistiques descriptives de la base de données</h4>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(questionr) </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmosaic)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally) </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dataMaid)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GDAtools)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary) </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary) </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer) </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR) </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xtable) </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(explor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">read.csv2</span>(<span class="st">"pc18_quetelet_octobre2023.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>SEXE, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Men"</span>, <span class="st">"Women"</span>))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>my_data_frame <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">rename</span>( </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Knitting =</span> A1001 , </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cards_games =</span> A1002,  </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gambling =</span> A1003 , </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cooking =</span> A1004 , </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">DIY =</span> A1005  ,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Vegetable_garden =</span> A1006 , </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ornamental_garden =</span> A1007,  </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fishing_hunting =</span> A1008 , </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Collection =</span> A1009  ,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Vehicle_custom =</span> A1010 , </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">No_Amateur=</span>A1011,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Making_music =</span> A1901  ,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Diary =</span> A1902  ,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Writing =</span> A1903,  </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Painting =</span> A1904,  </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Montage =</span> A1905 , </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">Circus =</span> A1906  ,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">Pottery =</span> A1907 , </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Theater =</span> A1908 , </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Drawing =</span> A1909 , </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">Dancing =</span> A1910,  </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">Photography =</span> A1911  ,</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">Genealogy =</span> A1912 , </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">Science =</span> A1913  ,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">None =</span> A1914  ,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">Video_games =</span> B1  ,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">TV =</span> C1  ,</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">Radio =</span> E1  ,</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">Library =</span> F1  ,</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">Museums =</span> H112,  </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">Internet =</span> I4 , </span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">Concert =</span> G2413 )</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>Video_games <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(my_data_frame<span class="sc">$</span>Video_games <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>TV <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(my_data_frame<span class="sc">$</span>TV <span class="sc">==</span> <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>Radio <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(my_data_frame<span class="sc">$</span>Radio <span class="sc">==</span> <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>Library<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(my_data_frame<span class="sc">$</span>Radio <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>Museums<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(my_data_frame<span class="sc">$</span>Museums <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>Internet<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(my_data_frame<span class="sc">$</span>Internet <span class="sc">==</span> <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>Concert<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(my_data_frame<span class="sc">$</span>Concert <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>my_data_frame <span class="ot">&lt;-</span> my_data_frame <span class="sc">%&gt;%</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">satisfaction =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    A2 <span class="sc">%in%</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Low"</span>,      <span class="co"># 1 à 4 -&gt; Low</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    A2 <span class="sc">%in%</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Medium"</span>,   <span class="co"># 5 à 7 -&gt; Medium</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    A2 <span class="sc">%in%</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"High"</span>,    <span class="co"># 8 à 10 -&gt; High</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>              </span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>  ))  </span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>my_data_frame <span class="ot">&lt;-</span> my_data_frame <span class="sc">%&gt;%</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Income =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    CRITREVENU <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">~</span> <span class="st">"Low"</span>,      <span class="co"># 1 à 4 -&gt; Low</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    CRITREVENU <span class="sc">%in%</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">7</span> <span class="sc">~</span> <span class="st">"Medium"</span>,   <span class="co"># 5 à 7 -&gt; Medium</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>    CRITREVENU <span class="sc">%in%</span> <span class="dv">8</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">~</span> <span class="st">"High"</span>,    <span class="co"># 8 à 10 -&gt; High</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>              </span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>my_data_frame <span class="ot">&lt;-</span> my_data_frame <span class="sc">%&gt;%</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Health =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>    A15 <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span> <span class="sc">~</span> <span class="st">"Good"</span>,      <span class="co"># 1 à 4 -&gt; Low</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>    A15 <span class="sc">%in%</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Medium"</span>,   <span class="co"># 5 à 7 -&gt; Medium</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>    A15 <span class="sc">%in%</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">~</span> <span class="st">"Bad"</span>,    <span class="co"># 8 à 10 -&gt; High</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>              </span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>my_data_frame <span class="ot">&lt;-</span> my_data_frame <span class="sc">%&gt;%</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Couple =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>    VITENCOUPLE <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span> <span class="sc">~</span> <span class="st">"Yes"</span>,     </span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>    VITENCOUPLE <span class="sc">%in%</span> <span class="dv">3</span><span class="sc">~</span> <span class="st">"No"</span>,  </span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>              </span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>quartiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data<span class="sc">$</span>AGE, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>age_group <span class="ot">&lt;-</span> <span class="fu">cut</span>(</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>  my_data_frame<span class="sc">$</span>AGE,</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="dv">4</span>,  <span class="co"># Automatically divide into 4 slices</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"[15-38["</span>, <span class="st">"[38-54["</span>, <span class="st">"[54-67["</span>, <span class="st">"[67-97["</span>),  <span class="co"># Labels optionnels</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.lowest =</span> <span class="cn">TRUE</span> </span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>stat_des_1 <span class="ot">&lt;-</span> my_data_frame <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tbl_summary</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">include =</span> <span class="fu">c</span>(<span class="st">"AGE"</span>, <span class="st">"Income"</span>, <span class="st">"Couple"</span>, <span class="st">"CLASSIF"</span>, <span class="st">"satisfaction"</span>, <span class="st">"Health"</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">by =</span> <span class="st">"Sex"</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistic =</span> <span class="fu">list</span>(</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"{min} - {max}"</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_overall</span>(<span class="at">last =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_p</span>(</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">test.args =</span> <span class="fu">list</span>(</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="fu">list</span>(<span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">all_categorical</span>() <span class="sc">~</span> <span class="fu">list</span>(<span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>stat_des_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="hmakdezhmm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hmakdezhmm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hmakdezhmm thead, #hmakdezhmm tbody, #hmakdezhmm tfoot, #hmakdezhmm tr, #hmakdezhmm td, #hmakdezhmm th {
  border-style: none;
}

#hmakdezhmm p {
  margin: 0;
  padding: 0;
}

#hmakdezhmm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hmakdezhmm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hmakdezhmm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hmakdezhmm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hmakdezhmm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hmakdezhmm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hmakdezhmm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hmakdezhmm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hmakdezhmm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hmakdezhmm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hmakdezhmm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hmakdezhmm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hmakdezhmm .gt_spanner_row {
  border-bottom-style: hidden;
}

#hmakdezhmm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hmakdezhmm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hmakdezhmm .gt_from_md > :first-child {
  margin-top: 0;
}

#hmakdezhmm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hmakdezhmm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hmakdezhmm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hmakdezhmm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hmakdezhmm .gt_row_group_first td {
  border-top-width: 2px;
}

#hmakdezhmm .gt_row_group_first th {
  border-top-width: 2px;
}

#hmakdezhmm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hmakdezhmm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hmakdezhmm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hmakdezhmm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hmakdezhmm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hmakdezhmm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hmakdezhmm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hmakdezhmm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hmakdezhmm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hmakdezhmm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hmakdezhmm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hmakdezhmm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hmakdezhmm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hmakdezhmm .gt_left {
  text-align: left;
}

#hmakdezhmm .gt_center {
  text-align: center;
}

#hmakdezhmm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hmakdezhmm .gt_font_normal {
  font-weight: normal;
}

#hmakdezhmm .gt_font_bold {
  font-weight: bold;
}

#hmakdezhmm .gt_font_italic {
  font-style: italic;
}

#hmakdezhmm .gt_super {
  font-size: 65%;
}

#hmakdezhmm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hmakdezhmm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hmakdezhmm .gt_indent_1 {
  text-indent: 5px;
}

#hmakdezhmm .gt_indent_2 {
  text-indent: 10px;
}

#hmakdezhmm .gt_indent_3 {
  text-indent: 15px;
}

#hmakdezhmm .gt_indent_4 {
  text-indent: 20px;
}

#hmakdezhmm .gt_indent_5 {
  text-indent: 25px;
}

#hmakdezhmm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#hmakdezhmm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Men</strong><br> N = 4,162<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Women</strong><br> N = 5,072<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_0" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Overall</strong><br> N = 9,234<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">AGE</td>
<td class="gt_row gt_center" headers="stat_1">15 - 95</td>
<td class="gt_row gt_center" headers="stat_2">15 - 97</td>
<td class="gt_row gt_center" headers="stat_0">15 - 97</td>
<td class="gt_row gt_center" headers="p.value">0.042</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Income</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;High</td>
<td class="gt_row gt_center" headers="stat_1">1,432 (39%)</td>
<td class="gt_row gt_center" headers="stat_2">1,464 (33%)</td>
<td class="gt_row gt_center" headers="stat_0">2,896 (36%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Low</td>
<td class="gt_row gt_center" headers="stat_1">762 (21%)</td>
<td class="gt_row gt_center" headers="stat_2">1,284 (29%)</td>
<td class="gt_row gt_center" headers="stat_0">2,046 (25%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Medium</td>
<td class="gt_row gt_center" headers="stat_1">1,476 (40%)</td>
<td class="gt_row gt_center" headers="stat_2">1,644 (37%)</td>
<td class="gt_row gt_center" headers="stat_0">3,120 (39%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_1">492</td>
<td class="gt_row gt_center" headers="stat_2">680</td>
<td class="gt_row gt_center" headers="stat_0">1,172</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Couple</td>
<td class="gt_row gt_center" headers="stat_1">2,444 (59%)</td>
<td class="gt_row gt_center" headers="stat_2">2,567 (51%)</td>
<td class="gt_row gt_center" headers="stat_0">5,011 (54%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_1">4</td>
<td class="gt_row gt_center" headers="stat_2">9</td>
<td class="gt_row gt_center" headers="stat_0">13</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">CLASSIF</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;1</td>
<td class="gt_row gt_center" headers="stat_1">123 (8.7%)</td>
<td class="gt_row gt_center" headers="stat_2">63 (4.5%)</td>
<td class="gt_row gt_center" headers="stat_0">186 (6.6%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;2</td>
<td class="gt_row gt_center" headers="stat_1">454 (32%)</td>
<td class="gt_row gt_center" headers="stat_2">143 (10%)</td>
<td class="gt_row gt_center" headers="stat_0">597 (21%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;3</td>
<td class="gt_row gt_center" headers="stat_1">190 (13%)</td>
<td class="gt_row gt_center" headers="stat_2">92 (6.6%)</td>
<td class="gt_row gt_center" headers="stat_0">282 (10%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;4</td>
<td class="gt_row gt_center" headers="stat_1">157 (11%)</td>
<td class="gt_row gt_center" headers="stat_2">126 (9.1%)</td>
<td class="gt_row gt_center" headers="stat_0">283 (10%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;5</td>
<td class="gt_row gt_center" headers="stat_1">278 (20%)</td>
<td class="gt_row gt_center" headers="stat_2">236 (17%)</td>
<td class="gt_row gt_center" headers="stat_0">514 (18%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;6</td>
<td class="gt_row gt_center" headers="stat_1">194 (14%)</td>
<td class="gt_row gt_center" headers="stat_2">703 (51%)</td>
<td class="gt_row gt_center" headers="stat_0">897 (32%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;7</td>
<td class="gt_row gt_center" headers="stat_1">13 (0.9%)</td>
<td class="gt_row gt_center" headers="stat_2">7 (0.5%)</td>
<td class="gt_row gt_center" headers="stat_0">20 (0.7%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;8</td>
<td class="gt_row gt_center" headers="stat_1">11 (0.8%)</td>
<td class="gt_row gt_center" headers="stat_2">18 (1.3%)</td>
<td class="gt_row gt_center" headers="stat_0">29 (1.0%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;9</td>
<td class="gt_row gt_center" headers="stat_1">1 (&lt;0.1%)</td>
<td class="gt_row gt_center" headers="stat_2">1 (&lt;0.1%)</td>
<td class="gt_row gt_center" headers="stat_0">2 (&lt;0.1%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_1">2,741</td>
<td class="gt_row gt_center" headers="stat_2">3,683</td>
<td class="gt_row gt_center" headers="stat_0">6,424</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">satisfaction</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;High</td>
<td class="gt_row gt_center" headers="stat_1">1,461 (35%)</td>
<td class="gt_row gt_center" headers="stat_2">1,656 (33%)</td>
<td class="gt_row gt_center" headers="stat_0">3,117 (34%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Low</td>
<td class="gt_row gt_center" headers="stat_1">1,488 (36%)</td>
<td class="gt_row gt_center" headers="stat_2">2,015 (40%)</td>
<td class="gt_row gt_center" headers="stat_0">3,503 (38%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Medium</td>
<td class="gt_row gt_center" headers="stat_1">1,207 (29%)</td>
<td class="gt_row gt_center" headers="stat_2">1,398 (28%)</td>
<td class="gt_row gt_center" headers="stat_0">2,605 (28%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_1">6</td>
<td class="gt_row gt_center" headers="stat_2">3</td>
<td class="gt_row gt_center" headers="stat_0">9</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Health</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Bad</td>
<td class="gt_row gt_center" headers="stat_1">322 (7.8%)</td>
<td class="gt_row gt_center" headers="stat_2">461 (9.1%)</td>
<td class="gt_row gt_center" headers="stat_0">783 (8.5%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Good</td>
<td class="gt_row gt_center" headers="stat_1">2,984 (72%)</td>
<td class="gt_row gt_center" headers="stat_2">3,426 (68%)</td>
<td class="gt_row gt_center" headers="stat_0">6,410 (70%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Medium</td>
<td class="gt_row gt_center" headers="stat_1">841 (20%)</td>
<td class="gt_row gt_center" headers="stat_2">1,157 (23%)</td>
<td class="gt_row gt_center" headers="stat_0">1,998 (22%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_1">15</td>
<td class="gt_row gt_center" headers="stat_2">28</td>
<td class="gt_row gt_center" headers="stat_0">43</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="5" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Min - Max; n (%)</td>
</tr>
<tr class="even">
<td colspan="5" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Wilcoxon rank sum test; Pearson’s Chi-squared test with simulated p-value (based on 2000 replicates); Fisher’s Exact Test for Count Data with simulated p-value (based on 2000 replicates)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>Lecture: Parmi les individus de sexe masculin, 59% sont en couple. La différence avec les femmes est significative (p&lt;0,001)</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>table <span class="ot">&lt;-</span> my_data_frame <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">include =</span> <span class="fu">c</span>(  <span class="st">"Knitting"</span> , </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Cards_games"</span>,  </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Gambling"</span> , </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Cooking"</span> , </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"DIY"</span>  ,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Vegetable_garden"</span> , </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Ornamental_garden"</span>,  </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Fishing_hunting"</span> , </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Collection"</span>  ,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Vehicle_custom"</span>, </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Making_music"</span>   ,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Diary"</span> ,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Writing"</span> ,  </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Painting"</span>,  </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Montage"</span>  , </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Circus"</span>   ,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Pottery"</span> , </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Theater"</span> , </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Drawing"</span> , </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Dancing"</span>,  </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Photography"</span>  ,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Genealogy"</span> , </span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Science"</span>  ,</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"None"</span>  ,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"No_Amateur"</span>,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Video_games"</span>  ,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"TV"</span> ,</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Radio"</span>  ,</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Library"</span>  ,</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Museums"</span>,  </span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Internet"</span>, </span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Concert"</span>),</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"Sex"</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_overall</span>(<span class="at">last =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_p</span>()</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="jifufakkog" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jifufakkog table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jifufakkog thead, #jifufakkog tbody, #jifufakkog tfoot, #jifufakkog tr, #jifufakkog td, #jifufakkog th {
  border-style: none;
}

#jifufakkog p {
  margin: 0;
  padding: 0;
}

#jifufakkog .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jifufakkog .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jifufakkog .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jifufakkog .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jifufakkog .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jifufakkog .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jifufakkog .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jifufakkog .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jifufakkog .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jifufakkog .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jifufakkog .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jifufakkog .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jifufakkog .gt_spanner_row {
  border-bottom-style: hidden;
}

#jifufakkog .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jifufakkog .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jifufakkog .gt_from_md > :first-child {
  margin-top: 0;
}

#jifufakkog .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jifufakkog .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jifufakkog .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jifufakkog .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jifufakkog .gt_row_group_first td {
  border-top-width: 2px;
}

#jifufakkog .gt_row_group_first th {
  border-top-width: 2px;
}

#jifufakkog .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jifufakkog .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jifufakkog .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jifufakkog .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jifufakkog .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jifufakkog .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jifufakkog .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jifufakkog .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jifufakkog .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jifufakkog .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jifufakkog .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jifufakkog .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jifufakkog .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jifufakkog .gt_left {
  text-align: left;
}

#jifufakkog .gt_center {
  text-align: center;
}

#jifufakkog .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jifufakkog .gt_font_normal {
  font-weight: normal;
}

#jifufakkog .gt_font_bold {
  font-weight: bold;
}

#jifufakkog .gt_font_italic {
  font-style: italic;
}

#jifufakkog .gt_super {
  font-size: 65%;
}

#jifufakkog .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jifufakkog .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jifufakkog .gt_indent_1 {
  text-indent: 5px;
}

#jifufakkog .gt_indent_2 {
  text-indent: 10px;
}

#jifufakkog .gt_indent_3 {
  text-indent: 15px;
}

#jifufakkog .gt_indent_4 {
  text-indent: 20px;
}

#jifufakkog .gt_indent_5 {
  text-indent: 25px;
}

#jifufakkog .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jifufakkog div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Men</strong><br> N = 4,162<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Women</strong><br> N = 5,072<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_0" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Overall</strong><br> N = 9,234<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">Knitting</td>
<td class="gt_row gt_center" headers="stat_1">73 (1.8%)</td>
<td class="gt_row gt_center" headers="stat_2">1,370 (27%)</td>
<td class="gt_row gt_center" headers="stat_0">1,443 (16%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Cards_games</td>
<td class="gt_row gt_center" headers="stat_1">1,899 (46%)</td>
<td class="gt_row gt_center" headers="stat_2">2,764 (54%)</td>
<td class="gt_row gt_center" headers="stat_0">4,663 (50%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Gambling</td>
<td class="gt_row gt_center" headers="stat_1">990 (24%)</td>
<td class="gt_row gt_center" headers="stat_2">970 (19%)</td>
<td class="gt_row gt_center" headers="stat_0">1,960 (21%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Cooking</td>
<td class="gt_row gt_center" headers="stat_1">1,685 (40%)</td>
<td class="gt_row gt_center" headers="stat_2">3,473 (68%)</td>
<td class="gt_row gt_center" headers="stat_0">5,158 (56%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">DIY</td>
<td class="gt_row gt_center" headers="stat_1">2,667 (64%)</td>
<td class="gt_row gt_center" headers="stat_2">2,283 (45%)</td>
<td class="gt_row gt_center" headers="stat_0">4,950 (54%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Vegetable_garden</td>
<td class="gt_row gt_center" headers="stat_1">1,335 (32%)</td>
<td class="gt_row gt_center" headers="stat_2">1,245 (25%)</td>
<td class="gt_row gt_center" headers="stat_0">2,580 (28%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Ornamental_garden</td>
<td class="gt_row gt_center" headers="stat_1">1,793 (43%)</td>
<td class="gt_row gt_center" headers="stat_2">2,198 (43%)</td>
<td class="gt_row gt_center" headers="stat_0">3,991 (43%)</td>
<td class="gt_row gt_center" headers="p.value">0.8</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Fishing_hunting</td>
<td class="gt_row gt_center" headers="stat_1">722 (17%)</td>
<td class="gt_row gt_center" headers="stat_2">212 (4.2%)</td>
<td class="gt_row gt_center" headers="stat_0">934 (10%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Collection</td>
<td class="gt_row gt_center" headers="stat_1">395 (9.5%)</td>
<td class="gt_row gt_center" headers="stat_2">281 (5.5%)</td>
<td class="gt_row gt_center" headers="stat_0">676 (7.3%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Vehicle_custom</td>
<td class="gt_row gt_center" headers="stat_1">264 (6.3%)</td>
<td class="gt_row gt_center" headers="stat_2">60 (1.2%)</td>
<td class="gt_row gt_center" headers="stat_0">324 (3.5%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Making_music</td>
<td class="gt_row gt_center" headers="stat_1">1,312 (32%)</td>
<td class="gt_row gt_center" headers="stat_2">1,830 (36%)</td>
<td class="gt_row gt_center" headers="stat_0">3,142 (34%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Diary</td>
<td class="gt_row gt_center" headers="stat_1">285 (6.8%)</td>
<td class="gt_row gt_center" headers="stat_2">1,206 (24%)</td>
<td class="gt_row gt_center" headers="stat_0">1,491 (16%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Writing</td>
<td class="gt_row gt_center" headers="stat_1">410 (9.9%)</td>
<td class="gt_row gt_center" headers="stat_2">746 (15%)</td>
<td class="gt_row gt_center" headers="stat_0">1,156 (13%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Painting</td>
<td class="gt_row gt_center" headers="stat_1">667 (16%)</td>
<td class="gt_row gt_center" headers="stat_2">1,303 (26%)</td>
<td class="gt_row gt_center" headers="stat_0">1,970 (21%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Montage</td>
<td class="gt_row gt_center" headers="stat_1">843 (20%)</td>
<td class="gt_row gt_center" headers="stat_2">586 (12%)</td>
<td class="gt_row gt_center" headers="stat_0">1,429 (15%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Circus</td>
<td class="gt_row gt_center" headers="stat_1">116 (2.8%)</td>
<td class="gt_row gt_center" headers="stat_2">179 (3.5%)</td>
<td class="gt_row gt_center" headers="stat_0">295 (3.2%)</td>
<td class="gt_row gt_center" headers="p.value">0.044</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Pottery</td>
<td class="gt_row gt_center" headers="stat_1">264 (6.3%)</td>
<td class="gt_row gt_center" headers="stat_2">705 (14%)</td>
<td class="gt_row gt_center" headers="stat_0">969 (10%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Theater</td>
<td class="gt_row gt_center" headers="stat_1">483 (12%)</td>
<td class="gt_row gt_center" headers="stat_2">800 (16%)</td>
<td class="gt_row gt_center" headers="stat_0">1,283 (14%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Drawing</td>
<td class="gt_row gt_center" headers="stat_1">864 (21%)</td>
<td class="gt_row gt_center" headers="stat_2">1,285 (25%)</td>
<td class="gt_row gt_center" headers="stat_0">2,149 (23%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Dancing</td>
<td class="gt_row gt_center" headers="stat_1">410 (9.9%)</td>
<td class="gt_row gt_center" headers="stat_2">1,782 (35%)</td>
<td class="gt_row gt_center" headers="stat_0">2,192 (24%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Photography</td>
<td class="gt_row gt_center" headers="stat_1">1,175 (28%)</td>
<td class="gt_row gt_center" headers="stat_2">1,176 (23%)</td>
<td class="gt_row gt_center" headers="stat_0">2,351 (25%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Genealogy</td>
<td class="gt_row gt_center" headers="stat_1">513 (12%)</td>
<td class="gt_row gt_center" headers="stat_2">575 (11%)</td>
<td class="gt_row gt_center" headers="stat_0">1,088 (12%)</td>
<td class="gt_row gt_center" headers="p.value">0.14</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Science</td>
<td class="gt_row gt_center" headers="stat_1">611 (15%)</td>
<td class="gt_row gt_center" headers="stat_2">469 (9.2%)</td>
<td class="gt_row gt_center" headers="stat_0">1,080 (12%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">None</td>
<td class="gt_row gt_center" headers="stat_1">1,394 (33%)</td>
<td class="gt_row gt_center" headers="stat_2">1,261 (25%)</td>
<td class="gt_row gt_center" headers="stat_0">2,655 (29%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">No_Amateur</td>
<td class="gt_row gt_center" headers="stat_1">276 (6.6%)</td>
<td class="gt_row gt_center" headers="stat_2">359 (7.1%)</td>
<td class="gt_row gt_center" headers="stat_0">635 (6.9%)</td>
<td class="gt_row gt_center" headers="p.value">0.4</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Video_games</td>
<td class="gt_row gt_center" headers="stat_1">1,760 (42%)</td>
<td class="gt_row gt_center" headers="stat_2">1,827 (36%)</td>
<td class="gt_row gt_center" headers="stat_0">3,587 (39%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">TV</td>
<td class="gt_row gt_center" headers="stat_1">3,878 (93%)</td>
<td class="gt_row gt_center" headers="stat_2">4,806 (95%)</td>
<td class="gt_row gt_center" headers="stat_0">8,684 (94%)</td>
<td class="gt_row gt_center" headers="p.value">0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Radio</td>
<td class="gt_row gt_center" headers="stat_1">3,522 (85%)</td>
<td class="gt_row gt_center" headers="stat_2">4,186 (83%)</td>
<td class="gt_row gt_center" headers="stat_0">7,708 (83%)</td>
<td class="gt_row gt_center" headers="p.value">0.007</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Library</td>
<td class="gt_row gt_center" headers="stat_1">3,522 (85%)</td>
<td class="gt_row gt_center" headers="stat_2">4,186 (83%)</td>
<td class="gt_row gt_center" headers="stat_0">7,708 (83%)</td>
<td class="gt_row gt_center" headers="p.value">0.007</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Museums</td>
<td class="gt_row gt_center" headers="stat_1">4,101 (99%)</td>
<td class="gt_row gt_center" headers="stat_2">5,009 (99%)</td>
<td class="gt_row gt_center" headers="stat_0">9,110 (99%)</td>
<td class="gt_row gt_center" headers="p.value">0.4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Internet</td>
<td class="gt_row gt_center" headers="stat_1">3,459 (83%)</td>
<td class="gt_row gt_center" headers="stat_2">4,185 (83%)</td>
<td class="gt_row gt_center" headers="stat_0">7,644 (83%)</td>
<td class="gt_row gt_center" headers="p.value">0.4</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Concert</td>
<td class="gt_row gt_center" headers="stat_1">3,344 (80%)</td>
<td class="gt_row gt_center" headers="stat_2">4,234 (83%)</td>
<td class="gt_row gt_center" headers="stat_0">7,578 (82%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="5" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> n (%)</td>
</tr>
<tr class="even">
<td colspan="5" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Pearson’s Chi-squared test</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>Lecture: Parmi les hommes, 1.8% déclarent pratiquer le tricot, contre 27% des femmes. Cette activité est pratiquée par 16% des répondants.</p>
<p>Les p-value &lt;10% indiquent que les différences de participation aux pratiques culturelles sont significativement différentes selon le sexe biologique du répondant.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Nous retiendrons pour la construction de notre indice les pratiques culturelles suivantes:</p>
<p>“Knitting” , “Cards_games”,“Gambling” , “Cooking” , “DIY” , “Vegetable_garden” , “Fishing_hunting” , “Collection” , “Vehicle_custom”, “Making_music” , “Diary” , “Writing” ,“Painting”,“Montage” , “Pottery” , “Theater” , “Drawing” , “Dancing”,<br>
“Photography” , “Genealogy” , “Science” , “None” , “Video_games” , “Library” , “Concert”</p>
</div>
</div>
</section>
</section>
<section id="construction-de-notre-indice" class="level3">
<h3 class="anchored" data-anchor-id="construction-de-notre-indice">Construction de notre indice</h3>
<p>Afin de construire notre indice d’identité de genre, nous suivons la méthodologie proposée par <span class="citation" data-cites="cipriani">Cipriani et al. (<a href="#ref-cipriani" role="doc-biblioref">n.d.</a>)</span> et réalisons une Analyse des Correspondances Multiples (ACM) sur nos variables “pratiques culturelles”.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Encadré Technique 1: Détails de la méthode ACM
</div>
</div>
<div class="callout-body-container callout-body">
<p>L’**ACM** est une extension de l’**Analyse des Correspondances Simples (ACS)** qui permet d’explorer les relations entre plusieurs variables qualitatives en projetant les individus et les modalités dans un espace de faible dimension. Elle est souvent utilisée pour analyser des **questionnaires** et des **tableaux de contingence** complexes.</p>
<p>### Principaux résultats d’une ACM</p>
<p>1. **Inertie totale**</p>
<p>Mesure la dispersion des données et est donnée par :</p>
<p><span class="math inline">\(I_{\text{total}} = \frac{q}{q-1} \sum_{k} \lambda_k\)</span></p>
<p>où <span class="math inline">\(\lambda_k\)</span> sont les valeurs propres et <span class="math inline">\(q\)</span> est le nombre total de modalités.</p>
<p>2. **Valeurs propres <span class="math inline">\(\lambda_k\)</span>**</p>
<p>Elles indiquent la variance expliquée par chaque axe factoriel. Plus une valeur propre est élevée, plus l’axe correspondant est important dans l’analyse.</p>
<p>3. **Rapports de corrélation <span class="math inline">\(\eta^2\)</span>**</p>
<p>Le **rapport de corrélation** <span class="math inline">\(\eta^2\)</span> mesure la liaison entre une variable et un axe factoriel :</p>
<p><span class="math inline">\(\eta^2 = \frac{\sum_{i} f_i d_{i,k}^2}{\sum_{i} f_i d_{i}^2}\)</span></p>
<p>où $ f_i $ est la fréquence de l’individu/modalité $i $, et $d_{i,k} $ est sa distance à l’axe <span class="math inline">\(k\)</span> .</p>
<p>4. **Coordonnées des individus et modalités**</p>
<p>Elles sont obtenues à partir des vecteurs propres et permettent la représentation graphique des données :</p>
<p><span class="math inline">\(C_{i,k} = \frac{v_{i,k}}{\sqrt{\lambda_k}}\)</span></p>
<p>où <span class="math inline">\(v_{i,k}\)</span> est le vecteur propre associé à l’axe <span class="math inline">\(k\)</span>.</p>
<p>5. **Cos² (Qualité de représentation)**</p>
<p>Indique dans quelle mesure un point est bien représenté sur un axe donné. Une valeur proche de **1** signifie que la projection sur cet axe est pertinente.</p>
<p>6. **Contributions **</p>
<p>Elles mesurent l’importance d’une modalité ou d’un individu dans la construction d’un axe. Plus une contribution est élevée, plus l’élément joue un rôle important dans l’interprétation de l’axe.</p>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pratiques_cols_1 <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"Knitting"</span> , </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Cards_games"</span>,  </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Gambling"</span> , </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Cooking"</span> , </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"DIY"</span>  ,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Vegetable_garden"</span> , </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Fishing_hunting"</span> , </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Collection"</span>  ,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Vehicle_custom"</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Making_music"</span>   ,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Diary"</span> ,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Writing"</span> ,  </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Painting"</span>,  </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Montage"</span>  , </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Pottery"</span> , </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Theater"</span> , </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Drawing"</span> , </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Dancing"</span>,  </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Photography"</span>  ,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Genealogy"</span> , </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Science"</span>  ,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"None"</span> ,</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Video_games"</span>  ,</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Library"</span>  ,</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Concert"</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>                            )</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="co">#MCA</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Add Sex Column to the selection</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>cols_of_interest_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Sex"</span>, <span class="st">"AGE"</span>, pratiques_cols_1)</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a new dataframe with these columns</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>data_pratiques <span class="ot">&lt;-</span> my_data_frame[, cols_of_interest_1]</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>data_pratiques<span class="sc">$</span>AGE <span class="ot">&lt;-</span> <span class="fu">cut</span>(data_pratiques<span class="sc">$</span>AGE, </span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>                          <span class="at">breaks =</span> <span class="fu">quantile</span>(data_pratiques<span class="sc">$</span>AGE, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.25</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>                          <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>ra_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data_pratiques)</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>cols_to_factor <span class="ot">&lt;-</span> <span class="fu">c</span>(  <span class="st">"Knitting"</span> , </span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Cards_games"</span>,  </span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Gambling"</span> , </span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Cooking"</span> , </span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"DIY"</span>  ,</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Vegetable_garden"</span> , </span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Fishing_hunting"</span> , </span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Collection"</span>  ,</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Vehicle_custom"</span>,</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Making_music"</span>   ,</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Diary"</span> ,</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Writing"</span> ,  </span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Painting"</span>,  </span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Montage"</span>  , </span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Pottery"</span> , </span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Theater"</span> , </span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Drawing"</span> , </span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Dancing"</span>,  </span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Photography"</span>  ,</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Genealogy"</span> , </span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Science"</span>  ,</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"None"</span>  ,</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Video_games"</span>  ,</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Library"</span>  ,</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Concert"</span>)</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a><span class="co"># apply as.factor to these columnns</span></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>ra_data[cols_to_factor] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ra_data[cols_to_factor], as.factor)</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a><span class="co"># running MCA with FactoMiner</span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>acm2_fm <span class="ot">&lt;-</span> ra_data <span class="sc">|&gt;</span> </span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>  FactoMineR<span class="sc">::</span><span class="fu">MCA</span>(</span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncp =</span> <span class="cn">Inf</span>,</span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">graph =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">quali.sup =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>On remarque que la variable supplémentaire “Sexe” correspond à la dimension 2 de notre ACM. Cette dimension explique 6,06% de la variance totale.</p>
<p>Une analyse plus poussée avec le package Explor nous permet de mesurer l’association de la variable supplémentaire Sexe avec cette dimension (dim2), en effet, l’ <span class="math inline">\(𝞰^2\)</span> est de 0,14 , ce qui peut sembler peu mais indique bien que notre variable supplémentaire est liée à cet axe.</p>
<p>Pour construire notre indice, nous utiliserons donc les coordonnées des variables pratiques culturelles le long de cet axe 2.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract modality names</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>modalites_names <span class="ot">&lt;-</span> <span class="fu">rownames</span>(acm2_fm<span class="sc">$</span>var<span class="sc">$</span>coord)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check modality names</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(modalites_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Knitting_0"    "Knitting_1"    "Cards_games_0" "Cards_games_1"
[5] "Gambling_0"    "Gambling_1"   </code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coordinates for dimension 2</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>coord_dim2_modalites <span class="ot">&lt;-</span> acm2_fm<span class="sc">$</span>var<span class="sc">$</span>coord[, <span class="dv">2</span>]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a table associating the modalities and their coordinates in dimension 2</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>modalites_coord <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Modalite =</span> modalites_names, <span class="at">Coord_Dim2 =</span> coord_dim2_modalites)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only the two necessary columns</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>modalites_coord_selected <span class="ot">&lt;-</span> modalites_coord[, <span class="fu">c</span>(<span class="st">"Modalite"</span>, <span class="st">"Coord_Dim2"</span>)]</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(modalites_coord_selected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                             Modalite  Coord_Dim2
Knitting_0                 Knitting_0  0.04314603
Knitting_1                 Knitting_1 -0.23295268
Cards_games_0           Cards_games_0 -0.21072530
Cards_games_1           Cards_games_1  0.20656774
Gambling_0                 Gambling_0 -0.17433328
Gambling_1                 Gambling_1  0.64698995
Cooking_0                   Cooking_0 -0.06432635
Cooking_1                   Cooking_1  0.05083253
DIY_0                           DIY_0 -0.59097111
DIY_1                           DIY_1  0.51145863
Vegetable_garden_0 Vegetable_garden_0 -0.29999865
Vegetable_garden_1 Vegetable_garden_1  0.77371744
Fishing_hunting_0   Fishing_hunting_0 -0.16671349
Fishing_hunting_1   Fishing_hunting_1  1.48150102
Collection_0             Collection_0 -0.05539977
Collection_1             Collection_1  0.70134797
Vehicle_custom_0     Vehicle_custom_0 -0.05128080
Vehicle_custom_1     Vehicle_custom_1  1.41022187
Making_music_0         Making_music_0  0.09403755
Making_music_1         Making_music_1 -0.18232870
Diary_0                       Diary_0  0.09378209
Diary_1                       Diary_1 -0.48702531
Writing_0                   Writing_0  0.06770001
Writing_1                   Writing_1 -0.47308017
Painting_0                 Painting_0  0.04361213
Painting_1                 Painting_1 -0.16081142
Montage_0                   Montage_0 -0.07125251
Montage_1                   Montage_1  0.38917132
Pottery_0                   Pottery_0  0.01201096
Pottery_1                   Pottery_1 -0.10244644
Theater_0                   Theater_0  0.07187594
Theater_1                   Theater_1 -0.44542916
Drawing_0                   Drawing_0  0.04570585
Drawing_1                   Drawing_1 -0.15068681
Dancing_0                   Dancing_0  0.14396501
Dancing_1                   Dancing_1 -0.46250072
Photography_0           Photography_0 -0.07539973
Photography_1           Photography_1  0.22074706
Genealogy_0               Genealogy_0 -0.01967874
Genealogy_1               Genealogy_1  0.14733732
Science_0                   Science_0 -0.04008198
Science_1                   Science_1  0.30261895
None_0                         None_0 -0.06572453
None_1                         None_1  0.16286315
Video_games_0           Video_games_0 -0.22185919
Video_games_1           Video_games_1  0.34927205
Library_0                   Library_0 -0.65936864
Library_1                   Library_1  0.13053925
Concert_0                   Concert_0 -0.23244943
Concert_1                   Concert_1  0.05079655</code></pre>
</div>
</div>
<p>Ce tableau indique les poids utilisés pour la construction de notre indice.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a vector to store the index of each individual</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ra_data<span class="sc">$</span>indice_culturel <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Browse each individual</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(ra_data)) {</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize individual's index to 0</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  indice_individu <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Browse each practice column (columns 3 to 27)</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (pratique <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">27</span>) {</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Retrieve the individual's response for this practice (0 or 1)</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    reponse <span class="ot">&lt;-</span> ra_data[i, pratique]</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If the answer is 1, add the coordinate of the corresponding modality to the index.</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (reponse <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create the modality name (e.g. “knitting_1” or “knitting_0”)</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>      nom_modalite_1 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">names</span>(ra_data)[pratique], <span class="st">"_1"</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>      nom_modalite_0 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">names</span>(ra_data)[pratique], <span class="st">"_0"</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Find the coordinate associated with the corresponding modality</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (nom_modalite_1 <span class="sc">%in%</span> modalites_coord<span class="sc">$</span>Modalite) {</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>        indice_individu <span class="ot">&lt;-</span> indice_individu <span class="sc">+</span> modalites_coord<span class="sc">$</span>Coord_Dim2[modalites_coord<span class="sc">$</span>Modalite <span class="sc">==</span> nom_modalite_1]</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (nom_modalite_0 <span class="sc">%in%</span> modalites_coord<span class="sc">$</span>Modalite) {</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>        indice_individu <span class="ot">&lt;-</span> indice_individu <span class="sc">+</span> modalites_coord<span class="sc">$</span>Coord_Dim2[modalites_coord<span class="sc">$</span>Modalite <span class="sc">==</span> nom_modalite_0]</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the calculated index to the individual</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  ra_data<span class="sc">$</span>indice_culturel[i] <span class="ot">&lt;-</span> indice_individu</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="do">####Normalisation</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate minimum and maximum index values</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>min_indice <span class="ot">&lt;-</span> <span class="fu">min</span>(ra_data<span class="sc">$</span>indice_culturel, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>max_indice <span class="ot">&lt;-</span> <span class="fu">max</span>(ra_data<span class="sc">$</span>indice_culturel, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize index</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>ra_data<span class="sc">$</span>indice_culturel_normalise <span class="ot">&lt;-</span> (ra_data<span class="sc">$</span>indice_culturel <span class="sc">-</span> min_indice) <span class="sc">/</span> (max_indice <span class="sc">-</span> min_indice)</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ra_data[, <span class="fu">c</span>(<span class="st">"indice_culturel"</span>, <span class="st">"indice_culturel_normalise"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  indice_culturel indice_culturel_normalise
1       2.8024423                 0.8624142
2       0.5427446                 0.5073268
3      -0.4557477                 0.3504244
4      -0.3429253                 0.3681533
5       0.0409659                 0.4284777
6      -0.2367887                 0.3848315</code></pre>
</div>
</div>
<p>Notre indice est donc construit de la façon suivante:</p>
<p><span class="math display">\[I_{1j} = \sum_{k=1}^{Z} w_{1k} \cdot X_{k j}\]</span></p>
<p>Dans cette expression, <span class="math inline">\(I_{1j}\)</span> désigne l’indice de l’individu <span class="math inline">\(j\)</span>, tandis que <span class="math inline">\(w_{1k}\)</span> représente le poids associé à chaque variable culturelle <span class="math inline">\(X_{kj}\)</span>. La somme englobe toutes les variables culturelles <span class="math inline">\(Z\)</span>, ce qui nous permet de saisir l’engagement culturel global de l’individu.</p>
</section>
<section id="description-de-lindice" class="level3">
<h3 class="anchored" data-anchor-id="description-de-lindice">Description de l’indice</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>identity<span class="ot">&lt;-</span>ra_data<span class="sc">$</span>indice_culturel_normalise</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>indice<span class="ot">&lt;-</span>ra_data<span class="sc">$</span>indice_culturel</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my_data_frame, <span class="fu">aes</span>(<span class="at">x =</span> identity, <span class="at">fill =</span> Sex)) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"pink"</span>)) <span class="sc">+</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density of The Normalized Cultural Index by Sexe"</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Normalized Cultural Index"</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Sexe"</span>) <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>stat_des_indice<span class="ot">&lt;-</span>my_data_frame<span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(<span class="at">include=</span><span class="fu">c</span>(<span class="st">"identity"</span>),<span class="at">by =</span> <span class="st">"Sex"</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">statistic =</span> <span class="fu">list</span>(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"{min} - {max}"</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        )) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_overall</span>(<span class="at">last =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_p</span>()</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>stat_des_indice</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="pgrghrardp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pgrghrardp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pgrghrardp thead, #pgrghrardp tbody, #pgrghrardp tfoot, #pgrghrardp tr, #pgrghrardp td, #pgrghrardp th {
  border-style: none;
}

#pgrghrardp p {
  margin: 0;
  padding: 0;
}

#pgrghrardp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pgrghrardp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pgrghrardp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pgrghrardp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pgrghrardp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pgrghrardp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pgrghrardp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pgrghrardp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pgrghrardp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pgrghrardp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pgrghrardp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pgrghrardp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pgrghrardp .gt_spanner_row {
  border-bottom-style: hidden;
}

#pgrghrardp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pgrghrardp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pgrghrardp .gt_from_md > :first-child {
  margin-top: 0;
}

#pgrghrardp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pgrghrardp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pgrghrardp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pgrghrardp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pgrghrardp .gt_row_group_first td {
  border-top-width: 2px;
}

#pgrghrardp .gt_row_group_first th {
  border-top-width: 2px;
}

#pgrghrardp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pgrghrardp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pgrghrardp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pgrghrardp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pgrghrardp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pgrghrardp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pgrghrardp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pgrghrardp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pgrghrardp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pgrghrardp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pgrghrardp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pgrghrardp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pgrghrardp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pgrghrardp .gt_left {
  text-align: left;
}

#pgrghrardp .gt_center {
  text-align: center;
}

#pgrghrardp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pgrghrardp .gt_font_normal {
  font-weight: normal;
}

#pgrghrardp .gt_font_bold {
  font-weight: bold;
}

#pgrghrardp .gt_font_italic {
  font-style: italic;
}

#pgrghrardp .gt_super {
  font-size: 65%;
}

#pgrghrardp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pgrghrardp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pgrghrardp .gt_indent_1 {
  text-indent: 5px;
}

#pgrghrardp .gt_indent_2 {
  text-indent: 10px;
}

#pgrghrardp .gt_indent_3 {
  text-indent: 15px;
}

#pgrghrardp .gt_indent_4 {
  text-indent: 20px;
}

#pgrghrardp .gt_indent_5 {
  text-indent: 25px;
}

#pgrghrardp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pgrghrardp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Men</strong><br> N = 4,162<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Women</strong><br> N = 5,072<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_0" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Overall</strong><br> N = 9,234<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">identity</td>
<td class="gt_row gt_center" headers="stat_1">0.01 - 1.00</td>
<td class="gt_row gt_center" headers="stat_2">0.00 - 0.91</td>
<td class="gt_row gt_center" headers="stat_0">0.00 - 1.00</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="5" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Min - Max</td>
</tr>
<tr class="even">
<td colspan="5" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Wilcoxon rank sum test</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>L’indice normalisé est compris entre 0 et 1. Plus il est proche de zéro plus les individus sont proches de la norme féminine (en termes de pratiques culturelles).</p>
<p>L’indice est significativement différent selon le sexe biologique des interrogés.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>reg<span class="ot">&lt;-</span> <span class="fu">lm</span>(identity<span class="sc">~</span>Sex, my_data_frame)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = identity ~ Sex, data = my_data_frame)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41933 -0.07875 -0.01093  0.06694  0.58782 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.424436   0.001815  233.79   &lt;2e-16 ***
SexWomen    -0.099669   0.002450  -40.69   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1171 on 9232 degrees of freedom
Multiple R-squared:  0.1521,    Adjusted R-squared:  0.152 
F-statistic:  1656 on 1 and 9232 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Le sexe biologique est très significatif, les valeurs plus faibles de l’indice sont associées au sexe féminin.</p>
</section>
<section id="robustesse" class="level3">
<h3 class="anchored" data-anchor-id="robustesse">Robustesse</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>identity<span class="ot">&lt;-</span> my_data_frame<span class="sc">$</span>identity</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>identity<span class="ot">&lt;-</span>data<span class="sc">$</span>identity</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># List of cultural activities</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>cultural_activities <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>   <span class="st">"Knitting"</span> , </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Cards_games"</span>,  </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Gambling"</span> , </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Cooking"</span> , </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"DIY"</span>  ,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Vegetable_garden"</span> , </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Fishing_hunting"</span> , </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Collection"</span>  ,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Vehicle_custom"</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Making_music"</span>   ,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Diary"</span> ,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Writing"</span> ,  </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Painting"</span>,  </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Montage"</span>  , </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Pottery"</span> , </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Theater"</span> , </span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Drawing"</span> , </span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Dancing"</span>,  </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Photography"</span>  ,</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Genealogy"</span> , </span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Science"</span>  ,</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"None"</span>  ,</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Video_games"</span>  ,</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Library"</span>  ,</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Concert"</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame to store the results</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>result_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Activity =</span> <span class="fu">character</span>(<span class="dv">0</span>), <span class="at">Accuracy =</span> <span class="fu">numeric</span>(<span class="dv">0</span>))</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (activity <span class="cf">in</span> cultural_activities) {</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform a Probit regression for the current cultural activity</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>  model_formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(activity, <span class="st">"~ identity"</span>))</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">glm</span>(model_formula, <span class="at">data =</span> my_data_frame, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>))</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate predictions</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>  predicted <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">predict</span>(model, <span class="at">type =</span> <span class="st">"response"</span>) <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the accuracy</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>  correct_predictions <span class="ot">&lt;-</span> <span class="fu">sum</span>(predicted <span class="sc">==</span> my_data_frame[[activity]])</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>  total_predictions <span class="ot">&lt;-</span> <span class="fu">nrow</span>(my_data_frame)</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>  accuracy <span class="ot">&lt;-</span> (correct_predictions <span class="sc">/</span> total_predictions) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the result to the data frame</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>  result_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_table, <span class="fu">data.frame</span>(<span class="at">Activity =</span> activity, <span class="at">Accuracy =</span> accuracy))</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>result_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           Activity Accuracy
1          Knitting 84.37297
2       Cards_games 51.00715
3          Gambling 79.18562
4           Cooking 56.55187
5               DIY 51.25623
6  Vegetable_garden 72.89365
7   Fishing_hunting 93.95712
8        Collection 92.54927
9    Vehicle_custom 96.85943
10     Making_music 68.16114
11            Diary 85.85662
12          Writing 88.16331
13         Painting 78.76327
14          Montage 84.52458
15          Pottery 89.50617
16          Theater 86.53888
17          Drawing 76.73814
18          Dancing 79.66212
19      Photography 74.53974
20        Genealogy 88.21746
21          Science 88.30409
22             None 70.19710
23      Video_games 62.06411
24          Library 83.20338
25          Concert 81.92549</code></pre>
</div>
</div>
<p>Nous réalisons une série de régressions Probit sur les différentes pratiques culturelles, avec pour unique régresseur notre indice d’identité, afin de mesurer le pouvoir prédictif (ou accuracy) de ce dernier.</p>
</section>
<section id="comparaisons-avec-dautres-mesures" class="level3">
<h3 class="anchored" data-anchor-id="comparaisons-avec-dautres-mesures">Comparaisons avec d’autres mesures ?</h3>
<p>Comparons l’indice obtenu avec d’autres mesures, et plus particulièrement avec les indices échelle d’identité.</p>
<p>Pour cela, nous allons diviser notre indice en 7 catégories, allant du plus féminin au plus masculin.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>identity_scale <span class="ot">&lt;-</span> <span class="fu">cut</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  my_data_frame<span class="sc">$</span>identity,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="dv">7</span>,  <span class="co"># Automatically divide into 7 slices</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Very Feminine"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"Very Masculine"</span>), </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.lowest =</span> <span class="cn">TRUE</span>  </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">&lt;-</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  my_data_frame <span class="sc">|&gt;</span> </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(<span class="at">include =</span> <span class="fu">c</span>(identity_scale),</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">by=</span>Sex ,)<span class="sc">|&gt;</span> </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_p</span>()</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>table1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="lpoyplmypt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lpoyplmypt table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lpoyplmypt thead, #lpoyplmypt tbody, #lpoyplmypt tfoot, #lpoyplmypt tr, #lpoyplmypt td, #lpoyplmypt th {
  border-style: none;
}

#lpoyplmypt p {
  margin: 0;
  padding: 0;
}

#lpoyplmypt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lpoyplmypt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lpoyplmypt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lpoyplmypt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lpoyplmypt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lpoyplmypt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lpoyplmypt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lpoyplmypt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lpoyplmypt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lpoyplmypt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lpoyplmypt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lpoyplmypt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lpoyplmypt .gt_spanner_row {
  border-bottom-style: hidden;
}

#lpoyplmypt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lpoyplmypt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lpoyplmypt .gt_from_md > :first-child {
  margin-top: 0;
}

#lpoyplmypt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lpoyplmypt .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lpoyplmypt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lpoyplmypt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lpoyplmypt .gt_row_group_first td {
  border-top-width: 2px;
}

#lpoyplmypt .gt_row_group_first th {
  border-top-width: 2px;
}

#lpoyplmypt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lpoyplmypt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lpoyplmypt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lpoyplmypt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lpoyplmypt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lpoyplmypt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lpoyplmypt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lpoyplmypt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lpoyplmypt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lpoyplmypt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lpoyplmypt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lpoyplmypt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lpoyplmypt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lpoyplmypt .gt_left {
  text-align: left;
}

#lpoyplmypt .gt_center {
  text-align: center;
}

#lpoyplmypt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lpoyplmypt .gt_font_normal {
  font-weight: normal;
}

#lpoyplmypt .gt_font_bold {
  font-weight: bold;
}

#lpoyplmypt .gt_font_italic {
  font-style: italic;
}

#lpoyplmypt .gt_super {
  font-size: 65%;
}

#lpoyplmypt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lpoyplmypt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lpoyplmypt .gt_indent_1 {
  text-indent: 5px;
}

#lpoyplmypt .gt_indent_2 {
  text-indent: 10px;
}

#lpoyplmypt .gt_indent_3 {
  text-indent: 15px;
}

#lpoyplmypt .gt_indent_4 {
  text-indent: 20px;
}

#lpoyplmypt .gt_indent_5 {
  text-indent: 25px;
}

#lpoyplmypt .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#lpoyplmypt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Men</strong><br> N = 4,162<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Women</strong><br> N = 5,072<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">identity_scale</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Very Feminine</td>
<td class="gt_row gt_center" headers="stat_1">9 (0.2%)</td>
<td class="gt_row gt_center" headers="stat_2">218 (4.3%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;1</td>
<td class="gt_row gt_center" headers="stat_1">403 (9.7%)</td>
<td class="gt_row gt_center" headers="stat_2">1,506 (30%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;2</td>
<td class="gt_row gt_center" headers="stat_1">2,139 (51%)</td>
<td class="gt_row gt_center" headers="stat_2">2,669 (53%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;3</td>
<td class="gt_row gt_center" headers="stat_1">985 (24%)</td>
<td class="gt_row gt_center" headers="stat_2">576 (11%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;4</td>
<td class="gt_row gt_center" headers="stat_1">509 (12%)</td>
<td class="gt_row gt_center" headers="stat_2">90 (1.8%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;5</td>
<td class="gt_row gt_center" headers="stat_1">96 (2.3%)</td>
<td class="gt_row gt_center" headers="stat_2">10 (0.2%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Very Masculine</td>
<td class="gt_row gt_center" headers="stat_1">21 (0.5%)</td>
<td class="gt_row gt_center" headers="stat_2">3 (&lt;0.1%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> n (%)</td>
</tr>
<tr class="even">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Pearson’s Chi-squared test</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>Ce tableau est à mettre en perspective avec les données de <span class="citation" data-cites="trachman_tres_2022">Trachman (<a href="#ref-trachman_tres_2022" role="doc-biblioref">2022a</a>)</span>.</p>
<p>Tout d’abord non remarquons que, comme dans l’enquête de <span class="citation" data-cites="trachman_tres_2022">Trachman (<a href="#ref-trachman_tres_2022" role="doc-biblioref">2022a</a>)</span>, les individus “hors norme” sont peu nombreux (d’après notre indice, moins de 0,1% des femmes ont des pratiques culturelles très masculines; 0,2% des hommes ont des pratiques très féminines) , de même que les individus dont les pratiques culturelles seraient complètement conformes à leur sexe biologique ne sont pas la majorité (4,3% des femmes sont classées comme très féminines, 0,5% des hommes comme très masculins.)</p>
<p>Cela plaide encore une fois pour l’intérêt d’une mesure continue.</p>
<p>Nous allons ensuite explorer plus en détails les variables socio-démographiques qui peuvent influencer notre indice (revenu, âge, catégorie socio-professionnelle …)</p>
</section>
</section>
<section id="variables-socio-économiques-et-identité-de-genre" class="level2">
<h2 class="anchored" data-anchor-id="variables-socio-économiques-et-identité-de-genre">Variables socio-économiques et identité de genre</h2>
<p>Dans cette partie, nous allons analyser les implications socio-économiques de l’identité de genre.</p>
<p>Pour commencer, nous allons regarder les différents profils des individus selon leur indice d’identité.</p>
<p>Puis nous analyserons les liens entre distance à la norme et l’utilité des individus (leur degré de satisfaction.)</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>stat_des_2 <span class="ot">&lt;-</span> my_data_frame <span class="sc">|&gt;</span>  </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(        </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">include =</span> <span class="fu">c</span>(<span class="st">"AGE"</span>, <span class="st">"Income"</span>, <span class="st">"Couple"</span>, <span class="st">"CLASSIF"</span>),         <span class="at">by =</span> <span class="st">"identity_scale"</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_overall</span>(<span class="at">last =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_p</span>(       </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">test.args =</span> <span class="fu">list</span>(           </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="fu">list</span>(<span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>),             <span class="fu">all_categorical</span>() <span class="sc">~</span> <span class="fu">list</span>(<span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)      </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>      )    </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    )  </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>stat_des_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="ijsfzlafcw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ijsfzlafcw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ijsfzlafcw thead, #ijsfzlafcw tbody, #ijsfzlafcw tfoot, #ijsfzlafcw tr, #ijsfzlafcw td, #ijsfzlafcw th {
  border-style: none;
}

#ijsfzlafcw p {
  margin: 0;
  padding: 0;
}

#ijsfzlafcw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ijsfzlafcw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ijsfzlafcw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ijsfzlafcw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ijsfzlafcw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ijsfzlafcw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ijsfzlafcw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ijsfzlafcw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ijsfzlafcw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ijsfzlafcw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ijsfzlafcw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ijsfzlafcw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ijsfzlafcw .gt_spanner_row {
  border-bottom-style: hidden;
}

#ijsfzlafcw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ijsfzlafcw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ijsfzlafcw .gt_from_md > :first-child {
  margin-top: 0;
}

#ijsfzlafcw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ijsfzlafcw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ijsfzlafcw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ijsfzlafcw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ijsfzlafcw .gt_row_group_first td {
  border-top-width: 2px;
}

#ijsfzlafcw .gt_row_group_first th {
  border-top-width: 2px;
}

#ijsfzlafcw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ijsfzlafcw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ijsfzlafcw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ijsfzlafcw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ijsfzlafcw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ijsfzlafcw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ijsfzlafcw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ijsfzlafcw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ijsfzlafcw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ijsfzlafcw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ijsfzlafcw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ijsfzlafcw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ijsfzlafcw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ijsfzlafcw .gt_left {
  text-align: left;
}

#ijsfzlafcw .gt_center {
  text-align: center;
}

#ijsfzlafcw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ijsfzlafcw .gt_font_normal {
  font-weight: normal;
}

#ijsfzlafcw .gt_font_bold {
  font-weight: bold;
}

#ijsfzlafcw .gt_font_italic {
  font-style: italic;
}

#ijsfzlafcw .gt_super {
  font-size: 65%;
}

#ijsfzlafcw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ijsfzlafcw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ijsfzlafcw .gt_indent_1 {
  text-indent: 5px;
}

#ijsfzlafcw .gt_indent_2 {
  text-indent: 10px;
}

#ijsfzlafcw .gt_indent_3 {
  text-indent: 15px;
}

#ijsfzlafcw .gt_indent_4 {
  text-indent: 20px;
}

#ijsfzlafcw .gt_indent_5 {
  text-indent: 25px;
}

#ijsfzlafcw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ijsfzlafcw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Very Feminine</strong><br> N = 227<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>1</strong><br> N = 1,909<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_3" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>2</strong><br> N = 4,808<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_4" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>3</strong><br> N = 1,561<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_5" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>4</strong><br> N = 599<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_6" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>5</strong><br> N = 106<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_7" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Very Masculine</strong><br> N = 24<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_0" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Overall</strong><br> N = 9,234<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">AGE</td>
<td class="gt_row gt_center" headers="stat_1">44 (32, 57)</td>
<td class="gt_row gt_center" headers="stat_2">50 (35, 65)</td>
<td class="gt_row gt_center" headers="stat_3">56 (40, 69)</td>
<td class="gt_row gt_center" headers="stat_4">55 (37, 68)</td>
<td class="gt_row gt_center" headers="stat_5">51 (35, 65)</td>
<td class="gt_row gt_center" headers="stat_6">43 (30, 59)</td>
<td class="gt_row gt_center" headers="stat_7">37 (30, 57)</td>
<td class="gt_row gt_center" headers="stat_0">54 (38, 67)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Income</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_4"><br>
</td>
<td class="gt_row gt_center" headers="stat_5"><br>
</td>
<td class="gt_row gt_center" headers="stat_6"><br>
</td>
<td class="gt_row gt_center" headers="stat_7"><br>
</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;High</td>
<td class="gt_row gt_center" headers="stat_1">88 (44%)</td>
<td class="gt_row gt_center" headers="stat_2">710 (42%)</td>
<td class="gt_row gt_center" headers="stat_3">1,428 (34%)</td>
<td class="gt_row gt_center" headers="stat_4">452 (33%)</td>
<td class="gt_row gt_center" headers="stat_5">175 (33%)</td>
<td class="gt_row gt_center" headers="stat_6">34 (36%)</td>
<td class="gt_row gt_center" headers="stat_7">9 (43%)</td>
<td class="gt_row gt_center" headers="stat_0">2,896 (36%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Low</td>
<td class="gt_row gt_center" headers="stat_1">48 (24%)</td>
<td class="gt_row gt_center" headers="stat_2">382 (23%)</td>
<td class="gt_row gt_center" headers="stat_3">1,118 (27%)</td>
<td class="gt_row gt_center" headers="stat_4">369 (27%)</td>
<td class="gt_row gt_center" headers="stat_5">108 (20%)</td>
<td class="gt_row gt_center" headers="stat_6">17 (18%)</td>
<td class="gt_row gt_center" headers="stat_7">4 (19%)</td>
<td class="gt_row gt_center" headers="stat_0">2,046 (25%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Medium</td>
<td class="gt_row gt_center" headers="stat_1">65 (32%)</td>
<td class="gt_row gt_center" headers="stat_2">592 (35%)</td>
<td class="gt_row gt_center" headers="stat_3">1,631 (39%)</td>
<td class="gt_row gt_center" headers="stat_4">536 (39%)</td>
<td class="gt_row gt_center" headers="stat_5">245 (46%)</td>
<td class="gt_row gt_center" headers="stat_6">43 (46%)</td>
<td class="gt_row gt_center" headers="stat_7">8 (38%)</td>
<td class="gt_row gt_center" headers="stat_0">3,120 (39%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_1">26</td>
<td class="gt_row gt_center" headers="stat_2">225</td>
<td class="gt_row gt_center" headers="stat_3">631</td>
<td class="gt_row gt_center" headers="stat_4">204</td>
<td class="gt_row gt_center" headers="stat_5">71</td>
<td class="gt_row gt_center" headers="stat_6">12</td>
<td class="gt_row gt_center" headers="stat_7">3</td>
<td class="gt_row gt_center" headers="stat_0">1,172</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Couple</td>
<td class="gt_row gt_center" headers="stat_1">109 (48%)</td>
<td class="gt_row gt_center" headers="stat_2">1,013 (53%)</td>
<td class="gt_row gt_center" headers="stat_3">2,594 (54%)</td>
<td class="gt_row gt_center" headers="stat_4">842 (54%)</td>
<td class="gt_row gt_center" headers="stat_5">373 (62%)</td>
<td class="gt_row gt_center" headers="stat_6">68 (64%)</td>
<td class="gt_row gt_center" headers="stat_7">12 (50%)</td>
<td class="gt_row gt_center" headers="stat_0">5,011 (54%)</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_1">2</td>
<td class="gt_row gt_center" headers="stat_2">4</td>
<td class="gt_row gt_center" headers="stat_3">5</td>
<td class="gt_row gt_center" headers="stat_4">1</td>
<td class="gt_row gt_center" headers="stat_5">1</td>
<td class="gt_row gt_center" headers="stat_6">0</td>
<td class="gt_row gt_center" headers="stat_7">0</td>
<td class="gt_row gt_center" headers="stat_0">13</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">CLASSIF</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_4"><br>
</td>
<td class="gt_row gt_center" headers="stat_5"><br>
</td>
<td class="gt_row gt_center" headers="stat_6"><br>
</td>
<td class="gt_row gt_center" headers="stat_7"><br>
</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;1</td>
<td class="gt_row gt_center" headers="stat_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_2">18 (3.2%)</td>
<td class="gt_row gt_center" headers="stat_3">95 (6.8%)</td>
<td class="gt_row gt_center" headers="stat_4">48 (10%)</td>
<td class="gt_row gt_center" headers="stat_5">16 (6.6%)</td>
<td class="gt_row gt_center" headers="stat_6">7 (17%)</td>
<td class="gt_row gt_center" headers="stat_7">2 (18%)</td>
<td class="gt_row gt_center" headers="stat_0">186 (6.6%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;2</td>
<td class="gt_row gt_center" headers="stat_1">6 (8.0%)</td>
<td class="gt_row gt_center" headers="stat_2">61 (11%)</td>
<td class="gt_row gt_center" headers="stat_3">278 (20%)</td>
<td class="gt_row gt_center" headers="stat_4">132 (28%)</td>
<td class="gt_row gt_center" headers="stat_5">98 (40%)</td>
<td class="gt_row gt_center" headers="stat_6">19 (46%)</td>
<td class="gt_row gt_center" headers="stat_7">3 (27%)</td>
<td class="gt_row gt_center" headers="stat_0">597 (21%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;3</td>
<td class="gt_row gt_center" headers="stat_1">3 (4.0%)</td>
<td class="gt_row gt_center" headers="stat_2">36 (6.4%)</td>
<td class="gt_row gt_center" headers="stat_3">148 (11%)</td>
<td class="gt_row gt_center" headers="stat_4">56 (12%)</td>
<td class="gt_row gt_center" headers="stat_5">33 (14%)</td>
<td class="gt_row gt_center" headers="stat_6">6 (15%)</td>
<td class="gt_row gt_center" headers="stat_7">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0">282 (10%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;4</td>
<td class="gt_row gt_center" headers="stat_1">8 (11%)</td>
<td class="gt_row gt_center" headers="stat_2">59 (11%)</td>
<td class="gt_row gt_center" headers="stat_3">140 (10.0%)</td>
<td class="gt_row gt_center" headers="stat_4">47 (9.8%)</td>
<td class="gt_row gt_center" headers="stat_5">22 (9.1%)</td>
<td class="gt_row gt_center" headers="stat_6">4 (9.8%)</td>
<td class="gt_row gt_center" headers="stat_7">3 (27%)</td>
<td class="gt_row gt_center" headers="stat_0">283 (10%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;5</td>
<td class="gt_row gt_center" headers="stat_1">26 (35%)</td>
<td class="gt_row gt_center" headers="stat_2">149 (27%)</td>
<td class="gt_row gt_center" headers="stat_3">229 (16%)</td>
<td class="gt_row gt_center" headers="stat_4">80 (17%)</td>
<td class="gt_row gt_center" headers="stat_5">26 (11%)</td>
<td class="gt_row gt_center" headers="stat_6">3 (7.3%)</td>
<td class="gt_row gt_center" headers="stat_7">1 (9.1%)</td>
<td class="gt_row gt_center" headers="stat_0">514 (18%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;6</td>
<td class="gt_row gt_center" headers="stat_1">29 (39%)</td>
<td class="gt_row gt_center" headers="stat_2">224 (40%)</td>
<td class="gt_row gt_center" headers="stat_3">484 (34%)</td>
<td class="gt_row gt_center" headers="stat_4">110 (23%)</td>
<td class="gt_row gt_center" headers="stat_5">47 (19%)</td>
<td class="gt_row gt_center" headers="stat_6">2 (4.9%)</td>
<td class="gt_row gt_center" headers="stat_7">1 (9.1%)</td>
<td class="gt_row gt_center" headers="stat_0">897 (32%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;7</td>
<td class="gt_row gt_center" headers="stat_1">1 (1.3%)</td>
<td class="gt_row gt_center" headers="stat_2">6 (1.1%)</td>
<td class="gt_row gt_center" headers="stat_3">11 (0.8%)</td>
<td class="gt_row gt_center" headers="stat_4">1 (0.2%)</td>
<td class="gt_row gt_center" headers="stat_5">1 (0.4%)</td>
<td class="gt_row gt_center" headers="stat_6">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_7">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0">20 (0.7%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;8</td>
<td class="gt_row gt_center" headers="stat_1">2 (2.7%)</td>
<td class="gt_row gt_center" headers="stat_2">6 (1.1%)</td>
<td class="gt_row gt_center" headers="stat_3">16 (1.1%)</td>
<td class="gt_row gt_center" headers="stat_4">4 (0.8%)</td>
<td class="gt_row gt_center" headers="stat_5">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_6">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_7">1 (9.1%)</td>
<td class="gt_row gt_center" headers="stat_0">29 (1.0%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;9</td>
<td class="gt_row gt_center" headers="stat_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_3">2 (0.1%)</td>
<td class="gt_row gt_center" headers="stat_4">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_5">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_6">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_7">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0">2 (&lt;0.1%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_1">152</td>
<td class="gt_row gt_center" headers="stat_2">1,350</td>
<td class="gt_row gt_center" headers="stat_3">3,405</td>
<td class="gt_row gt_center" headers="stat_4">1,083</td>
<td class="gt_row gt_center" headers="stat_5">356</td>
<td class="gt_row gt_center" headers="stat_6">65</td>
<td class="gt_row gt_center" headers="stat_7">13</td>
<td class="gt_row gt_center" headers="stat_0">6,424</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="10" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Median (Q1, Q3); n (%)</td>
</tr>
<tr class="even">
<td colspan="10" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Pearson’s Chi-squared test with simulated p-value (based on 2000 replicates); Fisher’s Exact Test for Count Data with simulated p-value (based on 2000 replicates)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>Lecture: Parmi les individus catégorisés comme très féminins selon notre indice, 44% ont des revenus élevés. Les variables étudiées sont significativement différentes selon les degrés d’identité.</p>
<p>Il semble, d’après cette première table descriptive, que l’âge, les niveaux de revenus ainsi que les professions (CLASSIF) jouent un rôle dans l’identité de genre. Tout comme dans l’étude de <span class="citation" data-cites="trachman2022">Trachman (<a href="#ref-trachman2022" role="doc-biblioref">2022b</a>)</span>, les facteurs socio-économiques influencent les variations du genre.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>CLASSIF</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Manoeuvre ou ouvrier spécialisé</td>
</tr>
<tr class="even">
<td>2</td>
<td>Ouvrier qualifié ou hautement qualifié/ technicien(ne) d’atelier</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Technicien(ne)</td>
</tr>
<tr class="even">
<td>4</td>
<td>Agent de maîtrise, maîtrise administrative ou commerciale, VRP (non cadre)</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Ingénieur, Cadre</td>
</tr>
<tr class="even">
<td>6</td>
<td>Employé(e) de bureau, Employé(e) de commerce, Personnel de services</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Directeur général, Adjoint direct</td>
</tr>
<tr class="even">
<td>8</td>
<td>NSP</td>
</tr>
<tr class="odd">
<td>9</td>
<td>REF</td>
</tr>
</tbody>
</table>
<p>On peut regarder si les effets sont différents selon le sexe biologique:</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>stat_des <span class="ot">&lt;-</span> my_data_frame <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tbl_strata</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">strata =</span> Sex,  <span class="co"># Stratification par sexe</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">.tbl_fun =</span> <span class="sc">~</span> .x <span class="sc">|&gt;</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">tbl_summary</span>(</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">include =</span> <span class="fu">c</span>(<span class="st">"AGE"</span>, <span class="st">"Income"</span>, <span class="st">"Couple"</span>, <span class="st">"CLASSIF"</span>),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">by =</span> <span class="st">"identity_scale"</span>  <span class="co"># Stratification supplémentaire par 'identity_scale'</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">|&gt;</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">add_overall</span>(<span class="at">last =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">add_p</span>(</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">test.args =</span> <span class="fu">list</span>(</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="fu">list</span>(<span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">all_categorical</span>() <span class="sc">~</span> <span class="fu">list</span>(<span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>stat_des</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="xayamykrhp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xayamykrhp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xayamykrhp thead, #xayamykrhp tbody, #xayamykrhp tfoot, #xayamykrhp tr, #xayamykrhp td, #xayamykrhp th {
  border-style: none;
}

#xayamykrhp p {
  margin: 0;
  padding: 0;
}

#xayamykrhp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xayamykrhp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xayamykrhp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xayamykrhp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xayamykrhp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xayamykrhp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xayamykrhp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xayamykrhp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xayamykrhp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xayamykrhp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xayamykrhp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xayamykrhp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xayamykrhp .gt_spanner_row {
  border-bottom-style: hidden;
}

#xayamykrhp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xayamykrhp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xayamykrhp .gt_from_md > :first-child {
  margin-top: 0;
}

#xayamykrhp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xayamykrhp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xayamykrhp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xayamykrhp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xayamykrhp .gt_row_group_first td {
  border-top-width: 2px;
}

#xayamykrhp .gt_row_group_first th {
  border-top-width: 2px;
}

#xayamykrhp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xayamykrhp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xayamykrhp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xayamykrhp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xayamykrhp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xayamykrhp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xayamykrhp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xayamykrhp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xayamykrhp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xayamykrhp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xayamykrhp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xayamykrhp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xayamykrhp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xayamykrhp .gt_left {
  text-align: left;
}

#xayamykrhp .gt_center {
  text-align: center;
}

#xayamykrhp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xayamykrhp .gt_font_normal {
  font-weight: normal;
}

#xayamykrhp .gt_font_bold {
  font-weight: bold;
}

#xayamykrhp .gt_font_italic {
  font-style: italic;
}

#xayamykrhp .gt_super {
  font-size: 65%;
}

#xayamykrhp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xayamykrhp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xayamykrhp .gt_indent_1 {
  text-indent: 5px;
}

#xayamykrhp .gt_indent_2 {
  text-indent: 10px;
}

#xayamykrhp .gt_indent_3 {
  text-indent: 15px;
}

#xayamykrhp .gt_indent_4 {
  text-indent: 20px;
}

#xayamykrhp .gt_indent_5 {
  text-indent: 25px;
}

#xayamykrhp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xayamykrhp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th colspan="9" id="**Men**" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
<strong>Men</strong>
</div></th>
<th colspan="9" id="**Women**" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
<strong>Women</strong>
</div></th>
</tr>
<tr class="gt_col_headings even">
<th id="stat_1_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Very Feminine</strong><br> N = 9<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>1</strong><br> N = 403<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_3_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>2</strong><br> N = 2,139<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_4_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>3</strong><br> N = 985<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_5_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>4</strong><br> N = 509<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_6_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>5</strong><br> N = 96<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_7_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Very Masculine</strong><br> N = 21<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_0_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Overall</strong><br> N = 4,162<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
<th id="stat_1_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Very Feminine</strong><br> N = 218<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>1</strong><br> N = 1,506<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_3_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>2</strong><br> N = 2,669<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_4_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>3</strong><br> N = 576<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_5_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>4</strong><br> N = 90<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_6_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>5</strong><br> N = 10<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_7_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Very Masculine</strong><br> N = 3<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_0_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Overall</strong><br> N = 5,072<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">AGE</td>
<td class="gt_row gt_center" headers="stat_1_1">50 (36, 59)</td>
<td class="gt_row gt_center" headers="stat_2_1">54 (39, 66)</td>
<td class="gt_row gt_center" headers="stat_3_1">54 (40, 68)</td>
<td class="gt_row gt_center" headers="stat_4_1">52 (35, 66)</td>
<td class="gt_row gt_center" headers="stat_5_1">52 (36, 65)</td>
<td class="gt_row gt_center" headers="stat_6_1">44 (30, 59)</td>
<td class="gt_row gt_center" headers="stat_7_1">37 (28, 56)</td>
<td class="gt_row gt_center" headers="stat_0_1">53 (38, 66)</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_1_2">44 (32, 56)</td>
<td class="gt_row gt_center" headers="stat_2_2">49 (34, 64)</td>
<td class="gt_row gt_center" headers="stat_3_2">58 (40, 70)</td>
<td class="gt_row gt_center" headers="stat_4_2">57 (39, 71)</td>
<td class="gt_row gt_center" headers="stat_5_2">44 (33, 60)</td>
<td class="gt_row gt_center" headers="stat_6_2">37 (33, 68)</td>
<td class="gt_row gt_center" headers="stat_7_2">34 (33, 57)</td>
<td class="gt_row gt_center" headers="stat_0_2">54 (37, 68)</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Income</td>
<td class="gt_row gt_center" headers="stat_1_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_3_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_4_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_5_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_6_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_7_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_0_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1">0.038</td>
<td class="gt_row gt_center" headers="stat_1_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_2_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_4_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_5_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_6_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_7_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_0_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;High</td>
<td class="gt_row gt_center" headers="stat_1_1">4 (44%)</td>
<td class="gt_row gt_center" headers="stat_2_1">160 (44%)</td>
<td class="gt_row gt_center" headers="stat_3_1">762 (40%)</td>
<td class="gt_row gt_center" headers="stat_4_1">316 (36%)</td>
<td class="gt_row gt_center" headers="stat_5_1">153 (34%)</td>
<td class="gt_row gt_center" headers="stat_6_1">28 (33%)</td>
<td class="gt_row gt_center" headers="stat_7_1">9 (50%)</td>
<td class="gt_row gt_center" headers="stat_0_1">1,432 (39%)</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_1_2">84 (44%)</td>
<td class="gt_row gt_center" headers="stat_2_2">550 (42%)</td>
<td class="gt_row gt_center" headers="stat_3_2">666 (29%)</td>
<td class="gt_row gt_center" headers="stat_4_2">136 (28%)</td>
<td class="gt_row gt_center" headers="stat_5_2">22 (26%)</td>
<td class="gt_row gt_center" headers="stat_6_2">6 (60%)</td>
<td class="gt_row gt_center" headers="stat_7_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0_2">1,464 (33%)</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Low</td>
<td class="gt_row gt_center" headers="stat_1_1">4 (44%)</td>
<td class="gt_row gt_center" headers="stat_2_1">66 (18%)</td>
<td class="gt_row gt_center" headers="stat_3_1">393 (21%)</td>
<td class="gt_row gt_center" headers="stat_4_1">192 (22%)</td>
<td class="gt_row gt_center" headers="stat_5_1">88 (20%)</td>
<td class="gt_row gt_center" headers="stat_6_1">16 (19%)</td>
<td class="gt_row gt_center" headers="stat_7_1">3 (17%)</td>
<td class="gt_row gt_center" headers="stat_0_1">762 (21%)</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_1_2">44 (23%)</td>
<td class="gt_row gt_center" headers="stat_2_2">316 (24%)</td>
<td class="gt_row gt_center" headers="stat_3_2">725 (32%)</td>
<td class="gt_row gt_center" headers="stat_4_2">177 (36%)</td>
<td class="gt_row gt_center" headers="stat_5_2">20 (24%)</td>
<td class="gt_row gt_center" headers="stat_6_2">1 (10%)</td>
<td class="gt_row gt_center" headers="stat_7_2">1 (33%)</td>
<td class="gt_row gt_center" headers="stat_0_2">1,284 (29%)</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Medium</td>
<td class="gt_row gt_center" headers="stat_1_1">1 (11%)</td>
<td class="gt_row gt_center" headers="stat_2_1">134 (37%)</td>
<td class="gt_row gt_center" headers="stat_3_1">733 (39%)</td>
<td class="gt_row gt_center" headers="stat_4_1">359 (41%)</td>
<td class="gt_row gt_center" headers="stat_5_1">203 (46%)</td>
<td class="gt_row gt_center" headers="stat_6_1">40 (48%)</td>
<td class="gt_row gt_center" headers="stat_7_1">6 (33%)</td>
<td class="gt_row gt_center" headers="stat_0_1">1,476 (40%)</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_1_2">64 (33%)</td>
<td class="gt_row gt_center" headers="stat_2_2">458 (35%)</td>
<td class="gt_row gt_center" headers="stat_3_2">898 (39%)</td>
<td class="gt_row gt_center" headers="stat_4_2">177 (36%)</td>
<td class="gt_row gt_center" headers="stat_5_2">42 (50%)</td>
<td class="gt_row gt_center" headers="stat_6_2">3 (30%)</td>
<td class="gt_row gt_center" headers="stat_7_2">2 (67%)</td>
<td class="gt_row gt_center" headers="stat_0_2">1,644 (37%)</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_1_1">0</td>
<td class="gt_row gt_center" headers="stat_2_1">43</td>
<td class="gt_row gt_center" headers="stat_3_1">251</td>
<td class="gt_row gt_center" headers="stat_4_1">118</td>
<td class="gt_row gt_center" headers="stat_5_1">65</td>
<td class="gt_row gt_center" headers="stat_6_1">12</td>
<td class="gt_row gt_center" headers="stat_7_1">3</td>
<td class="gt_row gt_center" headers="stat_0_1">492</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_1_2">26</td>
<td class="gt_row gt_center" headers="stat_2_2">182</td>
<td class="gt_row gt_center" headers="stat_3_2">380</td>
<td class="gt_row gt_center" headers="stat_4_2">86</td>
<td class="gt_row gt_center" headers="stat_5_2">6</td>
<td class="gt_row gt_center" headers="stat_6_2">0</td>
<td class="gt_row gt_center" headers="stat_7_2">0</td>
<td class="gt_row gt_center" headers="stat_0_2">680</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Couple</td>
<td class="gt_row gt_center" headers="stat_1_1">4 (44%)</td>
<td class="gt_row gt_center" headers="stat_2_1">224 (56%)</td>
<td class="gt_row gt_center" headers="stat_3_1">1,271 (59%)</td>
<td class="gt_row gt_center" headers="stat_4_1">561 (57%)</td>
<td class="gt_row gt_center" headers="stat_5_1">314 (62%)</td>
<td class="gt_row gt_center" headers="stat_6_1">59 (61%)</td>
<td class="gt_row gt_center" headers="stat_7_1">11 (52%)</td>
<td class="gt_row gt_center" headers="stat_0_1">2,444 (59%)</td>
<td class="gt_row gt_center" headers="p.value_1">0.3</td>
<td class="gt_row gt_center" headers="stat_1_2">105 (49%)</td>
<td class="gt_row gt_center" headers="stat_2_2">789 (52%)</td>
<td class="gt_row gt_center" headers="stat_3_2">1,323 (50%)</td>
<td class="gt_row gt_center" headers="stat_4_2">281 (49%)</td>
<td class="gt_row gt_center" headers="stat_5_2">59 (66%)</td>
<td class="gt_row gt_center" headers="stat_6_2">9 (90%)</td>
<td class="gt_row gt_center" headers="stat_7_2">1 (33%)</td>
<td class="gt_row gt_center" headers="stat_0_2">2,567 (51%)</td>
<td class="gt_row gt_center" headers="p.value_2">0.004</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_1_1">0</td>
<td class="gt_row gt_center" headers="stat_2_1">1</td>
<td class="gt_row gt_center" headers="stat_3_1">2</td>
<td class="gt_row gt_center" headers="stat_4_1">0</td>
<td class="gt_row gt_center" headers="stat_5_1">1</td>
<td class="gt_row gt_center" headers="stat_6_1">0</td>
<td class="gt_row gt_center" headers="stat_7_1">0</td>
<td class="gt_row gt_center" headers="stat_0_1">4</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_1_2">2</td>
<td class="gt_row gt_center" headers="stat_2_2">3</td>
<td class="gt_row gt_center" headers="stat_3_2">3</td>
<td class="gt_row gt_center" headers="stat_4_2">1</td>
<td class="gt_row gt_center" headers="stat_5_2">0</td>
<td class="gt_row gt_center" headers="stat_6_2">0</td>
<td class="gt_row gt_center" headers="stat_7_2">0</td>
<td class="gt_row gt_center" headers="stat_0_2">9</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">CLASSIF</td>
<td class="gt_row gt_center" headers="stat_1_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_3_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_4_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_5_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_6_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_7_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_0_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1">0.006</td>
<td class="gt_row gt_center" headers="stat_1_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_2_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_4_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_5_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_6_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_7_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_0_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value_2">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;1</td>
<td class="gt_row gt_center" headers="stat_1_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_2_1">6 (5.2%)</td>
<td class="gt_row gt_center" headers="stat_3_1">57 (7.9%)</td>
<td class="gt_row gt_center" headers="stat_4_1">37 (11%)</td>
<td class="gt_row gt_center" headers="stat_5_1">16 (7.7%)</td>
<td class="gt_row gt_center" headers="stat_6_1">6 (16%)</td>
<td class="gt_row gt_center" headers="stat_7_1">1 (11%)</td>
<td class="gt_row gt_center" headers="stat_0_1">123 (8.7%)</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_1_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_2_2">12 (2.7%)</td>
<td class="gt_row gt_center" headers="stat_3_2">38 (5.5%)</td>
<td class="gt_row gt_center" headers="stat_4_2">11 (7.7%)</td>
<td class="gt_row gt_center" headers="stat_5_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_6_2">1 (25%)</td>
<td class="gt_row gt_center" headers="stat_7_2">1 (50%)</td>
<td class="gt_row gt_center" headers="stat_0_2">63 (4.5%)</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;2</td>
<td class="gt_row gt_center" headers="stat_1_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_2_1">24 (21%)</td>
<td class="gt_row gt_center" headers="stat_3_1">214 (30%)</td>
<td class="gt_row gt_center" headers="stat_4_1">109 (33%)</td>
<td class="gt_row gt_center" headers="stat_5_1">87 (42%)</td>
<td class="gt_row gt_center" headers="stat_6_1">17 (46%)</td>
<td class="gt_row gt_center" headers="stat_7_1">3 (33%)</td>
<td class="gt_row gt_center" headers="stat_0_1">454 (32%)</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_1_2">6 (8.1%)</td>
<td class="gt_row gt_center" headers="stat_2_2">37 (8.3%)</td>
<td class="gt_row gt_center" headers="stat_3_2">64 (9.3%)</td>
<td class="gt_row gt_center" headers="stat_4_2">23 (16%)</td>
<td class="gt_row gt_center" headers="stat_5_2">11 (31%)</td>
<td class="gt_row gt_center" headers="stat_6_2">2 (50%)</td>
<td class="gt_row gt_center" headers="stat_7_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0_2">143 (10%)</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;3</td>
<td class="gt_row gt_center" headers="stat_1_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_2_1">15 (13%)</td>
<td class="gt_row gt_center" headers="stat_3_1">98 (14%)</td>
<td class="gt_row gt_center" headers="stat_4_1">42 (13%)</td>
<td class="gt_row gt_center" headers="stat_5_1">30 (14%)</td>
<td class="gt_row gt_center" headers="stat_6_1">5 (14%)</td>
<td class="gt_row gt_center" headers="stat_7_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0_1">190 (13%)</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_1_2">3 (4.1%)</td>
<td class="gt_row gt_center" headers="stat_2_2">21 (4.7%)</td>
<td class="gt_row gt_center" headers="stat_3_2">50 (7.3%)</td>
<td class="gt_row gt_center" headers="stat_4_2">14 (9.8%)</td>
<td class="gt_row gt_center" headers="stat_5_2">3 (8.3%)</td>
<td class="gt_row gt_center" headers="stat_6_2">1 (25%)</td>
<td class="gt_row gt_center" headers="stat_7_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0_2">92 (6.6%)</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;4</td>
<td class="gt_row gt_center" headers="stat_1_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_2_1">15 (13%)</td>
<td class="gt_row gt_center" headers="stat_3_1">76 (11%)</td>
<td class="gt_row gt_center" headers="stat_4_1">37 (11%)</td>
<td class="gt_row gt_center" headers="stat_5_1">22 (11%)</td>
<td class="gt_row gt_center" headers="stat_6_1">4 (11%)</td>
<td class="gt_row gt_center" headers="stat_7_1">3 (33%)</td>
<td class="gt_row gt_center" headers="stat_0_1">157 (11%)</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_1_2">8 (11%)</td>
<td class="gt_row gt_center" headers="stat_2_2">44 (9.9%)</td>
<td class="gt_row gt_center" headers="stat_3_2">64 (9.3%)</td>
<td class="gt_row gt_center" headers="stat_4_2">10 (7.0%)</td>
<td class="gt_row gt_center" headers="stat_5_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_6_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_7_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0_2">126 (9.1%)</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;5</td>
<td class="gt_row gt_center" headers="stat_1_1">1 (100%)</td>
<td class="gt_row gt_center" headers="stat_2_1">31 (27%)</td>
<td class="gt_row gt_center" headers="stat_3_1">151 (21%)</td>
<td class="gt_row gt_center" headers="stat_4_1">66 (20%)</td>
<td class="gt_row gt_center" headers="stat_5_1">25 (12%)</td>
<td class="gt_row gt_center" headers="stat_6_1">3 (8.1%)</td>
<td class="gt_row gt_center" headers="stat_7_1">1 (11%)</td>
<td class="gt_row gt_center" headers="stat_0_1">278 (20%)</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_1_2">25 (34%)</td>
<td class="gt_row gt_center" headers="stat_2_2">118 (27%)</td>
<td class="gt_row gt_center" headers="stat_3_2">78 (11%)</td>
<td class="gt_row gt_center" headers="stat_4_2">14 (9.8%)</td>
<td class="gt_row gt_center" headers="stat_5_2">1 (2.8%)</td>
<td class="gt_row gt_center" headers="stat_6_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_7_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0_2">236 (17%)</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;6</td>
<td class="gt_row gt_center" headers="stat_1_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_2_1">21 (18%)</td>
<td class="gt_row gt_center" headers="stat_3_1">104 (15%)</td>
<td class="gt_row gt_center" headers="stat_4_1">41 (12%)</td>
<td class="gt_row gt_center" headers="stat_5_1">26 (13%)</td>
<td class="gt_row gt_center" headers="stat_6_1">2 (5.4%)</td>
<td class="gt_row gt_center" headers="stat_7_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0_1">194 (14%)</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_1_2">29 (39%)</td>
<td class="gt_row gt_center" headers="stat_2_2">203 (46%)</td>
<td class="gt_row gt_center" headers="stat_3_2">380 (55%)</td>
<td class="gt_row gt_center" headers="stat_4_2">69 (48%)</td>
<td class="gt_row gt_center" headers="stat_5_2">21 (58%)</td>
<td class="gt_row gt_center" headers="stat_6_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_7_2">1 (50%)</td>
<td class="gt_row gt_center" headers="stat_0_2">703 (51%)</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;7</td>
<td class="gt_row gt_center" headers="stat_1_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_2_1">2 (1.7%)</td>
<td class="gt_row gt_center" headers="stat_3_1">9 (1.3%)</td>
<td class="gt_row gt_center" headers="stat_4_1">1 (0.3%)</td>
<td class="gt_row gt_center" headers="stat_5_1">1 (0.5%)</td>
<td class="gt_row gt_center" headers="stat_6_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_7_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0_1">13 (0.9%)</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_1_2">1 (1.4%)</td>
<td class="gt_row gt_center" headers="stat_2_2">4 (0.9%)</td>
<td class="gt_row gt_center" headers="stat_3_2">2 (0.3%)</td>
<td class="gt_row gt_center" headers="stat_4_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_5_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_6_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_7_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0_2">7 (0.5%)</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;8</td>
<td class="gt_row gt_center" headers="stat_1_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_2_1">1 (0.9%)</td>
<td class="gt_row gt_center" headers="stat_3_1">7 (1.0%)</td>
<td class="gt_row gt_center" headers="stat_4_1">2 (0.6%)</td>
<td class="gt_row gt_center" headers="stat_5_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_6_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_7_1">1 (11%)</td>
<td class="gt_row gt_center" headers="stat_0_1">11 (0.8%)</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_1_2">2 (2.7%)</td>
<td class="gt_row gt_center" headers="stat_2_2">5 (1.1%)</td>
<td class="gt_row gt_center" headers="stat_3_2">9 (1.3%)</td>
<td class="gt_row gt_center" headers="stat_4_2">2 (1.4%)</td>
<td class="gt_row gt_center" headers="stat_5_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_6_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_7_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0_2">18 (1.3%)</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;9</td>
<td class="gt_row gt_center" headers="stat_1_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_2_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_3_1">1 (0.1%)</td>
<td class="gt_row gt_center" headers="stat_4_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_5_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_6_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_7_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0_1">1 (&lt;0.1%)</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_1_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_2_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_3_2">1 (0.1%)</td>
<td class="gt_row gt_center" headers="stat_4_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_5_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_6_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_7_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0_2">1 (&lt;0.1%)</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_1_1">8</td>
<td class="gt_row gt_center" headers="stat_2_1">288</td>
<td class="gt_row gt_center" headers="stat_3_1">1,422</td>
<td class="gt_row gt_center" headers="stat_4_1">650</td>
<td class="gt_row gt_center" headers="stat_5_1">302</td>
<td class="gt_row gt_center" headers="stat_6_1">59</td>
<td class="gt_row gt_center" headers="stat_7_1">12</td>
<td class="gt_row gt_center" headers="stat_0_1">2,741</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_1_2">144</td>
<td class="gt_row gt_center" headers="stat_2_2">1,062</td>
<td class="gt_row gt_center" headers="stat_3_2">1,983</td>
<td class="gt_row gt_center" headers="stat_4_2">433</td>
<td class="gt_row gt_center" headers="stat_5_2">54</td>
<td class="gt_row gt_center" headers="stat_6_2">6</td>
<td class="gt_row gt_center" headers="stat_7_2">1</td>
<td class="gt_row gt_center" headers="stat_0_2">3,683</td>
<td class="gt_row gt_center" headers="p.value_2"><br>
</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="19" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Median (Q1, Q3); n (%)</td>
</tr>
<tr class="even">
<td colspan="19" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Fisher’s Exact Test for Count Data with simulated p-value (based on 2000 replicates)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>Lecture: Parmi les hommes classés comme très féminins, 27% appartiennent à la catégorie socio-professionnelle 5 (ingénieur, cadre)</p>
<section id="distance-à-la-norme" class="level3">
<h3 class="anchored" data-anchor-id="distance-à-la-norme">Distance à la norme</h3>
<p>Nous l’évoquions au début de ce document, ce qui nous intéresse en proposant une mesure continue des variations du genre c’est de pouvoir analyser les distances prises avec les normes de son groupe de référence.</p>
<p>Pour cela, nous allons construire la variable “Distance à la norme”</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>mean_gender <span class="ot">&lt;-</span> <span class="fu">tapply</span>(my_data_frame<span class="sc">$</span>identity, my_data_frame<span class="sc">$</span>Sex, mean)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>sd_gender <span class="ot">&lt;-</span> <span class="fu">tapply</span>(my_data_frame<span class="sc">$</span>identity, my_data_frame<span class="sc">$</span>Sex, sd)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>distance<span class="ot">&lt;-</span> (my_data_frame<span class="sc">$</span>identity <span class="sc">-</span> mean_gender[my_data_frame<span class="sc">$</span>Sex]) <span class="sc">/</span> sd_gender[my_data_frame<span class="sc">$</span>Sex]</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my_data_frame, <span class="fu">aes</span>(<span class="at">x =</span> distance, <span class="at">color =</span> Sex, <span class="at">fill =</span> Sex)) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density of Distance to the Norm, by Sex"</span>, </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Distance to the Norm (Z-score)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"pink"</span>)) <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"pink"</span>)) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Ou en valeur absolue: </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>mean_gender <span class="ot">&lt;-</span> <span class="fu">tapply</span>(my_data_frame<span class="sc">$</span>identity, my_data_frame<span class="sc">$</span>Sex, mean)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>sd_gender <span class="ot">&lt;-</span> <span class="fu">tapply</span>(my_data_frame<span class="sc">$</span>identity, my_data_frame<span class="sc">$</span>Sex, sd)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>distance_abs<span class="ot">&lt;-</span> <span class="fu">abs</span>((my_data_frame<span class="sc">$</span>identity <span class="sc">-</span> mean_gender[my_data_frame<span class="sc">$</span>Sex]) <span class="sc">/</span> sd_gender[my_data_frame<span class="sc">$</span>Sex])</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my_data_frame, <span class="fu">aes</span>(<span class="at">x =</span> distance_abs, <span class="at">color =</span> Sex, <span class="at">fill =</span> Sex)) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density of Distance to the Norm, by Sex"</span>, </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Distance to the Norm (Z-score)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"pink"</span>)) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"pink"</span>)) <span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Catégorisation par quartiles</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>categories <span class="ot">&lt;-</span> <span class="fu">cut</span>(my_data_frame<span class="sc">$</span>distance, <span class="at">breaks =</span> <span class="dv">4</span>, <span class="at">include.lowest =</span> <span class="cn">TRUE</span>,<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"very Feminine"</span>,<span class="st">"Feminine"</span>, <span class="st">"Masculine"</span>, <span class="st">"very masculine"</span> ))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">#my_data_frame$categories &lt;- cut(my_data_frame$distance,                         breaks = quantile(my_data_frame$distance, probs = c(0, 0.25, 0.75, 1), na.rm = TRUE),                         labels = c("Feminine Norms", "Medium", "Masculine Norms"),                         include.lowest = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="distance-aux-normes-et-satisfaction" class="level3">
<h3 class="anchored" data-anchor-id="distance-aux-normes-et-satisfaction">Distance aux normes et satisfaction</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>satisfaction<span class="ot">&lt;-</span><span class="fu">as.factor</span>((my_data_frame<span class="sc">$</span>satisfaction))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordinal logistic regression model fitting</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>ordinal_model <span class="ot">&lt;-</span> <span class="fu">polr</span>(satisfaction <span class="sc">~</span> distance, <span class="at">data =</span> my_data_frame, <span class="at">Hess =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Predict the probabilities for each category</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>distance_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(my_data_frame<span class="sc">$</span>distance), <span class="fu">max</span>(my_data_frame<span class="sc">$</span>distance))</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">distance =</span> distance_vals)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>predicted_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(ordinal_model, <span class="at">newdata =</span> new_data, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Convert results to dataframe</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>predicted_probs_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(predicted_probs)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>predicted_probs_df<span class="sc">$</span>distance <span class="ot">&lt;-</span> distance_vals</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Transform data into long format for ggplot2</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>predicted_probs_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(predicted_probs_df, </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">cols =</span> <span class="sc">-</span>distance, </span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">names_to =</span> <span class="st">"satisfaction"</span>, </span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">values_to =</span> <span class="st">"probabilite"</span>)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Visualize predicted probabilities</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predicted_probs_long, <span class="fu">aes</span>(<span class="at">x =</span> distance, <span class="at">y =</span> probabilite, <span class="at">color =</span> satisfaction)) <span class="sc">+</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Probability of satisfaction as a function of deviation from Norms"</span>,</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Distance to the Norm"</span>,</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La satisfaction est mesurée comme étant la réponse à la question “Vous arrive-t-il d’avoir le sentiment de manquer de temps libre pour faire tout ce dont vous avez envie ?”</p>
<p>Ce graphique semble indiquer que la satisfaction en termes de temps libre croît avec la distance à sa norme de genre.</p>
<p>Cet effet est-il vérifié pour les différents niveaux de revenus et le sexe biologique?</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph with only lines and no scatter points</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my_data_frame, <span class="fu">aes</span>(<span class="at">x =</span> distance, <span class="at">y =</span> <span class="fu">as.numeric</span>(satisfaction), <span class="at">color =</span> <span class="fu">as.factor</span>(Income))) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="fu">as.factor</span>(Income)), <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="co"># Regression curves without confidence intervals and different line types                              # Gray scale palette</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Low"</span> <span class="ot">=</span> <span class="st">"solid"</span>, <span class="st">"Medium"</span> <span class="ot">=</span> <span class="st">"dashed"</span>, <span class="st">"High"</span> <span class="ot">=</span> <span class="st">"twodash"</span>)) <span class="sc">+</span>  <span class="co"># Line types: solid, dashed, and twodash for the 3rd</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Interaction between Distance to the Norm and Income Groups"</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Distance to the Norm (z-score)"</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Satisfaction (ordinal)"</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Income (grouped)"</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"Line Type"</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>                                                      <span class="co"># Minimalist theme</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),                                       <span class="co"># Text size</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),                                          <span class="co"># Remove gridlines</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),                                        <span class="co"># Remove borders around the plot</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_blank</span>(),                                     <span class="co"># Remove gray background</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,                                              <span class="co"># Place legend at the top</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>),                            <span class="co"># Axis titles in black</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>)                              <span class="co"># Axis text in black</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>L’effet semble s’inverser pour les bas revenus, s’écarter de la norme s’accompagne d’une baisse de la satisfaction ressentie.</p>
<p>Qu’en est-il si on regarde ces effets par sexe?</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>base_femmes <span class="ot">&lt;-</span> my_data_frame <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sex <span class="sc">==</span> <span class="st">"Women"</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a table without NA</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>femmes_categories <span class="ot">&lt;-</span> base_femmes <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">include =</span> <span class="fu">c</span>(Income, LNAIS, Couple,satisfaction, Health, age_group),</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> categories,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="sc">~</span> <span class="st">"{p}%"</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent =</span> <span class="st">"row"</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">missing =</span> <span class="st">"no"</span>  </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_p</span>()</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>femmes_categories</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="wwtnyuquyu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wwtnyuquyu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wwtnyuquyu thead, #wwtnyuquyu tbody, #wwtnyuquyu tfoot, #wwtnyuquyu tr, #wwtnyuquyu td, #wwtnyuquyu th {
  border-style: none;
}

#wwtnyuquyu p {
  margin: 0;
  padding: 0;
}

#wwtnyuquyu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wwtnyuquyu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wwtnyuquyu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wwtnyuquyu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wwtnyuquyu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wwtnyuquyu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wwtnyuquyu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wwtnyuquyu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wwtnyuquyu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wwtnyuquyu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wwtnyuquyu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wwtnyuquyu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wwtnyuquyu .gt_spanner_row {
  border-bottom-style: hidden;
}

#wwtnyuquyu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wwtnyuquyu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wwtnyuquyu .gt_from_md > :first-child {
  margin-top: 0;
}

#wwtnyuquyu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wwtnyuquyu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wwtnyuquyu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wwtnyuquyu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wwtnyuquyu .gt_row_group_first td {
  border-top-width: 2px;
}

#wwtnyuquyu .gt_row_group_first th {
  border-top-width: 2px;
}

#wwtnyuquyu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wwtnyuquyu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wwtnyuquyu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wwtnyuquyu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wwtnyuquyu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wwtnyuquyu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wwtnyuquyu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wwtnyuquyu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wwtnyuquyu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wwtnyuquyu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wwtnyuquyu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wwtnyuquyu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wwtnyuquyu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wwtnyuquyu .gt_left {
  text-align: left;
}

#wwtnyuquyu .gt_center {
  text-align: center;
}

#wwtnyuquyu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wwtnyuquyu .gt_font_normal {
  font-weight: normal;
}

#wwtnyuquyu .gt_font_bold {
  font-weight: bold;
}

#wwtnyuquyu .gt_font_italic {
  font-style: italic;
}

#wwtnyuquyu .gt_super {
  font-size: 65%;
}

#wwtnyuquyu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wwtnyuquyu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wwtnyuquyu .gt_indent_1 {
  text-indent: 5px;
}

#wwtnyuquyu .gt_indent_2 {
  text-indent: 10px;
}

#wwtnyuquyu .gt_indent_3 {
  text-indent: 15px;
}

#wwtnyuquyu .gt_indent_4 {
  text-indent: 20px;
}

#wwtnyuquyu .gt_indent_5 {
  text-indent: 25px;
}

#wwtnyuquyu .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wwtnyuquyu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>very Feminine</strong><br> N = 713<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Feminine</strong><br> N = 3,871<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_3" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Masculine</strong><br> N = 467<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_4" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>very masculine</strong><br> N = 21<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">Income</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_4"><br>
</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;High</td>
<td class="gt_row gt_center" headers="stat_1">20%</td>
<td class="gt_row gt_center" headers="stat_2">72%</td>
<td class="gt_row gt_center" headers="stat_3">8.2%</td>
<td class="gt_row gt_center" headers="stat_4">0.6%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Low</td>
<td class="gt_row gt_center" headers="stat_1">11%</td>
<td class="gt_row gt_center" headers="stat_2">79%</td>
<td class="gt_row gt_center" headers="stat_3">9.1%</td>
<td class="gt_row gt_center" headers="stat_4">0.3%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Medium</td>
<td class="gt_row gt_center" headers="stat_1">12%</td>
<td class="gt_row gt_center" headers="stat_2">77%</td>
<td class="gt_row gt_center" headers="stat_3">10.0%</td>
<td class="gt_row gt_center" headers="stat_4">0.5%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">LNAIS</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_4"><br>
</td>
<td class="gt_row gt_center" headers="p.value">&gt;0.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;1</td>
<td class="gt_row gt_center" headers="stat_1">14%</td>
<td class="gt_row gt_center" headers="stat_2">76%</td>
<td class="gt_row gt_center" headers="stat_3">9.3%</td>
<td class="gt_row gt_center" headers="stat_4">0.4%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;2</td>
<td class="gt_row gt_center" headers="stat_1">14%</td>
<td class="gt_row gt_center" headers="stat_2">77%</td>
<td class="gt_row gt_center" headers="stat_3">8.6%</td>
<td class="gt_row gt_center" headers="stat_4">0.4%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Couple</td>
<td class="gt_row gt_center" headers="stat_1">14%</td>
<td class="gt_row gt_center" headers="stat_2">76%</td>
<td class="gt_row gt_center" headers="stat_3">9.8%</td>
<td class="gt_row gt_center" headers="stat_4">0.6%</td>
<td class="gt_row gt_center" headers="p.value">0.041</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">satisfaction</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_4"><br>
</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;High</td>
<td class="gt_row gt_center" headers="stat_1">8.5%</td>
<td class="gt_row gt_center" headers="stat_2">81%</td>
<td class="gt_row gt_center" headers="stat_3">10.0%</td>
<td class="gt_row gt_center" headers="stat_4">0.2%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Low</td>
<td class="gt_row gt_center" headers="stat_1">18%</td>
<td class="gt_row gt_center" headers="stat_2">73%</td>
<td class="gt_row gt_center" headers="stat_3">8.8%</td>
<td class="gt_row gt_center" headers="stat_4">0.5%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Medium</td>
<td class="gt_row gt_center" headers="stat_1">15%</td>
<td class="gt_row gt_center" headers="stat_2">76%</td>
<td class="gt_row gt_center" headers="stat_3">8.9%</td>
<td class="gt_row gt_center" headers="stat_4">0.5%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Health</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_4"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Bad</td>
<td class="gt_row gt_center" headers="stat_1">8.5%</td>
<td class="gt_row gt_center" headers="stat_2">82%</td>
<td class="gt_row gt_center" headers="stat_3">9.1%</td>
<td class="gt_row gt_center" headers="stat_4">0.2%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Good</td>
<td class="gt_row gt_center" headers="stat_1">16%</td>
<td class="gt_row gt_center" headers="stat_2">75%</td>
<td class="gt_row gt_center" headers="stat_3">8.8%</td>
<td class="gt_row gt_center" headers="stat_4">0.4%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Medium</td>
<td class="gt_row gt_center" headers="stat_1">11%</td>
<td class="gt_row gt_center" headers="stat_2">78%</td>
<td class="gt_row gt_center" headers="stat_3">10%</td>
<td class="gt_row gt_center" headers="stat_4">0.5%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">age_group</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_4"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;[15-38[</td>
<td class="gt_row gt_center" headers="stat_1">20%</td>
<td class="gt_row gt_center" headers="stat_2">69%</td>
<td class="gt_row gt_center" headers="stat_3">10%</td>
<td class="gt_row gt_center" headers="stat_4">1.0%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;[38-54[</td>
<td class="gt_row gt_center" headers="stat_1">17%</td>
<td class="gt_row gt_center" headers="stat_2">73%</td>
<td class="gt_row gt_center" headers="stat_3">9.4%</td>
<td class="gt_row gt_center" headers="stat_4">0.3%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;[54-67[</td>
<td class="gt_row gt_center" headers="stat_1">9.7%</td>
<td class="gt_row gt_center" headers="stat_2">81%</td>
<td class="gt_row gt_center" headers="stat_3">9.0%</td>
<td class="gt_row gt_center" headers="stat_4">0.2%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;[67-97[</td>
<td class="gt_row gt_center" headers="stat_1">6.1%</td>
<td class="gt_row gt_center" headers="stat_2">86%</td>
<td class="gt_row gt_center" headers="stat_3">7.7%</td>
<td class="gt_row gt_center" headers="stat_4">0.2%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="6" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> </td>
</tr>
<tr class="even">
<td colspan="6" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Pearson’s Chi-squared test; Fisher’s exact test</td>
</tr>
</tfoot>

</table>

</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>base_hommes <span class="ot">&lt;-</span> my_data_frame <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sex <span class="sc">==</span> <span class="st">"Men"</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>hommes_categories <span class="ot">&lt;-</span> base_hommes <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">include =</span> <span class="fu">c</span>(Income, LNAIS, Couple, satisfaction, Health, age_group),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> categories,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="sc">~</span> <span class="st">"{p}%"</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent =</span> <span class="st">"row"</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">missing =</span> <span class="st">"no"</span>  </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_p</span>()</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>hommes_categories</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="kvsxyizzlm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kvsxyizzlm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kvsxyizzlm thead, #kvsxyizzlm tbody, #kvsxyizzlm tfoot, #kvsxyizzlm tr, #kvsxyizzlm td, #kvsxyizzlm th {
  border-style: none;
}

#kvsxyizzlm p {
  margin: 0;
  padding: 0;
}

#kvsxyizzlm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kvsxyizzlm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kvsxyizzlm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kvsxyizzlm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kvsxyizzlm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kvsxyizzlm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kvsxyizzlm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kvsxyizzlm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kvsxyizzlm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kvsxyizzlm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kvsxyizzlm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kvsxyizzlm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kvsxyizzlm .gt_spanner_row {
  border-bottom-style: hidden;
}

#kvsxyizzlm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kvsxyizzlm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kvsxyizzlm .gt_from_md > :first-child {
  margin-top: 0;
}

#kvsxyizzlm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kvsxyizzlm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kvsxyizzlm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kvsxyizzlm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kvsxyizzlm .gt_row_group_first td {
  border-top-width: 2px;
}

#kvsxyizzlm .gt_row_group_first th {
  border-top-width: 2px;
}

#kvsxyizzlm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvsxyizzlm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kvsxyizzlm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kvsxyizzlm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kvsxyizzlm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvsxyizzlm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kvsxyizzlm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kvsxyizzlm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kvsxyizzlm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kvsxyizzlm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kvsxyizzlm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvsxyizzlm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kvsxyizzlm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvsxyizzlm .gt_left {
  text-align: left;
}

#kvsxyizzlm .gt_center {
  text-align: center;
}

#kvsxyizzlm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kvsxyizzlm .gt_font_normal {
  font-weight: normal;
}

#kvsxyizzlm .gt_font_bold {
  font-weight: bold;
}

#kvsxyizzlm .gt_font_italic {
  font-style: italic;
}

#kvsxyizzlm .gt_super {
  font-size: 65%;
}

#kvsxyizzlm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kvsxyizzlm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kvsxyizzlm .gt_indent_1 {
  text-indent: 5px;
}

#kvsxyizzlm .gt_indent_2 {
  text-indent: 10px;
}

#kvsxyizzlm .gt_indent_3 {
  text-indent: 15px;
}

#kvsxyizzlm .gt_indent_4 {
  text-indent: 20px;
}

#kvsxyizzlm .gt_indent_5 {
  text-indent: 25px;
}

#kvsxyizzlm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kvsxyizzlm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>very Feminine</strong><br> N = 455<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Feminine</strong><br> N = 3,112<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_3" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Masculine</strong><br> N = 575<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_4" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>very masculine</strong><br> N = 20<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">Income</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_4"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;High</td>
<td class="gt_row gt_center" headers="stat_1">13%</td>
<td class="gt_row gt_center" headers="stat_2">74%</td>
<td class="gt_row gt_center" headers="stat_3">12%</td>
<td class="gt_row gt_center" headers="stat_4">0.6%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Low</td>
<td class="gt_row gt_center" headers="stat_1">10%</td>
<td class="gt_row gt_center" headers="stat_2">76%</td>
<td class="gt_row gt_center" headers="stat_3">13%</td>
<td class="gt_row gt_center" headers="stat_4">0.4%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Medium</td>
<td class="gt_row gt_center" headers="stat_1">9.8%</td>
<td class="gt_row gt_center" headers="stat_2">75%</td>
<td class="gt_row gt_center" headers="stat_3">15%</td>
<td class="gt_row gt_center" headers="stat_4">0.3%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">LNAIS</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_4"><br>
</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;1</td>
<td class="gt_row gt_center" headers="stat_1">11%</td>
<td class="gt_row gt_center" headers="stat_2">74%</td>
<td class="gt_row gt_center" headers="stat_3">15%</td>
<td class="gt_row gt_center" headers="stat_4">0.5%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;2</td>
<td class="gt_row gt_center" headers="stat_1">14%</td>
<td class="gt_row gt_center" headers="stat_2">79%</td>
<td class="gt_row gt_center" headers="stat_3">6.1%</td>
<td class="gt_row gt_center" headers="stat_4">0.2%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Couple</td>
<td class="gt_row gt_center" headers="stat_1">10%</td>
<td class="gt_row gt_center" headers="stat_2">75%</td>
<td class="gt_row gt_center" headers="stat_3">15%</td>
<td class="gt_row gt_center" headers="stat_4">0.5%</td>
<td class="gt_row gt_center" headers="p.value">0.3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">satisfaction</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_4"><br>
</td>
<td class="gt_row gt_center" headers="p.value">0.5</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;High</td>
<td class="gt_row gt_center" headers="stat_1">11%</td>
<td class="gt_row gt_center" headers="stat_2">76%</td>
<td class="gt_row gt_center" headers="stat_3">13%</td>
<td class="gt_row gt_center" headers="stat_4">0.3%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Low</td>
<td class="gt_row gt_center" headers="stat_1">11%</td>
<td class="gt_row gt_center" headers="stat_2">73%</td>
<td class="gt_row gt_center" headers="stat_3">15%</td>
<td class="gt_row gt_center" headers="stat_4">0.5%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Medium</td>
<td class="gt_row gt_center" headers="stat_1">11%</td>
<td class="gt_row gt_center" headers="stat_2">75%</td>
<td class="gt_row gt_center" headers="stat_3">13%</td>
<td class="gt_row gt_center" headers="stat_4">0.7%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Health</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_4"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Bad</td>
<td class="gt_row gt_center" headers="stat_1">8.1%</td>
<td class="gt_row gt_center" headers="stat_2">80%</td>
<td class="gt_row gt_center" headers="stat_3">12%</td>
<td class="gt_row gt_center" headers="stat_4">0%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Good</td>
<td class="gt_row gt_center" headers="stat_1">11%</td>
<td class="gt_row gt_center" headers="stat_2">74%</td>
<td class="gt_row gt_center" headers="stat_3">14%</td>
<td class="gt_row gt_center" headers="stat_4">0.6%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Medium</td>
<td class="gt_row gt_center" headers="stat_1">10%</td>
<td class="gt_row gt_center" headers="stat_2">76%</td>
<td class="gt_row gt_center" headers="stat_3">14%</td>
<td class="gt_row gt_center" headers="stat_4">0.1%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">age_group</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_4"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;[15-38[</td>
<td class="gt_row gt_center" headers="stat_1">10%</td>
<td class="gt_row gt_center" headers="stat_2">72%</td>
<td class="gt_row gt_center" headers="stat_3">17%</td>
<td class="gt_row gt_center" headers="stat_4">1.0%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;[38-54[</td>
<td class="gt_row gt_center" headers="stat_1">11%</td>
<td class="gt_row gt_center" headers="stat_2">75%</td>
<td class="gt_row gt_center" headers="stat_3">13%</td>
<td class="gt_row gt_center" headers="stat_4">0.5%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;[54-67[</td>
<td class="gt_row gt_center" headers="stat_1">11%</td>
<td class="gt_row gt_center" headers="stat_2">75%</td>
<td class="gt_row gt_center" headers="stat_3">14%</td>
<td class="gt_row gt_center" headers="stat_4">0.3%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;[67-97[</td>
<td class="gt_row gt_center" headers="stat_1">12%</td>
<td class="gt_row gt_center" headers="stat_2">79%</td>
<td class="gt_row gt_center" headers="stat_3">8.8%</td>
<td class="gt_row gt_center" headers="stat_4">0%</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="6" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> </td>
</tr>
<tr class="even">
<td colspan="6" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Fisher’s exact test; Pearson’s Chi-squared test</td>
</tr>
</tfoot>

</table>

</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ordinal logistic regression model including SEX</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>ordinal_model2 <span class="ot">&lt;-</span> <span class="fu">polr</span>(satisfaction <span class="sc">~</span> distance <span class="sc">*</span> Sex, <span class="at">data =</span> my_data_frame, <span class="at">Hess =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sequence of values for conformity</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>conformity_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(my_data_frame<span class="sc">$</span>distance), <span class="fu">max</span>(my_data_frame<span class="sc">$</span>distance))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new dataset with all combinations of conformity and SEX</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">distance =</span> distance_vals, <span class="at">Sex =</span> <span class="fu">c</span>(<span class="st">"Men"</span>, <span class="st">"Women"</span>))</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict probabilities for each combination of conformity and SEXE</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>predicted_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(ordinal_model2, <span class="at">newdata =</span> new_data, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert results to dataframe</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>predicted_probs_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(predicted_probs)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>predicted_probs_df<span class="sc">$</span>distance <span class="ot">&lt;-</span> new_data<span class="sc">$</span>distance</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>predicted_probs_df<span class="sc">$</span>Sex <span class="ot">&lt;-</span> new_data<span class="sc">$</span>Sex</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Correctly name probability columns for satisfaction levels 1, 2 and 3</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predicted_probs_df)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"satisfaction_1"</span>, <span class="st">"satisfaction_2"</span>, <span class="st">"satisfaction_3"</span>)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformation to long format for easier viewing with ggplot2</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>predicted_probs_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(predicted_probs_df, </span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"satisfaction"</span>),  <span class="co"># Selects columns satisfaction_1, 2 and 3</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">names_to =</span> <span class="st">"satisfaction"</span>, </span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">values_to =</span> <span class="st">"probabilite"</span>)</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify names for simple labels</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>predicted_probs_long<span class="sc">$</span>satisfaction <span class="ot">&lt;-</span> <span class="fu">factor</span>(predicted_probs_long<span class="sc">$</span>satisfaction, </span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"satisfaction_1"</span>, <span class="st">"satisfaction_2"</span>, <span class="st">"satisfaction_3"</span>),</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span>))</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize predicted probabilities for each gender</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predicted_probs_long, <span class="fu">aes</span>(<span class="at">x =</span> distance, <span class="at">y =</span> probabilite, <span class="at">color =</span> satisfaction, <span class="at">linetype =</span> Sex)) <span class="sc">+</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted Probabilities of Satisfaction Based on Distance to the Norm"</span>,</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Distance to the Norm"</span>,</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#87CEEB"</span>, <span class="st">"#4682B4"</span>, <span class="st">"#1E90FF"</span>)) <span class="sc">+</span>  <span class="co"># </span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dashed"</span>)) <span class="sc">+</span>  <span class="co"># Differentiates between men and women</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ce graphique montre des différences significatives entre hommes et femmes, chez les femmes l’éloignement aux normes semble augmenter l’insatisfaction, cet effet n’est pas aussi net chez les hommes.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>rego <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">polr</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  satisfaction <span class="sc">~</span> Sex <span class="sc">+</span> Income <span class="sc">+</span> age_group <span class="sc">+</span> categories,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> my_data_frame</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_gtsummary_language</span>(<span class="st">"en"</span>, <span class="at">decimal.mark =</span> <span class="st">","</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>rego <span class="sc">|&gt;</span> </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_regression</span>(</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidy_fun =</span> broom.helpers<span class="sc">::</span>tidy_parameters</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>() <span class="sc">|&gt;</span> </span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_global_p</span>(<span class="at">keep =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_kable_extra</span>(<span class="at">format =</span> <span class="st">"latex"</span>, <span class="at">booktabs =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"hold_position"</span>, <span class="st">"scale_down"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>rego <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  ggstats<span class="sc">::</span><span class="fu">ggcoef_table</span>(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidy_fun =</span> broom.helpers<span class="sc">::</span>tidy_parameters</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>rego <span class="sc">|&gt;</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  broom.helpers<span class="sc">::</span><span class="fu">plot_marginal_predictions</span>() <span class="sc">|&gt;</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">&amp;</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Contrôle par le temps passé au travail et distance absolue</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Catégorisation par quartiles</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>categories_abs <span class="ot">&lt;-</span> <span class="fu">cut</span>(my_data_frame<span class="sc">$</span>distance_abs,                         <span class="at">breaks =</span> <span class="dv">4</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span> ,                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low Distance"</span>, <span class="st">"Medium_low"</span>, <span class="st">"Medium_high"</span>, <span class="st">"High Distance"</span>),                         <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>rego3 <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">polr</span>(</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  satisfaction <span class="sc">~</span> Sex <span class="sc">+</span> Income <span class="sc">+</span> age_group <span class="sc">+</span> categories_abs,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> my_data_frame</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_gtsummary_language</span>(<span class="st">"en"</span>, <span class="at">decimal.mark =</span> <span class="st">","</span>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>rego3 <span class="sc">|&gt;</span> </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_regression</span>(</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidy_fun =</span> broom.helpers<span class="sc">::</span>tidy_parameters</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>() <span class="sc">|&gt;</span> </span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_global_p</span>(<span class="at">keep =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_kable_extra</span>(<span class="at">format =</span> <span class="st">"latex"</span>, <span class="at">booktabs =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"hold_position"</span>, <span class="st">"scale_down"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>rego3 <span class="sc">|&gt;</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  ggstats<span class="sc">::</span><span class="fu">ggcoef_table</span>(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidy_fun =</span> broom.helpers<span class="sc">::</span>tidy_parameters</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>rego3 <span class="sc">|&gt;</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  broom.helpers<span class="sc">::</span><span class="fu">plot_marginal_predictions</span>() <span class="sc">|&gt;</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">&amp;</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>En utilisant une autre variable proxy de l’utilité: l’état de santé déclaré.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Une autre mesure de l'utilité: l'état de santé déclaré</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>Health<span class="ot">&lt;-</span><span class="fu">as.factor</span>(my_data_frame<span class="sc">$</span>Health)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>rego4 <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">polr</span>(</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  Health <span class="sc">~</span> Sex <span class="sc">+</span> Income <span class="sc">+</span> age_group <span class="sc">+</span> categories_abs,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> my_data_frame</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_gtsummary_language</span>(<span class="st">"en"</span>, <span class="at">decimal.mark =</span> <span class="st">","</span>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>rego4 <span class="sc">|&gt;</span> </span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_regression</span>(</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidy_fun =</span> broom.helpers<span class="sc">::</span>tidy_parameters</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>() <span class="sc">|&gt;</span> </span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_global_p</span>(<span class="at">keep =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_kable_extra</span>(<span class="at">format =</span> <span class="st">"latex"</span>, <span class="at">booktabs =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"hold_position"</span>, <span class="st">"scale_down"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>rego4 <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  ggstats<span class="sc">::</span><span class="fu">ggcoef_table</span>(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">tidy_fun =</span> broom.helpers<span class="sc">::</span>tidy_parameters</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>rego4 <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  broom.helpers<span class="sc">::</span><span class="fu">plot_marginal_predictions</span>() <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">&amp;</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="indice-alternatif" class="level2">
<h2 class="anchored" data-anchor-id="indice-alternatif">Indice Alternatif</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(my_data_frame<span class="sc">$</span>Library)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  1.0000  1.0000  0.8347  1.0000  1.0000 </code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>SEXE<span class="ot">&lt;-</span><span class="fu">as.factor</span>(my_data_frame<span class="sc">$</span>SEXE)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>reg_lm<span class="ot">&lt;-</span> <span class="fu">lm</span>(Sex<span class="sc">~</span> Knitting<span class="sc">+</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                  Cards_games<span class="sc">+</span>  </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                  Gambling<span class="sc">+</span> </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                  Cooking<span class="sc">+</span> </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                  DIY<span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>                  Vegetable_garden<span class="sc">+</span> </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>                  Ornamental_garden<span class="sc">+</span>  </span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>                  Fishing_hunting<span class="sc">+</span> </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>                  Collection<span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>                  Vehicle_custom <span class="sc">+</span> </span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>                  Making_music <span class="sc">+</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>                  Diary <span class="sc">+</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>                  Writing <span class="sc">+</span>  </span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>                  Painting <span class="sc">+</span>  </span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>                  Montage <span class="sc">+</span> </span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>                  Circus <span class="sc">+</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>                  Pottery <span class="sc">+</span> </span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>                  Theater <span class="sc">+</span> </span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>                  Drawing <span class="sc">+</span> </span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>                  Dancing <span class="sc">+</span>  </span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>                  Photography <span class="sc">+</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>                  Genealogy <span class="sc">+</span> </span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>                  Science <span class="sc">+</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>                  None <span class="sc">+</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>                  No_Amateur <span class="sc">+</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>                  Video_games <span class="sc">+</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>                  TV <span class="sc">+</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>                  Radio<span class="sc">+</span></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>                  Library<span class="sc">+</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>                  Museums <span class="sc">+</span>  </span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>                  Internet <span class="sc">+</span> </span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>                  Concert, <span class="at">data=</span>my_data_frame)</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(my_data_frame)</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Indices pour la division (2/3 pour l'entraînement, 1/3 pour le test)</span></span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> <span class="dv">2</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="dv">3</span>)  <span class="co"># 2/3 des indices pour l'entraînement</span></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer l'ensemble d'entraînement et l'ensemble de test</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> my_data_frame[train_index, ]  <span class="co"># Enregistrement d'entraînement</span></span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> my_data_frame[<span class="sc">-</span>train_index, ]  <span class="co"># Enregistrement de test</span></span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier les tailles</span></span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Nombre d'observations dans l'ensemble d'entraînement :"</span>, <span class="fu">nrow</span>(train_data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Nombre d'observations dans l'ensemble d'entraînement : 6156 </code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Nombre d'observations dans l'ensemble de test :"</span>, <span class="fu">nrow</span>(test_data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Nombre d'observations dans l'ensemble de test : 3078 </code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Charger les bibliothèques nécessaires</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Définir la matrice X pour l'entraînement</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(SEXE <span class="sc">~</span> Knitting <span class="sc">+</span> Cards_games <span class="sc">+</span> Gambling <span class="sc">+</span> Cooking <span class="sc">+</span> DIY <span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>                  Vegetable_garden <span class="sc">+</span> Ornamental_garden <span class="sc">+</span> Fishing_hunting <span class="sc">+</span> </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>                  Collection <span class="sc">+</span> Vehicle_custom <span class="sc">+</span> Making_music <span class="sc">+</span> Diary <span class="sc">+</span> Writing <span class="sc">+</span> </span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>                  Painting <span class="sc">+</span> Montage <span class="sc">+</span> Circus <span class="sc">+</span> Pottery <span class="sc">+</span> Theater <span class="sc">+</span> Drawing <span class="sc">+</span> </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>                  Dancing <span class="sc">+</span> Photography <span class="sc">+</span> Genealogy <span class="sc">+</span> Science <span class="sc">+</span> None <span class="sc">+</span> No_Amateur <span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>                  Video_games <span class="sc">+</span> TV <span class="sc">+</span> Radio <span class="sc">+</span> Library <span class="sc">+</span> Museums <span class="sc">+</span> Internet <span class="sc">+</span> Concert,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>                  train_data)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable cible y pour l'entraînement</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> train_data<span class="sc">$</span>SEXE</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuster le modèle LASSO avec validation croisée</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>cv_lasso <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>best_lambda <span class="ot">&lt;-</span> cv_lasso<span class="sc">$</span>lambda.min  <span class="co"># Lambda optimal</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifie les coefficients pour le lambda optimal</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">coef</span>(cv_lasso, <span class="at">s =</span> <span class="st">"lambda.min"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>33 x 1 sparse Matrix of class "dgCMatrix"
                             s1
(Intercept)       -9.416344e-01
Knitting           2.983955e+00
Cards_games        2.646572e-01
Gambling          -4.130093e-01
Cooking            1.204789e+00
DIY               -1.099583e+00
Vegetable_garden  -1.953637e-01
Ornamental_garden  2.687764e-01
Fishing_hunting   -1.338298e+00
Collection        -6.452174e-01
Vehicle_custom    -1.596114e+00
Making_music      -1.691695e-01
Diary              1.485979e+00
Writing           -7.751768e-02
Painting           5.585488e-01
Montage           -9.897662e-01
Circus             6.274464e-02
Pottery            3.925934e-01
Theater           -5.573427e-03
Drawing           -1.080576e-01
Dancing            1.629002e+00
Photography       -4.665021e-01
Genealogy         -4.136582e-01
Science           -8.606566e-01
None              -1.769439e-01
No_Amateur         4.452590e-01
Video_games       -2.262961e-01
TV                 7.508839e-01
Radio             -1.478457e-01
Library           -3.051400e-16
Museums            7.740915e-02
Internet           1.784095e-01
Concert           -1.269588e-02</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(best_lambda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0009456348</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparer X_test (même traitement que pour l'entraînement)</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>x_test <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(SEXE <span class="sc">~</span> Knitting <span class="sc">+</span> Cards_games <span class="sc">+</span> Gambling <span class="sc">+</span> Cooking <span class="sc">+</span> DIY <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                       Vegetable_garden <span class="sc">+</span> Ornamental_garden <span class="sc">+</span> Fishing_hunting <span class="sc">+</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                       Collection <span class="sc">+</span> Vehicle_custom <span class="sc">+</span> Making_music <span class="sc">+</span> Diary <span class="sc">+</span> Writing <span class="sc">+</span> </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                       Painting <span class="sc">+</span> Montage <span class="sc">+</span> Circus <span class="sc">+</span> Pottery <span class="sc">+</span> Theater <span class="sc">+</span> Drawing <span class="sc">+</span> </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>                       Dancing <span class="sc">+</span> Photography <span class="sc">+</span> Genealogy <span class="sc">+</span> Science <span class="sc">+</span> None <span class="sc">+</span> No_Amateur <span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>                       Video_games <span class="sc">+</span> TV <span class="sc">+</span> Radio <span class="sc">+</span> Library <span class="sc">+</span> Museums <span class="sc">+</span> Internet <span class="sc">+</span> Concert,</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>                       test_data)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Prédire les probabilités sur les données de test avec le meilleur lambda</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(cv_lasso, <span class="at">newx =</span> x_test, <span class="at">s =</span> <span class="st">"lambda.min"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable cible y_test pour l'ensemble de test</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>y_test <span class="ot">&lt;-</span> test_data<span class="sc">$</span>SEXE</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de l'AUC avec pROC</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>roc_curve <span class="ot">&lt;-</span> <span class="fu">roc</span>(y_test, preds)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>auc_value <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_curve)</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"AUC:"</span>, auc_value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AUC: 0.863648296764279"</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer la courbe ROC</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>roc_curve <span class="ot">&lt;-</span> <span class="fu">roc</span>(y_test, preds)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher la courbe ROC</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_curve, <span class="at">main =</span> <span class="st">"Courbe ROC"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Optionnel : Ajouter la ligne de base (diagonale)</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher les coefficients pour le meilleur lambda</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>coefficients <span class="ot">&lt;-</span> <span class="fu">coef</span>(cv_lasso, <span class="at">s =</span> <span class="st">"lambda.min"</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir en data.frame pour une meilleure lisibilité</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>coefficients_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(coefficients))</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(coefficients_df) <span class="ot">&lt;-</span> <span class="st">"Coefficient"</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>coefficients_df<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">rownames</span>(coefficients_df)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrer pour ne garder que les variables avec des coefficients non nuls</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>coefficients_non_zero <span class="ot">&lt;-</span> coefficients_df[coefficients_df<span class="sc">$</span>Coefficient <span class="sc">!=</span> <span class="dv">0</span>, ]</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher les variables gardées et leurs coefficients</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(coefficients_non_zero)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    Coefficient          Variable
(Intercept)       -9.416344e-01       (Intercept)
Knitting           2.983955e+00          Knitting
Cards_games        2.646572e-01       Cards_games
Gambling          -4.130093e-01          Gambling
Cooking            1.204789e+00           Cooking
DIY               -1.099583e+00               DIY
Vegetable_garden  -1.953637e-01  Vegetable_garden
Ornamental_garden  2.687764e-01 Ornamental_garden
Fishing_hunting   -1.338298e+00   Fishing_hunting
Collection        -6.452174e-01        Collection
Vehicle_custom    -1.596114e+00    Vehicle_custom
Making_music      -1.691695e-01      Making_music
Diary              1.485979e+00             Diary
Writing           -7.751768e-02           Writing
Painting           5.585488e-01          Painting
Montage           -9.897662e-01           Montage
Circus             6.274464e-02            Circus
Pottery            3.925934e-01           Pottery
Theater           -5.573427e-03           Theater
Drawing           -1.080576e-01           Drawing
Dancing            1.629002e+00           Dancing
Photography       -4.665021e-01       Photography
Genealogy         -4.136582e-01         Genealogy
Science           -8.606566e-01           Science
None              -1.769439e-01              None
No_Amateur         4.452590e-01        No_Amateur
Video_games       -2.262961e-01       Video_games
TV                 7.508839e-01                TV
Radio             -1.478457e-01             Radio
Library           -3.051400e-16           Library
Museums            7.740915e-02           Museums
Internet           1.784095e-01          Internet
Concert           -1.269588e-02           Concert</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="do">###CREATION INDICE</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Récupérer les coefficients du modèle pour le meilleur lambda</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>coefficients <span class="ot">&lt;-</span> <span class="fu">coef</span>(cv_lasso, <span class="at">s =</span> <span class="st">"lambda.min"</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir en data.frame et filtrer les variables non nulles</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>coefficients_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(coefficients))</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(coefficients_df) <span class="ot">&lt;-</span> <span class="st">"Coefficient"</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>coefficients_df<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">rownames</span>(coefficients_df)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>coefficients_non_zero <span class="ot">&lt;-</span> coefficients_df[coefficients_df<span class="sc">$</span>Coefficient <span class="sc">!=</span> <span class="dv">0</span>, ]</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparer la matrice X des pratiques pour l'ensemble de test (ou d'entraînement si nécessaire)</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>x_test <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(SEXE <span class="sc">~</span> Knitting <span class="sc">+</span> Cards_games <span class="sc">+</span> Gambling <span class="sc">+</span> Cooking <span class="sc">+</span> DIY <span class="sc">+</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>                       Vegetable_garden <span class="sc">+</span> Ornamental_garden <span class="sc">+</span> Fishing_hunting <span class="sc">+</span> </span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>                       Collection <span class="sc">+</span> Vehicle_custom <span class="sc">+</span> Making_music <span class="sc">+</span> Diary <span class="sc">+</span> Writing <span class="sc">+</span> </span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>                       Painting <span class="sc">+</span> Montage <span class="sc">+</span> Circus <span class="sc">+</span> Pottery <span class="sc">+</span> Theater <span class="sc">+</span> Drawing <span class="sc">+</span> </span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>                       Dancing <span class="sc">+</span> Photography <span class="sc">+</span> Genealogy <span class="sc">+</span> Science <span class="sc">+</span> None <span class="sc">+</span> No_Amateur <span class="sc">+</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>                       Video_games <span class="sc">+</span> TV <span class="sc">+</span> Radio <span class="sc">+</span> Library <span class="sc">+</span> Museums <span class="sc">+</span> Internet <span class="sc">+</span> Concert,</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>                       test_data)[, <span class="sc">-</span><span class="dv">1</span>]  <span class="co"># Assurez-vous d'enlever l'intercept avec [, -1]</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Sélectionner les variables pertinentes</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>matched_vars <span class="ot">&lt;-</span> <span class="fu">intersect</span>(<span class="fu">rownames</span>(coefficients_non_zero), <span class="fu">colnames</span>(x_test))</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>x_test <span class="ot">&lt;-</span> x_test[, matched_vars, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>coef_vector <span class="ot">&lt;-</span> coefficients_non_zero<span class="sc">$</span>Coefficient[matched_vars]  <span class="co"># Associer les coefficients</span></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Dimension de x_test :"</span>, <span class="fu">dim</span>(x_test)[<span class="dv">1</span>], <span class="st">"x"</span>, <span class="fu">dim</span>(x_test)[<span class="dv">2</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Dimension de x_test : 3078 x 32"</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Longueur de coef_vector :"</span>, <span class="fu">length</span>(coef_vector)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Longueur de coef_vector : 32"</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Nombre de valeurs NA dans x_test :"</span>, <span class="fu">sum</span>(<span class="fu">is.na</span>(x_test))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Nombre de valeurs NA dans x_test : 0"</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Nombre de valeurs NA dans coef_vector :"</span>, <span class="fu">sum</span>(<span class="fu">is.na</span>(coef_vector))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Nombre de valeurs NA dans coef_vector : 32"</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Variables dans coefficients_non_zero :"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Variables dans coefficients_non_zero :"</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(coefficients_non_zero<span class="sc">$</span>Variable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "(Intercept)"       "Knitting"          "Cards_games"      
 [4] "Gambling"          "Cooking"           "DIY"              
 [7] "Vegetable_garden"  "Ornamental_garden" "Fishing_hunting"  
[10] "Collection"        "Vehicle_custom"    "Making_music"     
[13] "Diary"             "Writing"           "Painting"         
[16] "Montage"           "Circus"            "Pottery"          
[19] "Theater"           "Drawing"           "Dancing"          
[22] "Photography"       "Genealogy"         "Science"          
[25] "None"              "No_Amateur"        "Video_games"      
[28] "TV"                "Radio"             "Library"          
[31] "Museums"           "Internet"          "Concert"          </code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Colonnes de x_test :"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Colonnes de x_test :"</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">colnames</span>(x_test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Knitting"          "Cards_games"       "Gambling"         
 [4] "Cooking"           "DIY"               "Vegetable_garden" 
 [7] "Ornamental_garden" "Fishing_hunting"   "Collection"       
[10] "Vehicle_custom"    "Making_music"      "Diary"            
[13] "Writing"           "Painting"          "Montage"          
[16] "Circus"            "Pottery"           "Theater"          
[19] "Drawing"           "Dancing"           "Photography"      
[22] "Genealogy"         "Science"           "None"             
[25] "No_Amateur"        "Video_games"       "TV"               
[28] "Radio"             "Library"           "Museums"          
[31] "Internet"          "Concert"          </code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclure "(Intercept)" des coefficients</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>coefficients_filtered <span class="ot">&lt;-</span> coefficients_non_zero[coefficients_non_zero<span class="sc">$</span>Variable <span class="sc">!=</span> <span class="st">"(Intercept)"</span>, ]</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Aligner les coefficients sur x_test</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>coef_vector <span class="ot">&lt;-</span> coefficients_filtered<span class="sc">$</span>Coefficient[<span class="fu">match</span>(<span class="fu">colnames</span>(x_test), coefficients_filtered<span class="sc">$</span>Variable)]</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des scores</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>test_data<span class="sc">$</span>score <span class="ot">&lt;-</span> x_test <span class="sc">%*%</span> coef_vector</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalisation des scores</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>min_score <span class="ot">&lt;-</span> <span class="fu">min</span>(test_data<span class="sc">$</span>score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>max_score <span class="ot">&lt;-</span> <span class="fu">max</span>(test_data<span class="sc">$</span>score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (max_score <span class="sc">&gt;</span> min_score) {</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>  test_data<span class="sc">$</span>score_normalise <span class="ot">&lt;-</span> (test_data<span class="sc">$</span>score <span class="sc">-</span> min_score) <span class="sc">/</span> (max_score <span class="sc">-</span> min_score)</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>  test_data<span class="sc">$</span>score_normalise <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation avec ggplot2</span></span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(test_data, <span class="fu">aes</span>(<span class="at">x =</span> score_normalise, <span class="at">color =</span> SEXE, <span class="at">fill =</span> SEXE)) <span class="sc">+</span></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span> </span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Densité du Score Normalisé"</span>, <span class="at">x =</span> <span class="st">"Score Normalisé"</span>, <span class="at">y =</span> <span class="st">"Densité"</span>) <span class="sc">+</span></span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"pink"</span>)) <span class="sc">+</span></span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"pink"</span>)) <span class="sc">+</span></span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparer la matrice X pour l'ensemble complet (train + test)</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>x_full <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(SEXE <span class="sc">~</span> Knitting <span class="sc">+</span> Cards_games <span class="sc">+</span> Gambling <span class="sc">+</span> Cooking <span class="sc">+</span> DIY <span class="sc">+</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>                       Vegetable_garden <span class="sc">+</span> Ornamental_garden <span class="sc">+</span> Fishing_hunting <span class="sc">+</span> </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>                       Collection <span class="sc">+</span> Vehicle_custom <span class="sc">+</span> Making_music <span class="sc">+</span> Diary <span class="sc">+</span> Writing <span class="sc">+</span> </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>                       Painting <span class="sc">+</span> Montage <span class="sc">+</span> Circus <span class="sc">+</span> Pottery <span class="sc">+</span> Theater <span class="sc">+</span> Drawing <span class="sc">+</span> </span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>                       Dancing <span class="sc">+</span> Photography <span class="sc">+</span> Genealogy <span class="sc">+</span> Science <span class="sc">+</span> None <span class="sc">+</span> No_Amateur <span class="sc">+</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>                       Video_games <span class="sc">+</span> TV <span class="sc">+</span> Radio <span class="sc">+</span> Library <span class="sc">+</span> Museums <span class="sc">+</span> Internet <span class="sc">+</span> Concert,</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>                       my_data_frame)[, <span class="sc">-</span><span class="dv">1</span>]  <span class="co"># Exclure l'intercept</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Sélectionner les variables pertinentes (identiques à celles du modèle LASSO)</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>matched_vars <span class="ot">&lt;-</span> <span class="fu">intersect</span>(<span class="fu">rownames</span>(coefficients_non_zero), <span class="fu">colnames</span>(x_full))</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>x_full <span class="ot">&lt;-</span> x_full[, matched_vars, drop <span class="ot">=</span> <span class="cn">FALSE</span>]  <span class="co"># Garder uniquement les variables sélectionnées</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Aligner les coefficients sur x_full</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>coef_vector_full <span class="ot">&lt;-</span> coefficients_filtered<span class="sc">$</span>Coefficient[<span class="fu">match</span>(<span class="fu">colnames</span>(x_full), coefficients_filtered<span class="sc">$</span>Variable)]</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des scores pour l'ensemble complet</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>score <span class="ot">&lt;-</span> x_full <span class="sc">%*%</span> coef_vector_full</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalisation des scores</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>min_score_full <span class="ot">&lt;-</span> <span class="fu">min</span>(my_data_frame<span class="sc">$</span>score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>max_score_full <span class="ot">&lt;-</span> <span class="fu">max</span>(my_data_frame<span class="sc">$</span>score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (max_score_full <span class="sc">&gt;</span> min_score_full) {</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>  my_data_frame<span class="sc">$</span>score_normalise <span class="ot">&lt;-</span> (my_data_frame<span class="sc">$</span>score <span class="sc">-</span> min_score_full) <span class="sc">/</span> (max_score_full <span class="sc">-</span> min_score_full)</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>  my_data_frame<span class="sc">$</span>score_normalise <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation du score normalisé pour l'ensemble complet avec ggplot2</span></span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my_data_frame, <span class="fu">aes</span>(<span class="at">x =</span> score_normalise, <span class="at">color =</span> SEXE, <span class="at">fill =</span> SEXE)) <span class="sc">+</span></span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span> </span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Densité du Score Normalisé (Ensemble Complet)"</span>, <span class="at">x =</span> <span class="st">"Score Normalisé"</span>, <span class="at">y =</span> <span class="st">"Densité"</span>) <span class="sc">+</span></span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"pink"</span>)) <span class="sc">+</span></span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"pink"</span>)) <span class="sc">+</span></span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer la corrélation entre indice_normalise et score_normalise</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>correlation_value <span class="ot">&lt;-</span> <span class="fu">cor</span>(my_data_frame<span class="sc">$</span>identity, my_data_frame<span class="sc">$</span>score_normalise, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Corrélation entre indice_normalise et score_normalise :"</span>, correlation_value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Corrélation entre indice_normalise et score_normalise : -0.633301769932013"</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiser la relation entre indice_normalise et score_normalise</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my_data_frame, <span class="fu">aes</span>(<span class="at">x =</span> identity, <span class="at">y =</span> score_normalise)) <span class="sc">+</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relation entre indice_normalise et score_normalise"</span>, </span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Indice Normalisé"</span>, </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Score Normalisé"</span>) <span class="sc">+</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)  <span class="co"># Ajouter une droite de régression linéaire</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame to store the results</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>result_table_score <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Activity =</span> <span class="fu">character</span>(<span class="dv">0</span>), <span class="at">Accuracy =</span> <span class="fu">numeric</span>(<span class="dv">0</span>))</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (activity <span class="cf">in</span> cultural_activities) {</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform a Probit regression for the current cultural activity</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  model_formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(activity, <span class="st">"~ score_normalise"</span>))</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">glm</span>(model_formula, <span class="at">data =</span> my_data_frame, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>))</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate predictions</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  predicted <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">predict</span>(model, <span class="at">type =</span> <span class="st">"response"</span>) <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the accuracy</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  correct_predictions <span class="ot">&lt;-</span> <span class="fu">sum</span>(predicted <span class="sc">==</span> my_data_frame[[activity]])</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  total_predictions <span class="ot">&lt;-</span> <span class="fu">nrow</span>(my_data_frame)</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  accuracy <span class="ot">&lt;-</span> (correct_predictions <span class="sc">/</span> total_predictions) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the result to the data frame</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>  result_table_score <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_table, <span class="fu">data.frame</span>(<span class="at">Activity =</span> activity, <span class="at">Accuracy =</span> accuracy))</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>result_table_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           Activity Accuracy
1          Knitting 84.37297
2       Cards_games 51.00715
3          Gambling 79.18562
4           Cooking 56.55187
5               DIY 51.25623
6  Vegetable_garden 72.89365
7   Fishing_hunting 93.95712
8        Collection 92.54927
9    Vehicle_custom 96.85943
10     Making_music 68.16114
11            Diary 85.85662
12          Writing 88.16331
13         Painting 78.76327
14          Montage 84.52458
15          Pottery 89.50617
16          Theater 86.53888
17          Drawing 76.73814
18          Dancing 79.66212
19      Photography 74.53974
20        Genealogy 88.21746
21          Science 88.30409
22             None 70.19710
23      Video_games 62.06411
24          Library 83.20338
25          Concert 81.92549
26          Concert 82.06628</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>score_scale <span class="ot">&lt;-</span> <span class="fu">cut</span>(</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  my_data_frame<span class="sc">$</span>score_normalise,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="dv">7</span>,  <span class="co"># Automatically divide into 7 slices</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Very Masculine"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"Very Feminine"</span>), </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.lowest =</span> <span class="cn">TRUE</span>  </span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">&lt;-</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  my_data_frame <span class="sc">|&gt;</span> </span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(<span class="at">include =</span> <span class="fu">c</span>(score_scale),</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">by=</span>Sex ,)<span class="sc">|&gt;</span> </span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_p</span>()</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>table1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="lunfgszjby" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lunfgszjby table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lunfgszjby thead, #lunfgszjby tbody, #lunfgszjby tfoot, #lunfgszjby tr, #lunfgszjby td, #lunfgszjby th {
  border-style: none;
}

#lunfgszjby p {
  margin: 0;
  padding: 0;
}

#lunfgszjby .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lunfgszjby .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lunfgszjby .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lunfgszjby .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lunfgszjby .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lunfgszjby .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lunfgszjby .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lunfgszjby .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lunfgszjby .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lunfgszjby .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lunfgszjby .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lunfgszjby .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lunfgszjby .gt_spanner_row {
  border-bottom-style: hidden;
}

#lunfgszjby .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lunfgszjby .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lunfgszjby .gt_from_md > :first-child {
  margin-top: 0;
}

#lunfgszjby .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lunfgszjby .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lunfgszjby .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lunfgszjby .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lunfgszjby .gt_row_group_first td {
  border-top-width: 2px;
}

#lunfgszjby .gt_row_group_first th {
  border-top-width: 2px;
}

#lunfgszjby .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lunfgszjby .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lunfgszjby .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lunfgszjby .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lunfgszjby .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lunfgszjby .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lunfgszjby .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lunfgszjby .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lunfgszjby .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lunfgszjby .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lunfgszjby .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lunfgszjby .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lunfgszjby .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lunfgszjby .gt_left {
  text-align: left;
}

#lunfgszjby .gt_center {
  text-align: center;
}

#lunfgszjby .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lunfgszjby .gt_font_normal {
  font-weight: normal;
}

#lunfgszjby .gt_font_bold {
  font-weight: bold;
}

#lunfgszjby .gt_font_italic {
  font-style: italic;
}

#lunfgszjby .gt_super {
  font-size: 65%;
}

#lunfgszjby .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lunfgszjby .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lunfgszjby .gt_indent_1 {
  text-indent: 5px;
}

#lunfgszjby .gt_indent_2 {
  text-indent: 10px;
}

#lunfgszjby .gt_indent_3 {
  text-indent: 15px;
}

#lunfgszjby .gt_indent_4 {
  text-indent: 20px;
}

#lunfgszjby .gt_indent_5 {
  text-indent: 25px;
}

#lunfgszjby .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#lunfgszjby div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Men</strong><br> N = 4 162<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Women</strong><br> N = 5 072<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">score_scale</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="p.value">&lt;0,001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Very Masculine</td>
<td class="gt_row gt_center" headers="stat_1">18 (0,4%)</td>
<td class="gt_row gt_center" headers="stat_2">0 (0%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;1</td>
<td class="gt_row gt_center" headers="stat_1">356 (8,6%)</td>
<td class="gt_row gt_center" headers="stat_2">21 (0,4%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;2</td>
<td class="gt_row gt_center" headers="stat_1">1 933 (46%)</td>
<td class="gt_row gt_center" headers="stat_2">420 (8,3%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;3</td>
<td class="gt_row gt_center" headers="stat_1">1 655 (40%)</td>
<td class="gt_row gt_center" headers="stat_2">2 061 (41%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;4</td>
<td class="gt_row gt_center" headers="stat_1">184 (4,4%)</td>
<td class="gt_row gt_center" headers="stat_2">1 655 (33%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;5</td>
<td class="gt_row gt_center" headers="stat_1">15 (0,4%)</td>
<td class="gt_row gt_center" headers="stat_2">786 (15%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Very Feminine</td>
<td class="gt_row gt_center" headers="stat_1">1 (&lt;0,1%)</td>
<td class="gt_row gt_center" headers="stat_2">129 (2,5%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> n (%)</td>
</tr>
<tr class="even">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Pearson’s Chi-squared test</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>rappel des données de Trachman:</p>
<p>La majorité des femmes se disent plutôt féminines et la majorité des hommes plutôt masculins. Ceci suggère un sentiment de “normalité” du point de vue du genre</p>
<p>Cependant, l’intensité de ces positionnements diffère selon le sexe. Un tiers des hommes se disent très masculins, tandis que moins d’un quart des femmes se disent très féminines</p>
<p>De plus, un peu plus de 9 % des femmes se considèrent « pas très féminines », contre seulement 2 % des hommes qui se disent « pas très masculins »</p>
</section>
<section id="score-distance-à-la-norme" class="level2">
<h2 class="anchored" data-anchor-id="score-distance-à-la-norme">Score-Distance à la norme</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer la moyenne des scores normalisés pour chaque genre</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>mean_scores_by_gender <span class="ot">&lt;-</span> my_data_frame <span class="sc">%&gt;%</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SEXE) <span class="sc">%&gt;%</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_score_by_gender =</span> <span class="fu">mean</span>(score_normalise, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher les moyennes par genre</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mean_scores_by_gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  SEXE  mean_score_by_gender
  &lt;fct&gt;                &lt;dbl&gt;
1 1                    0.414
2 2                    0.590</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fusionner les données avec la moyenne par genre</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>my_data_frame <span class="ot">&lt;-</span> my_data_frame <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mean_scores_by_gender, <span class="at">by =</span> <span class="st">"SEXE"</span>)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer la distance entre le score normalisé de chaque individu et la moyenne de son genre</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>distance_to_mean_gender <span class="ot">&lt;-</span> <span class="fu">abs</span>(my_data_frame<span class="sc">$</span>score_normalise <span class="sc">-</span> my_data_frame<span class="sc">$</span>mean_score_by_gender)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my_data_frame, <span class="fu">aes</span>(<span class="at">x =</span> distance_to_mean_gender, <span class="at">color =</span> Sex, <span class="at">fill =</span> Sex)) <span class="sc">+</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density of Distance to the Norm, by Sex"</span>, </span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Distance to the Norm (Z-score)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"pink"</span>)) <span class="sc">+</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"pink"</span>)) <span class="sc">+</span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Assurez-vous que 'distance_to_mean_gender' est bien numérique</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>distance_to_mean_gender <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(my_data_frame<span class="sc">$</span>distance_to_mean_gender)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérification du type de la variable</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Type de distance_to_mean_gender :"</span>, <span class="fu">class</span>(my_data_frame<span class="sc">$</span>distance_to_mean_gender)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Type de distance_to_mean_gender : numeric"</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordinal logistic regression model fitting</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>satisfaction <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(my_data_frame<span class="sc">$</span>satisfaction)  <span class="co"># Assurez-vous que satisfaction est bien un facteur ordinal</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuster le modèle</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>ordinal_model <span class="ot">&lt;-</span> <span class="fu">polr</span>(satisfaction <span class="sc">~</span> distance_to_mean_gender, <span class="at">data =</span> my_data_frame, <span class="at">Hess =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Créer les valeurs de distance pour la prédiction</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>distance_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(my_data_frame<span class="sc">$</span>distance_to_mean_gender, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">max</span>(my_data_frame<span class="sc">$</span>distance_to_mean_gender, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Créer un nouveau data frame pour les prédictions</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">distance_to_mean_gender =</span> distance_vals)</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Prédire les probabilités pour chaque catégorie</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>predicted_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(ordinal_model, <span class="at">newdata =</span> new_data, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Convertir les résultats en data frame</span></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>predicted_probs_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(predicted_probs)</span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>predicted_probs_df<span class="sc">$</span>distance_to_mean_gender <span class="ot">&lt;-</span> distance_vals</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Transformer les données en format long pour ggplot2</span></span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>predicted_probs_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(predicted_probs_df, </span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">cols =</span> <span class="sc">-</span>distance_to_mean_gender, </span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">names_to =</span> <span class="st">"satisfaction"</span>, </span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">values_to =</span> <span class="st">"probabilite"</span>)</span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Visualiser les probabilités prédites</span></span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predicted_probs_long, <span class="fu">aes</span>(<span class="at">x =</span> distance_to_mean_gender, <span class="at">y =</span> probabilite, <span class="at">color =</span> satisfaction)) <span class="sc">+</span></span>
<span id="cb83-29"><a href="#cb83-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb83-30"><a href="#cb83-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Probability of satisfaction as a function of deviation from Norms"</span>,</span>
<span id="cb83-31"><a href="#cb83-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Distance to the Norm"</span>,</span>
<span id="cb83-32"><a href="#cb83-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb83-33"><a href="#cb83-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb83-34"><a href="#cb83-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb83-35"><a href="#cb83-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb83-36"><a href="#cb83-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb83-37"><a href="#cb83-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb83-38"><a href="#cb83-38" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="lasso-2" class="level2">
<h2 class="anchored" data-anchor-id="lasso-2">LASSO 2</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>n_2 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(my_data_frame)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Indices pour la division (2/3 pour l'entraînement, 1/3 pour le test)</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n_2, <span class="at">size =</span> <span class="dv">2</span> <span class="sc">*</span> n_2 <span class="sc">/</span> <span class="dv">3</span>)  <span class="co"># 2/3 des indices pour l'entraînement</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer l'ensemble d'entraînement et l'ensemble de test</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> my_data_frame[train_index, ]  <span class="co"># Enregistrement d'entraînement</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> my_data_frame[<span class="sc">-</span>train_index, ]  <span class="co"># Enregistrement de test</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier les tailles</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Nombre d'observations dans l'ensemble d'entraînement :"</span>, <span class="fu">nrow</span>(train_data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Nombre d'observations dans l'ensemble d'entraînement : 6156 </code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Nombre d'observations dans l'ensemble de test :"</span>, <span class="fu">nrow</span>(test_data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Nombre d'observations dans l'ensemble de test : 3078 </code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Charger les bibliothèques nécessaires</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Définir la matrice X pour l'entraînement</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>x_2 <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(SEXE <span class="sc">~</span> Knitting <span class="sc">+</span> Cards_games <span class="sc">+</span> Gambling <span class="sc">+</span> Cooking <span class="sc">+</span> DIY <span class="sc">+</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>                  Vegetable_garden <span class="sc">+</span> Fishing_hunting <span class="sc">+</span> </span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>                  Collection <span class="sc">+</span> Vehicle_custom <span class="sc">+</span> Making_music <span class="sc">+</span> Diary <span class="sc">+</span> Writing <span class="sc">+</span> </span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>                  Painting <span class="sc">+</span> Montage <span class="sc">+</span>  Pottery <span class="sc">+</span> Theater <span class="sc">+</span> Drawing <span class="sc">+</span> </span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>                  Dancing <span class="sc">+</span> Photography <span class="sc">+</span> Genealogy <span class="sc">+</span> Science <span class="sc">+</span> None <span class="sc">+</span> </span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>                  Video_games <span class="sc">+</span> Library <span class="sc">+</span>  Concert,</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>                  train_data)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable cible y pour l'entraînement</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>y_2 <span class="ot">&lt;-</span> train_data<span class="sc">$</span>SEXE</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuster le modèle LASSO avec validation croisée</span></span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>cv_lasso_2 <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x_2, y_2, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>best_lambda_2 <span class="ot">&lt;-</span> cv_lasso_2<span class="sc">$</span>lambda.min  <span class="co"># Lambda optimal</span></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifie les coefficients pour le lambda optimal</span></span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">coef</span>(cv_lasso_2, <span class="at">s =</span> <span class="st">"lambda.min"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>26 x 1 sparse Matrix of class "dgCMatrix"
                          s1
(Intercept)       0.14455775
Knitting          3.13041920
Cards_games       0.17920765
Gambling         -0.30988346
Cooking           1.22553321
DIY              -1.08636079
Vegetable_garden -0.30018308
Fishing_hunting  -1.36231290
Collection       -0.59825128
Vehicle_custom   -1.66303690
Making_music     -0.16566188
Diary             1.33559686
Writing          -0.19796019
Painting          0.55479344
Montage          -1.05018780
Pottery           0.58761926
Theater          -0.14421941
Drawing          -0.13199487
Dancing           1.64512672
Photography      -0.40427347
Genealogy        -0.28778911
Science          -0.90032598
None             -0.08349219
Video_games      -0.21183540
Library          -0.19952896
Concert           0.05743290</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(best_lambda_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0005483483</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparer X_test (même traitement que pour l'entraînement)</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>x_test_2 <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(SEXE <span class="sc">~</span> Knitting <span class="sc">+</span> Cards_games <span class="sc">+</span> Gambling <span class="sc">+</span> Cooking <span class="sc">+</span> DIY <span class="sc">+</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>                  Vegetable_garden <span class="sc">+</span> Fishing_hunting <span class="sc">+</span> </span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>                  Collection <span class="sc">+</span> Vehicle_custom <span class="sc">+</span> Making_music <span class="sc">+</span> Diary <span class="sc">+</span> Writing <span class="sc">+</span> </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>                  Painting <span class="sc">+</span> Montage <span class="sc">+</span>  Pottery <span class="sc">+</span> Theater <span class="sc">+</span> Drawing <span class="sc">+</span> </span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>                  Dancing <span class="sc">+</span> Photography <span class="sc">+</span> Genealogy <span class="sc">+</span> Science <span class="sc">+</span> None <span class="sc">+</span> </span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>                  Video_games <span class="sc">+</span> Library <span class="sc">+</span>  Concert,</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>                       test_data)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Prédire les probabilités sur les données de test avec le meilleur lambda</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>preds_2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(cv_lasso_2, <span class="at">newx =</span> x_test_2, <span class="at">s =</span> <span class="st">"lambda.min"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable cible y_test pour l'ensemble de test</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>y_test_2 <span class="ot">&lt;-</span> test_data<span class="sc">$</span>SEXE</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de l'AUC avec pROC</span></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>roc_curve_2 <span class="ot">&lt;-</span> <span class="fu">roc</span>(y_test_2, preds_2)</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>auc_value_2 <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_curve_2)</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"AUC:"</span>, auc_value_2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AUC: 0.859553317223724"</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer la courbe ROC</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>roc_curve_2 <span class="ot">&lt;-</span> <span class="fu">roc</span>(y_test_2, preds_2)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher la courbe ROC</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_curve_2, <span class="at">main =</span> <span class="st">"Courbe ROC 2"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Optionnel : Ajouter la ligne de base (diagonale)</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher les coefficients pour le meilleur lambda</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>coefficients_2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(cv_lasso_2, <span class="at">s =</span> <span class="st">"lambda.min"</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir en data.frame pour une meilleure lisibilité</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>coefficients_df_2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(coefficients_2))</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(coefficients_df_2) <span class="ot">&lt;-</span> <span class="st">"Coefficient"</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>coefficients_df_2<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">rownames</span>(coefficients_df_2)</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrer pour ne garder que les variables avec des coefficients non nuls</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>coefficients_non_zero_2 <span class="ot">&lt;-</span> coefficients_df_2[coefficients_df_2<span class="sc">$</span>Coefficient <span class="sc">!=</span> <span class="dv">0</span>, ]</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher les variables gardées et leurs coefficients</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(coefficients_non_zero_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 Coefficient         Variable
(Intercept)       0.14455775      (Intercept)
Knitting          3.13041920         Knitting
Cards_games       0.17920765      Cards_games
Gambling         -0.30988346         Gambling
Cooking           1.22553321          Cooking
DIY              -1.08636079              DIY
Vegetable_garden -0.30018308 Vegetable_garden
Fishing_hunting  -1.36231290  Fishing_hunting
Collection       -0.59825128       Collection
Vehicle_custom   -1.66303690   Vehicle_custom
Making_music     -0.16566188     Making_music
Diary             1.33559686            Diary
Writing          -0.19796019          Writing
Painting          0.55479344         Painting
Montage          -1.05018780          Montage
Pottery           0.58761926          Pottery
Theater          -0.14421941          Theater
Drawing          -0.13199487          Drawing
Dancing           1.64512672          Dancing
Photography      -0.40427347      Photography
Genealogy        -0.28778911        Genealogy
Science          -0.90032598          Science
None             -0.08349219             None
Video_games      -0.21183540      Video_games
Library          -0.19952896          Library
Concert           0.05743290          Concert</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="do">###CREATION INDICE</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Récupérer les coefficients du modèle pour le meilleur lambda</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>coefficients_2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(cv_lasso_2, <span class="at">s =</span> <span class="st">"lambda.min"</span>)</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir en data.frame et filtrer les variables non nulles</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>coefficients_df_2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(coefficients_2))</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(coefficients_df_2) <span class="ot">&lt;-</span> <span class="st">"Coefficient"</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>coefficients_df_2<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">rownames</span>(coefficients_df_2)</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>coefficients_non_zero_2 <span class="ot">&lt;-</span> coefficients_df_2[coefficients_df_2<span class="sc">$</span>Coefficient <span class="sc">!=</span> <span class="dv">0</span>, ]</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparer la matrice X des pratiques pour l'ensemble de test (ou d'entraînement si nécessaire)</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>x_test_2 <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(SEXE <span class="sc">~</span> Knitting <span class="sc">+</span> Cards_games <span class="sc">+</span> Gambling <span class="sc">+</span> Cooking <span class="sc">+</span> DIY <span class="sc">+</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>                  Vegetable_garden <span class="sc">+</span> Fishing_hunting <span class="sc">+</span> </span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>                  Collection <span class="sc">+</span> Vehicle_custom <span class="sc">+</span> Making_music <span class="sc">+</span> Diary <span class="sc">+</span> Writing <span class="sc">+</span> </span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>                  Painting <span class="sc">+</span> Montage <span class="sc">+</span>  Pottery <span class="sc">+</span> Theater <span class="sc">+</span> Drawing <span class="sc">+</span> </span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>                  Dancing <span class="sc">+</span> Photography <span class="sc">+</span> Genealogy <span class="sc">+</span> Science <span class="sc">+</span> None <span class="sc">+</span> </span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>                  Video_games <span class="sc">+</span> Library <span class="sc">+</span>  Concert,</span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>                       test_data)[, <span class="sc">-</span><span class="dv">1</span>]  <span class="co"># Assurez-vous d'enlever l'intercept avec [, -1]</span></span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Sélectionner les variables pertinentes</span></span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>matched_vars_2 <span class="ot">&lt;-</span> <span class="fu">intersect</span>(<span class="fu">rownames</span>(coefficients_non_zero_2), <span class="fu">colnames</span>(x_test_2))</span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a>x_test_2 <span class="ot">&lt;-</span> x_test_2[, matched_vars_2, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a>coef_vector_2 <span class="ot">&lt;-</span> coefficients_non_zero_2<span class="sc">$</span>Coefficient[matched_vars_2]  <span class="co"># Associer les coefficients</span></span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a><span class="co">#print(paste("Dimension de x_test :", dim(x_test)[1], "x", dim(x_test)[2]))</span></span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a><span class="co">#print(paste("Longueur de coef_vector :", length(coef_vector)))</span></span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a><span class="co">#print(paste("Nombre de valeurs NA dans x_test :", sum(is.na(x_test))))</span></span>
<span id="cb97-29"><a href="#cb97-29" aria-hidden="true" tabindex="-1"></a><span class="co">#print(paste("Nombre de valeurs NA dans coef_vector :", sum(is.na(coef_vector))))</span></span>
<span id="cb97-30"><a href="#cb97-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-31"><a href="#cb97-31" aria-hidden="true" tabindex="-1"></a><span class="co">#print("Variables dans coefficients_non_zero :")</span></span>
<span id="cb97-32"><a href="#cb97-32" aria-hidden="true" tabindex="-1"></a><span class="co">#print(coefficients_non_zero$Variable)</span></span>
<span id="cb97-33"><a href="#cb97-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-34"><a href="#cb97-34" aria-hidden="true" tabindex="-1"></a><span class="co">#print("Colonnes de x_test :")</span></span>
<span id="cb97-35"><a href="#cb97-35" aria-hidden="true" tabindex="-1"></a><span class="co">#print(colnames(x_test))</span></span>
<span id="cb97-36"><a href="#cb97-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-37"><a href="#cb97-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-38"><a href="#cb97-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclure "(Intercept)" des coefficients</span></span>
<span id="cb97-39"><a href="#cb97-39" aria-hidden="true" tabindex="-1"></a>coefficients_filtered_2 <span class="ot">&lt;-</span> coefficients_non_zero_2[coefficients_non_zero_2<span class="sc">$</span>Variable <span class="sc">!=</span> <span class="st">"(Intercept)"</span>, ]</span>
<span id="cb97-40"><a href="#cb97-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-41"><a href="#cb97-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Aligner les coefficients sur x_test</span></span>
<span id="cb97-42"><a href="#cb97-42" aria-hidden="true" tabindex="-1"></a>coef_vector_2 <span class="ot">&lt;-</span> coefficients_filtered_2<span class="sc">$</span>Coefficient[<span class="fu">match</span>(<span class="fu">colnames</span>(x_test_2), coefficients_filtered_2<span class="sc">$</span>Variable)]</span>
<span id="cb97-43"><a href="#cb97-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-44"><a href="#cb97-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-45"><a href="#cb97-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-46"><a href="#cb97-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des scores</span></span>
<span id="cb97-47"><a href="#cb97-47" aria-hidden="true" tabindex="-1"></a>test_data<span class="sc">$</span>score_2 <span class="ot">&lt;-</span> x_test_2 <span class="sc">%*%</span> coef_vector_2</span>
<span id="cb97-48"><a href="#cb97-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-49"><a href="#cb97-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalisation des scores</span></span>
<span id="cb97-50"><a href="#cb97-50" aria-hidden="true" tabindex="-1"></a>min_score_2 <span class="ot">&lt;-</span> <span class="fu">min</span>(test_data<span class="sc">$</span>score_2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb97-51"><a href="#cb97-51" aria-hidden="true" tabindex="-1"></a>max_score_2 <span class="ot">&lt;-</span> <span class="fu">max</span>(test_data<span class="sc">$</span>score_2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb97-52"><a href="#cb97-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-53"><a href="#cb97-53" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (max_score_2 <span class="sc">&gt;</span> min_score_2) {</span>
<span id="cb97-54"><a href="#cb97-54" aria-hidden="true" tabindex="-1"></a>  test_data<span class="sc">$</span>score_normalise_2 <span class="ot">&lt;-</span> (test_data<span class="sc">$</span>score_2 <span class="sc">-</span> min_score_2) <span class="sc">/</span> (max_score_2 <span class="sc">-</span> min_score_2)</span>
<span id="cb97-55"><a href="#cb97-55" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb97-56"><a href="#cb97-56" aria-hidden="true" tabindex="-1"></a>  test_data<span class="sc">$</span>score_normalise_2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb97-57"><a href="#cb97-57" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-58"><a href="#cb97-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-59"><a href="#cb97-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation avec ggplot2</span></span>
<span id="cb97-60"><a href="#cb97-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb97-61"><a href="#cb97-61" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(test_data, <span class="fu">aes</span>(<span class="at">x =</span> score_normalise_2, <span class="at">color =</span> SEXE, <span class="at">fill =</span> SEXE)) <span class="sc">+</span></span>
<span id="cb97-62"><a href="#cb97-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span> </span>
<span id="cb97-63"><a href="#cb97-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Densité du Score Normalisé 2"</span>, <span class="at">x =</span> <span class="st">"Score Normalisé 2"</span>, <span class="at">y =</span> <span class="st">"Densité"</span>) <span class="sc">+</span></span>
<span id="cb97-64"><a href="#cb97-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"pink"</span>)) <span class="sc">+</span></span>
<span id="cb97-65"><a href="#cb97-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"pink"</span>)) <span class="sc">+</span></span>
<span id="cb97-66"><a href="#cb97-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparer la matrice X pour l'ensemble complet (train + test)</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>x_full_2 <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(SEXE <span class="sc">~</span> Knitting <span class="sc">+</span> Cards_games <span class="sc">+</span> Gambling <span class="sc">+</span> Cooking <span class="sc">+</span> DIY <span class="sc">+</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>                  Vegetable_garden <span class="sc">+</span> Fishing_hunting <span class="sc">+</span> </span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>                  Collection <span class="sc">+</span> Vehicle_custom <span class="sc">+</span> Making_music <span class="sc">+</span> Diary <span class="sc">+</span> Writing <span class="sc">+</span> </span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>                  Painting <span class="sc">+</span> Montage <span class="sc">+</span>  Pottery <span class="sc">+</span> Theater <span class="sc">+</span> Drawing <span class="sc">+</span> </span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>                  Dancing <span class="sc">+</span> Photography <span class="sc">+</span> Genealogy <span class="sc">+</span> Science <span class="sc">+</span> None <span class="sc">+</span> </span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>                  Video_games <span class="sc">+</span> Library <span class="sc">+</span>  Concert,</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>                       my_data_frame)[, <span class="sc">-</span><span class="dv">1</span>]  <span class="co"># Exclure l'intercept</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Sélectionner les variables pertinentes (identiques à celles du modèle LASSO)</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>matched_vars_2 <span class="ot">&lt;-</span> <span class="fu">intersect</span>(<span class="fu">rownames</span>(coefficients_non_zero_2), <span class="fu">colnames</span>(x_full_2))</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>x_full_2 <span class="ot">&lt;-</span> x_full_2[, matched_vars_2, drop <span class="ot">=</span> <span class="cn">FALSE</span>]  <span class="co"># Garder uniquement les variables sélectionnées</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Aligner les coefficients sur x_full</span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>coef_vector_full_2 <span class="ot">&lt;-</span> coefficients_filtered_2<span class="sc">$</span>Coefficient[<span class="fu">match</span>(<span class="fu">colnames</span>(x_full_2), coefficients_filtered_2<span class="sc">$</span>Variable)]</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des scores pour l'ensemble complet</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>score_2 <span class="ot">&lt;-</span> x_full_2 <span class="sc">%*%</span> coef_vector_full_2</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalisation des scores</span></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>min_score_full_2 <span class="ot">&lt;-</span> <span class="fu">min</span>(my_data_frame<span class="sc">$</span>score_2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>max_score_full_2 <span class="ot">&lt;-</span> <span class="fu">max</span>(my_data_frame<span class="sc">$</span>score_2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (max_score_full_2 <span class="sc">&gt;</span> min_score_full_2) {</span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>  my_data_frame<span class="sc">$</span>score_normalise_2 <span class="ot">&lt;-</span> (my_data_frame<span class="sc">$</span>score_2 <span class="sc">-</span> min_score_full_2) <span class="sc">/</span> (max_score_full_2 <span class="sc">-</span> min_score_full_2)</span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a>  my_data_frame<span class="sc">$</span>score_normalise_2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation du score normalisé pour l'ensemble complet avec ggplot2</span></span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb98-29"><a href="#cb98-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my_data_frame, <span class="fu">aes</span>(<span class="at">x =</span> score_normalise_2, <span class="at">color =</span> SEXE, <span class="at">fill =</span> SEXE)) <span class="sc">+</span></span>
<span id="cb98-30"><a href="#cb98-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span> </span>
<span id="cb98-31"><a href="#cb98-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Densité du Score Normalisé 2(Ensemble Complet)"</span>, <span class="at">x =</span> <span class="st">"Score Normalisé"</span>, <span class="at">y =</span> <span class="st">"Densité"</span>) <span class="sc">+</span></span>
<span id="cb98-32"><a href="#cb98-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"pink"</span>)) <span class="sc">+</span></span>
<span id="cb98-33"><a href="#cb98-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"pink"</span>)) <span class="sc">+</span></span>
<span id="cb98-34"><a href="#cb98-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-31-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer la corrélation entre indice_normalise et score_normalise</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>correlation_value_2 <span class="ot">&lt;-</span> <span class="fu">cor</span>(my_data_frame<span class="sc">$</span>identity, my_data_frame<span class="sc">$</span>score_normalise_2, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Corrélation entre indice_normalise et score_normalise 2:"</span>, correlation_value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Corrélation entre indice_normalise et score_normalise 2: -0.633301769932013"</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiser la relation entre indice_normalise et score_normalise</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my_data_frame, <span class="fu">aes</span>(<span class="at">x =</span> identity, <span class="at">y =</span> score_normalise_2)) <span class="sc">+</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relation entre indice_normalise et score_normalise 2"</span>, </span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Indice Normalisé"</span>, </span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Score Normalisé"</span>) <span class="sc">+</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)  <span class="co"># Ajouter une droite de régression linéaire</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-31-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer un data frame pour stocker les résultats</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>result_table_score_2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Activity_2 =</span> <span class="fu">character</span>(<span class="dv">0</span>), <span class="at">Accuracy_2 =</span> <span class="fu">numeric</span>(<span class="dv">0</span>))</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>cultural_activities_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>   <span class="st">"Knitting"</span>, <span class="st">"Cards_games"</span>, <span class="st">"Gambling"</span>, <span class="st">"Cooking"</span>, <span class="st">"DIY"</span>,</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>   <span class="st">"Vegetable_garden"</span>, <span class="st">"Fishing_hunting"</span>, <span class="st">"Collection"</span>, <span class="st">"Vehicle_custom"</span>,</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>   <span class="st">"Making_music"</span>, <span class="st">"Diary"</span>, <span class="st">"Writing"</span>, <span class="st">"Painting"</span>, <span class="st">"Montage"</span>,</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>   <span class="st">"Pottery"</span>, <span class="st">"Theater"</span>, <span class="st">"Drawing"</span>, <span class="st">"Dancing"</span>, <span class="st">"Photography"</span>,</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>   <span class="st">"Genealogy"</span>, <span class="st">"Science"</span>, <span class="st">"None"</span>, <span class="st">"Video_games"</span>, <span class="st">"Library"</span>, <span class="st">"Concert"</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (activity_2 <span class="cf">in</span> cultural_activities_2) {</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Effectuer une régression Probit pour l'activité culturelle actuelle</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>  model_formula_2 <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(activity_2, <span class="st">"~ score_normalise_2"</span>))</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>  model_2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(model_formula_2, <span class="at">data =</span> my_data_frame, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>))</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculer les prédictions</span></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>  predicted_2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">predict</span>(model_2, <span class="at">type =</span> <span class="st">"response"</span>) <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculer la précision</span></span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>  correct_predictions_2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(predicted_2 <span class="sc">==</span> my_data_frame[[activity_2]])</span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a>  total_predictions_2 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(my_data_frame)</span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>  accuracy_2 <span class="ot">&lt;-</span> (correct_predictions_2 <span class="sc">/</span> total_predictions_2) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ajouter le résultat au data frame</span></span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a>  result_table_score_2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_table_score_2, <span class="fu">data.frame</span>(<span class="at">Activity_2 =</span> activity_2, <span class="at">Accuracy_2 =</span> accuracy_2))</span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le tableau des résultats</span></span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result_table_score_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         Activity_2 Accuracy_2
1          Knitting   92.82001
2       Cards_games   56.57353
3          Gambling   78.77410
4           Cooking   69.35239
5               DIY   59.78991
6  Vegetable_garden   72.05978
7   Fishing_hunting   90.12346
8        Collection   92.67923
9    Vehicle_custom   96.55621
10     Making_music   65.97358
11            Diary   84.24301
12          Writing   87.48105
13         Painting   78.67663
14          Montage   84.54624
15          Pottery   89.50617
16          Theater   86.10570
17          Drawing   76.72731
18          Dancing   77.03054
19      Photography   74.53974
20        Genealogy   88.21746
21          Science   88.30409
22             None   71.21507
23      Video_games   61.59844
24          Library   83.47412
25          Concert   82.06628</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repos =</span> <span class="fu">c</span>(<span class="at">CRAN =</span> <span class="st">"https://cran.rstudio.com/"</span>))</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Charger les bibliothèques</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier et convertir la variable dépendante en facteur ordonné</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>satisfaction <span class="ot">&lt;-</span> <span class="fu">as.ordered</span>(my_data_frame<span class="sc">$</span>satisfaction)</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuster le modèle avec la méthode logistique</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>model_ordinal <span class="ot">&lt;-</span> <span class="fu">polr</span>(satisfaction <span class="sc">~</span> distance_to_mean_gender, </span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> my_data_frame, <span class="at">method =</span> <span class="st">"logistic"</span>)</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Résumé du modèle</span></span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_ordinal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
polr(formula = satisfaction ~ distance_to_mean_gender, data = my_data_frame, 
    method = "logistic")

Coefficients:
                         Value Std. Error t value
distance_to_mean_gender 0.1791     0.2734  0.6551

Intercepts:
           Value    Std. Error t value 
High|Low    -0.6561   0.0336   -19.5232
Low|Medium   0.9494   0.0344    27.5653

Residual Deviance: 20135.61 
AIC: 20141.61 
(9 observations effacées parce que manquantes)</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les p-values</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(model_ordinal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

                        Estimate Std. Error t value Pr(&gt;|t|)
distance_to_mean_gender  0.17910    0.27341  0.6551   0.5124</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les odds ratios</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(model_ordinal))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>distance_to_mean_gender 
               1.196142 </code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Générer une séquence de valeurs pour distance_to_mean_gender_2</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">distance_to_mean_gender =</span> <span class="fu">seq</span>(</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min</span>(my_data_frame<span class="sc">$</span>distance_to_mean_gender, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(my_data_frame<span class="sc">$</span>distance_to_mean_gender, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">length.out =</span> <span class="dv">100</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier que les types sont corrects</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(new_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   100 obs. of  1 variable:
 $ distance_to_mean_gender: num  2.12e-05 4.91e-03 9.80e-03 1.47e-02 1.96e-02 ...</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prédictions des probabilités</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>pred_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_ordinal, <span class="at">newdata =</span> new_data, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer les probabilités en data.frame</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>pred_probs_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred_probs)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter la variable explicative</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>pred_probs_df<span class="sc">$</span>distance_to_mean_gender <span class="ot">&lt;-</span> new_data<span class="sc">$</span>distance_to_mean_gender</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Restructurer les données pour ggplot</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>pred_probs_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(pred_probs_df, <span class="at">cols =</span> <span class="sc">-</span>distance_to_mean_gender, </span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>                                <span class="at">names_to =</span> <span class="st">"Satisfaction"</span>, <span class="at">values_to =</span> <span class="st">"Probability"</span>)</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiser les effets</span></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_probs_long, <span class="fu">aes</span>(<span class="at">x =</span> distance_to_mean_gender, <span class="at">y =</span> Probability, <span class="at">color =</span> Satisfaction)) <span class="sc">+</span></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Probabilités prédites de satisfaction en fonction de la distance au score moyen"</span>,</span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Distance au score moyen de genre"</span>,</span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probabilité prédite"</span>) <span class="sc">+</span></span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des effets marginaux</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>effects_plot <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(model_ordinal, <span class="at">terms =</span> <span class="st">"distance_to_mean_gender"</span>)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation des effets marginaux</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(effects_plot) <span class="sc">+</span> </span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Effet marginal de distance_to_mean_gender sur la satisfaction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier et forcer la variable explicative à être numérique</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>distance_to_mean_gender <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(my_data_frame<span class="sc">$</span>distance_to_mean_gender) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Charger les bibliothèques nécessaires</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier et convertir la variable dépendante en facteur ordonné</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>satisfaction <span class="ot">&lt;-</span> <span class="fu">as.ordered</span>(my_data_frame<span class="sc">$</span>satisfaction)</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier et forcer la variable explicative à être numérique</span></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>distance_to_mean_gender <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(my_data_frame<span class="sc">$</span>distance_to_mean_gender)</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuster le modèle avec la méthode logistique, incluant l'interaction avec Sex</span></span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>model_ordinal_sex <span class="ot">&lt;-</span> <span class="fu">polr</span>(satisfaction <span class="sc">~</span> distance_to_mean_gender <span class="sc">*</span> Sex, </span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> my_data_frame, <span class="at">method =</span> <span class="st">"logistic"</span>)</span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Résumé du modèle</span></span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_ordinal_sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
polr(formula = satisfaction ~ distance_to_mean_gender * Sex, 
    data = my_data_frame, method = "logistic")

Coefficients:
                                   Value Std. Error t value
distance_to_mean_gender           0.7581     0.4731   1.603
SexWomen                          0.1055     0.0645   1.635
distance_to_mean_gender:SexWomen -0.9423     0.5864  -1.607

Intercepts:
           Value    Std. Error t value 
High|Low    -0.5993   0.0475   -12.6208
Low|Medium   1.0066   0.0483    20.8371

Residual Deviance: 20132.67 
AIC: 20142.67 
(9 observations effacées parce que manquantes)</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les p-values</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(model_ordinal_sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

                                  Estimate Std. Error t value Pr(&gt;|t|)
distance_to_mean_gender           0.758090   0.473051  1.6026   0.1091
SexWomen                          0.105482   0.064503  1.6353   0.1020
distance_to_mean_gender:SexWomen -0.942321   0.586350 -1.6071   0.1081</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les odds ratios</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(model_ordinal_sex))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         distance_to_mean_gender                         SexWomen 
                       2.1341961                        1.1112461 
distance_to_mean_gender:SexWomen 
                       0.3897223 </code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Générer une séquence de valeurs pour distance_to_mean_gender</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>new_data_sex_men <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">distance_to_mean_gender =</span> <span class="fu">seq</span>(</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min</span>(my_data_frame<span class="sc">$</span>distance_to_mean_gender, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(my_data_frame<span class="sc">$</span>distance_to_mean_gender, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">length.out =</span> <span class="dv">100</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>new_data_sex_men<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="st">"Men"</span>  <span class="co"># Spécifier que c'est pour les hommes</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>new_data_sex_women <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">distance_to_mean_gender =</span> <span class="fu">seq</span>(</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min</span>(my_data_frame<span class="sc">$</span>distance_to_mean_gender, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(my_data_frame<span class="sc">$</span>distance_to_mean_gender, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">length.out =</span> <span class="dv">100</span></span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>new_data_sex_women<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="st">"Women"</span>  <span class="co"># Spécifier que c'est pour les femmes</span></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Combiner les données pour hommes et femmes</span></span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a>new_data_sex <span class="ot">&lt;-</span> <span class="fu">rbind</span>(new_data_sex_men, new_data_sex_women)</span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Prédictions des probabilités pour chaque catégorie de satisfaction</span></span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a>pred_probs_sex <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_ordinal_sex, <span class="at">newdata =</span> new_data_sex, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-22"><a href="#cb121-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer les probabilités en data.frame</span></span>
<span id="cb121-23"><a href="#cb121-23" aria-hidden="true" tabindex="-1"></a>pred_probs_df_sex <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred_probs_sex)</span>
<span id="cb121-24"><a href="#cb121-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-25"><a href="#cb121-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter la variable explicative (distance_to_mean_gender) et Sex</span></span>
<span id="cb121-26"><a href="#cb121-26" aria-hidden="true" tabindex="-1"></a>pred_probs_df_sex<span class="sc">$</span>distance_to_mean_gender <span class="ot">&lt;-</span> new_data_sex<span class="sc">$</span>distance_to_mean_gender</span>
<span id="cb121-27"><a href="#cb121-27" aria-hidden="true" tabindex="-1"></a>pred_probs_df_sex<span class="sc">$</span>Sex <span class="ot">&lt;-</span> new_data_sex<span class="sc">$</span>Sex</span>
<span id="cb121-28"><a href="#cb121-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-29"><a href="#cb121-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Restructurer les données pour ggplot</span></span>
<span id="cb121-30"><a href="#cb121-30" aria-hidden="true" tabindex="-1"></a>pred_probs_long_sex <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(pred_probs_df_sex, <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(distance_to_mean_gender, Sex), </span>
<span id="cb121-31"><a href="#cb121-31" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">names_to =</span> <span class="st">"Satisfaction"</span>, <span class="at">values_to =</span> <span class="st">"Probability"</span>)</span>
<span id="cb121-32"><a href="#cb121-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-33"><a href="#cb121-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiser les effets selon le sexe</span></span>
<span id="cb121-34"><a href="#cb121-34" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_probs_long_sex, <span class="fu">aes</span>(<span class="at">x =</span> distance_to_mean_gender, <span class="at">y =</span> Probability, <span class="at">color =</span> Satisfaction, <span class="at">linetype =</span> Sex)) <span class="sc">+</span></span>
<span id="cb121-35"><a href="#cb121-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb121-36"><a href="#cb121-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Probabilités prédites de satisfaction en fonction de la distance au score moyen, par sexe"</span>,</span>
<span id="cb121-37"><a href="#cb121-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Distance au score moyen de genre"</span>,</span>
<span id="cb121-38"><a href="#cb121-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probabilité prédite"</span>) <span class="sc">+</span></span>
<span id="cb121-39"><a href="#cb121-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des effets marginaux pour chaque sexe</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>effects_plot_sex <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(model_ordinal_sex, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"distance_to_mean_gender"</span>, <span class="st">"Sex"</span>))</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation des effets marginaux par sexe</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(effects_plot_sex) <span class="sc">+</span> </span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Effet marginal de distance_to_mean_gender sur la satisfaction, par sexe"</span>) <span class="sc">+</span></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Charger les bibliothèques nécessaires</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier et convertir la variable dépendante en facteur ordonné</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>satisfaction <span class="ot">&lt;-</span> <span class="fu">as.ordered</span>(my_data_frame<span class="sc">$</span>satisfaction)</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier et forcer la variable explicative à être numérique</span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>distance_abs <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(my_data_frame<span class="sc">$</span>distance_abs)</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuster le modèle avec la méthode logistique, incluant l'interaction avec Sex</span></span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>model_ordinal_sex_abs <span class="ot">&lt;-</span> <span class="fu">polr</span>(satisfaction <span class="sc">~</span> distance_abs <span class="sc">*</span> Sex, </span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> my_data_frame, <span class="at">method =</span> <span class="st">"logistic"</span>)</span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Résumé du modèle</span></span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_ordinal_sex_abs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
polr(formula = satisfaction ~ distance_abs * Sex, data = my_data_frame, 
    method = "logistic")

Coefficients:
                         Value Std. Error t value
distance_abs           0.03373    0.04550  0.7413
SexWomen              -0.02619    0.06039 -0.4336
distance_abs:SexWomen  0.07107    0.05949  1.1946

Intercepts:
           Value    Std. Error t value 
High|Low    -0.6312   0.0472   -13.3727
Low|Medium   0.9754   0.0479    20.3602

Residual Deviance: 20127.49 
AIC: 20137.49 
(9 observations effacées parce que manquantes)</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les p-values</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(model_ordinal_sex_abs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

                       Estimate Std. Error t value Pr(&gt;|t|)
distance_abs           0.033732   0.045504  0.7413   0.4585
SexWomen              -0.026185   0.060393 -0.4336   0.6646
distance_abs:SexWomen  0.071069   0.059493  1.1946   0.2323</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les odds ratios</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(model_ordinal_sex_abs))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         distance_abs              SexWomen distance_abs:SexWomen 
            1.0343070             0.9741547             1.0736553 </code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Générer une séquence de valeurs pour distance_abs</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>new_data_sex_men_abs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">distance_abs =</span> <span class="fu">seq</span>(</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min</span>(my_data_frame<span class="sc">$</span>distance_abs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(my_data_frame<span class="sc">$</span>distance_abs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">length.out =</span> <span class="dv">100</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>new_data_sex_men_abs<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="st">"Men"</span>  <span class="co"># Spécifier que c'est pour les hommes</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>new_data_sex_women_abs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">distance_abs =</span> <span class="fu">seq</span>(</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min</span>(my_data_frame<span class="sc">$</span>distance_abs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(my_data_frame<span class="sc">$</span>distance_abs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">length.out =</span> <span class="dv">100</span></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>new_data_sex_women_abs<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="st">"Women"</span>  <span class="co"># Spécifier que c'est pour les femmes</span></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Combiner les données pour hommes et femmes</span></span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a>new_data_sex_abs <span class="ot">&lt;-</span> <span class="fu">rbind</span>(new_data_sex_men_abs, new_data_sex_women_abs)</span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Prédictions des probabilités pour chaque catégorie de satisfaction</span></span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a>pred_probs_sex_abs <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_ordinal_sex_abs, <span class="at">newdata =</span> new_data_sex_abs, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-22"><a href="#cb129-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer les probabilités en data.frame</span></span>
<span id="cb129-23"><a href="#cb129-23" aria-hidden="true" tabindex="-1"></a>pred_probs_df_sex_abs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred_probs_sex_abs)</span>
<span id="cb129-24"><a href="#cb129-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-25"><a href="#cb129-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter la variable explicative (distance_abs) et Sex</span></span>
<span id="cb129-26"><a href="#cb129-26" aria-hidden="true" tabindex="-1"></a>pred_probs_df_sex_abs<span class="sc">$</span>distance_abs <span class="ot">&lt;-</span> new_data_sex_abs<span class="sc">$</span>distance_abs</span>
<span id="cb129-27"><a href="#cb129-27" aria-hidden="true" tabindex="-1"></a>pred_probs_df_sex_abs<span class="sc">$</span>Sex <span class="ot">&lt;-</span> new_data_sex_abs<span class="sc">$</span>Sex</span>
<span id="cb129-28"><a href="#cb129-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-29"><a href="#cb129-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Restructurer les données pour ggplot</span></span>
<span id="cb129-30"><a href="#cb129-30" aria-hidden="true" tabindex="-1"></a>pred_probs_long_sex_abs <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(pred_probs_df_sex_abs, <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(distance_abs, Sex), </span>
<span id="cb129-31"><a href="#cb129-31" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">names_to =</span> <span class="st">"Satisfaction"</span>, <span class="at">values_to =</span> <span class="st">"Probability"</span>)</span>
<span id="cb129-32"><a href="#cb129-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-33"><a href="#cb129-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiser les effets selon le sexe</span></span>
<span id="cb129-34"><a href="#cb129-34" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_probs_long_sex_abs, <span class="fu">aes</span>(<span class="at">x =</span> distance_abs, <span class="at">y =</span> Probability, <span class="at">color =</span> Satisfaction, <span class="at">linetype =</span> Sex)) <span class="sc">+</span></span>
<span id="cb129-35"><a href="#cb129-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb129-36"><a href="#cb129-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Probabilités prédites de satisfaction en fonction de la distance absolue au score moyen, par sexe"</span>,</span>
<span id="cb129-37"><a href="#cb129-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Distance absolue au score moyen de genre"</span>,</span>
<span id="cb129-38"><a href="#cb129-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probabilité prédite"</span>) <span class="sc">+</span></span>
<span id="cb129-39"><a href="#cb129-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des effets marginaux pour chaque sexe</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>effects_plot_sex_abs <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(model_ordinal_sex_abs, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"distance_abs"</span>, <span class="st">"Sex"</span>))</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation des effets marginaux par sexe</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(effects_plot_sex_abs) <span class="sc">+</span> </span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Effet marginal de distance_abs sur la satisfaction, par sexe"</span>) <span class="sc">+</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Charger les bibliothèques nécessaires</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier et convertir la variable dépendante en facteur ordonné</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>Health <span class="ot">&lt;-</span> <span class="fu">as.ordered</span>(my_data_frame<span class="sc">$</span>Health)</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier et forcer la variable explicative à être numérique</span></span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>distance_to_mean_gender <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(my_data_frame<span class="sc">$</span>distance_to_mean_gender)</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuster le modèle avec la méthode logistique, incluant l'interaction avec Sex</span></span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>model_ordinal_sex <span class="ot">&lt;-</span> <span class="fu">polr</span>(Health <span class="sc">~</span> distance_to_mean_gender <span class="sc">*</span> Sex, </span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> my_data_frame, <span class="at">method =</span> <span class="st">"logistic"</span>)</span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Résumé du modèle</span></span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_ordinal_sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
polr(formula = Health ~ distance_to_mean_gender * Sex, data = my_data_frame, 
    method = "logistic")

Coefficients:
                                    Value Std. Error t value
distance_to_mean_gender          -0.57815    0.54853  -1.054
SexWomen                         -0.02355    0.07524  -0.313
distance_to_mean_gender:SexWomen  0.97396    0.68472   1.422

Intercepts:
            Value    Std. Error t value 
Bad|Good     -2.3850   0.0614   -38.8363
Good|Medium   1.2711   0.0548    23.2057

Residual Deviance: 14570.94 
AIC: 14580.94 
(43 observations effacées parce que manquantes)</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les p-values</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(model_ordinal_sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

                                  Estimate Std. Error t value Pr(&gt;|t|)
distance_to_mean_gender          -0.578147   0.548528 -1.0540   0.2919
SexWomen                         -0.023552   0.075243 -0.3130   0.7543
distance_to_mean_gender:SexWomen  0.973960   0.684719  1.4224   0.1549</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les odds ratios</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(model_ordinal_sex))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         distance_to_mean_gender                         SexWomen 
                       0.5609366                        0.9767235 
distance_to_mean_gender:SexWomen 
                       2.6484101 </code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Générer une séquence de valeurs pour distance_to_mean_gender</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>new_data_sex_men <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">distance_to_mean_gender =</span> <span class="fu">seq</span>(</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min</span>(my_data_frame<span class="sc">$</span>distance_to_mean_gender, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(my_data_frame<span class="sc">$</span>distance_to_mean_gender, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">length.out =</span> <span class="dv">100</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>new_data_sex_men<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="st">"Men"</span>  <span class="co"># Spécifier que c'est pour les hommes</span></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>new_data_sex_women <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">distance_to_mean_gender =</span> <span class="fu">seq</span>(</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">min</span>(my_data_frame<span class="sc">$</span>distance_to_mean_gender, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(my_data_frame<span class="sc">$</span>distance_to_mean_gender, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">length.out =</span> <span class="dv">100</span></span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>new_data_sex_women<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="st">"Women"</span>  <span class="co"># Spécifier que c'est pour les femmes</span></span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Combiner les données pour hommes et femmes</span></span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>new_data_sex <span class="ot">&lt;-</span> <span class="fu">rbind</span>(new_data_sex_men, new_data_sex_women)</span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Prédictions des probabilités pour chaque catégorie de satisfaction</span></span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a>pred_probs_sex <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_ordinal_sex, <span class="at">newdata =</span> new_data_sex, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer les probabilités en data.frame</span></span>
<span id="cb137-23"><a href="#cb137-23" aria-hidden="true" tabindex="-1"></a>pred_probs_df_sex <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred_probs_sex)</span>
<span id="cb137-24"><a href="#cb137-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-25"><a href="#cb137-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter la variable explicative (distance_to_mean_gender) et Sex</span></span>
<span id="cb137-26"><a href="#cb137-26" aria-hidden="true" tabindex="-1"></a>pred_probs_df_sex<span class="sc">$</span>distance_to_mean_gender <span class="ot">&lt;-</span> new_data_sex<span class="sc">$</span>distance_to_mean_gender</span>
<span id="cb137-27"><a href="#cb137-27" aria-hidden="true" tabindex="-1"></a>pred_probs_df_sex<span class="sc">$</span>Sex <span class="ot">&lt;-</span> new_data_sex<span class="sc">$</span>Sex</span>
<span id="cb137-28"><a href="#cb137-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-29"><a href="#cb137-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Restructurer les données pour ggplot</span></span>
<span id="cb137-30"><a href="#cb137-30" aria-hidden="true" tabindex="-1"></a>pred_probs_long_sex <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(pred_probs_df_sex, <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(distance_to_mean_gender, Sex), </span>
<span id="cb137-31"><a href="#cb137-31" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">names_to =</span> <span class="st">"Health"</span>, <span class="at">values_to =</span> <span class="st">"Probability"</span>)</span>
<span id="cb137-32"><a href="#cb137-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-33"><a href="#cb137-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiser les effets selon le sexe</span></span>
<span id="cb137-34"><a href="#cb137-34" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_probs_long_sex, <span class="fu">aes</span>(<span class="at">x =</span> distance_to_mean_gender, <span class="at">y =</span> Probability, <span class="at">color =</span> Health, <span class="at">linetype =</span> Sex)) <span class="sc">+</span></span>
<span id="cb137-35"><a href="#cb137-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb137-36"><a href="#cb137-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Probabilités prédites de santé en fonction de la distance au score moyen, par sexe"</span>,</span>
<span id="cb137-37"><a href="#cb137-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Distance au score moyen de genre"</span>,</span>
<span id="cb137-38"><a href="#cb137-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probabilité prédite"</span>) <span class="sc">+</span></span>
<span id="cb137-39"><a href="#cb137-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des effets marginaux pour chaque sexe</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>effects_plot_sex <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(model_ordinal_sex, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"distance_to_mean_gender"</span>, <span class="st">"Sex"</span>))</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation des effets marginaux par sexe</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(effects_plot_sex) <span class="sc">+</span> </span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Effet marginal de distance_to_mean_gender sur la satisfaction, par sexe"</span>) <span class="sc">+</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-35-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my_data_frame, <span class="fu">aes</span>(<span class="at">x =</span> distance_to_mean_gender, <span class="at">fill =</span> satisfaction)) <span class="sc">+</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Répartition de la satisfaction par distance_to_mean_gender"</span>,</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Distance au score moyen de genre"</span>,</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proportion"</span>) <span class="sc">+</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my_data_frame, <span class="fu">aes</span>(<span class="at">x =</span> satisfaction, <span class="at">y =</span> distance_to_mean_gender, <span class="at">fill =</span> satisfaction)) <span class="sc">+</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution de distance_to_mean_gender par satisfaction"</span>,</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Satisfaction"</span>,</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Distance au score moyen de genre"</span>) <span class="sc">+</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-36-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer la distance absolue par rapport à la moyenne et à l'écart-type pour chaque sexe</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>mean_gender_score <span class="ot">&lt;-</span> <span class="fu">tapply</span>(my_data_frame<span class="sc">$</span>distance_to_mean_gender, my_data_frame<span class="sc">$</span>Sex, mean)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>sd_gender <span class="ot">&lt;-</span> <span class="fu">tapply</span>(my_data_frame<span class="sc">$</span>distance_to_mean_gender, my_data_frame<span class="sc">$</span>Sex, sd)</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer la distance absolue par rapport à la moyenne et l'écart-type</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>distance_abs_score <span class="ot">&lt;-</span> <span class="fu">abs</span>((my_data_frame<span class="sc">$</span>distance_to_mean_gender <span class="sc">-</span> mean_gender_score[my_data_frame<span class="sc">$</span>Sex]) <span class="sc">/</span> sd_gender[my_data_frame<span class="sc">$</span>Sex])</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer une colonne norm_status pour identifier les individus "hors normes" (distance_abs_score &gt; 2 par exemple)</span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>my_data_frame<span class="sc">$</span>norm_status <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(my_data_frame<span class="sc">$</span>distance_abs_score <span class="sc">&gt;</span> <span class="dv">2</span>, <span class="st">"Hors normes"</span>, <span class="st">"Normaux"</span>)</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier que la colonne a bien été ajoutée</span></span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my_data_frame)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         IDENT18    POND_INIT         POND TYPMEN NHAB TUU2016 REG SEXE AGE
1 Z01202A00002V2 0.9702619959 5205.7105547      1    1       2  84    1  59
2   Z01202A00004 0.9702619959 13909.706241      4    3       2  84    1  16
3 Z01202A00006V2 0.9702619959  6949.074595      4    3       2  84    1  47
4   Z01202A00007 0.9702619959 4162.1183557      3    2       2  84    2  74
5   Z01202A00008 0.9702619959 2823.6286989      1    1       2  84    1  71
6   Z01202A00010 0.9702619959 4602.0810455      4    3       2  84    1  52
  CRITAGE AUTRENF PETITENF LNAIS REVENU TRANREV CRITREVENU CLASS_univprat
1       3       2       NA     1      1      NA          6              2
2       1       2       NA     1      1      NA          8              3
3       3       2       NA     1      1      NA          9              4
4       4       1        2     2      1      NA          4              1
5       4       2       NA     1      2       3          3              1
6       3      NA        2     1      1      NA          9              4
  CLASS_univprat_name A15 A16 A17 A18_SQ1 A18_SQ2 A18_SQ3 A18_SQ4 VITENCOUPLE
1          Bain audio   2   2   3      NA      NA      NA      NA           3
2            Tout-num   1   2   3      NA      NA      NA      NA           3
3        Culture patr   4   1   2       1       1       1       1           1
4         Petit ecran   3   2   3      NA      NA      NA      NA           1
5         Petit ecran   3   2   3      NA      NA      NA      NA           3
6        Culture patr   2   2   3      NA      NA      NA      NA           1
  NOIKISH NOICONJ CSTOT CSTOT_conj G_PCS_MENAGE_ SG_PCS_MENAGE_ I_PCS_MENAGE
1       1      NA    48         NA           III          III B            0
2       3      NA    NA         NA           III          III C            1
3       2       1    33         42             I          I   B            0
4       2       1    56         68             V          V   A            0
5       1      NA    64         NA            VI          VI  B            0
6       1       2    37         37             I          I   A            0
  SEXE_pers1 ANAIS_pers1 AGE_pers1 AGEJANV_pers1 LNAIS_pers1 DEPNAIS_pers1
1          1        1959        59            58           1            69
2          1        1978        39            39           1            39
3          2        1975        43            42           1             1
4          1        1934        83            83           2              
5          1        1946        71            71           1             1
6          1        1966        52            51           1             1
  ANARRIV_pers1 ANARRIV_pers1_C_1 AGARRIV_pers1 AGARRIV_pers1_C_1 COUPLE_pers1
1            NA                NA            NA                NA            3
2            NA                NA            NA                NA            1
3            NA                NA            NA                NA            1
4             1              1971            NA                NA            1
5            NA                NA            NA                NA            3
6            NA                NA            NA                NA            1
  NOI_99_pers1 CONJOINT_pers1 ETAMATRI_pers1 MER1E_pers1 MERELOG_pers1
1           NA             NA              1           3            NA
2           NA              2              2           2            NA
3           NA              2              1           2            22
4           NA              2              2           3            NA
5           NA             NA              1           3            NA
6           NA              2              2           2            NA
  PERELOG_pers1 PER1E_pers1 LIENTYP_pers1 LIENPERS_pers1 SEXE_pers2 ANAIS_pers2
1            NA           3            NA             NA         NA          NA
2            22           1            NA             NA          2        1979
3            NA           2            NA             NA          1        1971
4            NA           3            NA             NA          2        1943
5            NA           3            NA             NA         NA          NA
6            22           3            NA             NA          2        1963
  AGE_pers2 AGEJANV_pers2 LNAIS_pers2 DEPNAIS_pers2 ANARRIV_pers2
1        NA            NA          NA                          NA
2        39            38           1            38            NA
3        47            46           1             1            NA
4        74            74           2                           1
5        NA            NA          NA                          NA
6        55            54           1             1            NA
  ANARRIV_pers2_C_1 AGARRIV_pers2 AGARRIV_pers2_C_1 COUPLE_pers2 NOI_99_pers2
1                NA            NA                NA           NA           NA
2                NA            NA                NA            1           NA
3                NA            NA                NA            1           NA
4              1973            NA                NA            1           NA
5                NA            NA                NA           NA           NA
6                NA            NA                NA            1           NA
  CONJOINT_pers2 ETAMATRI_pers2 MER1E_pers2 MERELOG_pers2 PERELOG_pers2
1             NA             NA          NA            NA            NA
2              1              2           2            22            NA
3              1              1           2            NA            NA
4              1              2           3            NA            NA
5             NA             NA          NA            NA            NA
6              1              2           2            22            NA
  PER1E_pers2 LIENTYP_pers2 LIENPERS_pers2 SEXE_pers3 ANAIS_pers3 AGE_pers3
1          NA            NA             NA         NA          NA        NA
2           2            NA             NA          1        2001        16
3           3            NA             NA          1        2002        16
4           3            NA             NA         NA          NA        NA
5          NA            NA             NA         NA          NA        NA
6           2            NA             NA          1        1995        22
  AGEJANV_pers3 LNAIS_pers3 DEPNAIS_pers3 ANARRIV_pers3 ANARRIV_pers3_C_1
1            NA          NA                          NA                NA
2            16           1            84            NA                NA
3            15           1            69            NA                NA
4            NA          NA                          NA                NA
5            NA          NA                          NA                NA
6            22           1             1            NA                NA
  AGARRIV_pers3 AGARRIV_pers3_C_1 COUPLE_pers3 NOI_99_pers3 CONJOINT_pers3
1            NA                NA           NA           NA             NA
2            NA                NA            3           NA             NA
3            NA                NA            3           NA             NA
4            NA                NA           NA           NA             NA
5            NA                NA           NA           NA             NA
6            NA                NA            3           NA             NA
  ETAMATRI_pers3 MER1E_pers3 MERELOG_pers3 PERELOG_pers3 PER1E_pers3
1             NA          NA            NA            NA          NA
2              1           1             2             1           1
3              1           1             1            21           2
4             NA          NA            NA            NA          NA
5             NA          NA            NA            NA          NA
6              1           1             2             1           1
  LIENTYP_pers3 LIENPERS_pers3 SEXE_pers4 ANAIS_pers4 AGE_pers4 AGEJANV_pers4
1            NA             NA         NA          NA        NA            NA
2            NA             NA         NA          NA        NA            NA
3            NA             NA         NA          NA        NA            NA
4            NA             NA         NA          NA        NA            NA
5            NA             NA         NA          NA        NA            NA
6            NA             NA         NA          NA        NA            NA
  LNAIS_pers4 DEPNAIS_pers4 ANARRIV_pers4 ANARRIV_pers4_C_1 AGARRIV_pers4
1          NA                          NA                NA            NA
2          NA                          NA                NA            NA
3          NA                          NA                NA            NA
4          NA                          NA                NA            NA
5          NA                          NA                NA            NA
6          NA                          NA                NA            NA
  AGARRIV_pers4_C_1 COUPLE_pers4 NOI_99_pers4 CONJOINT_pers4 ETAMATRI_pers4
1                NA           NA           NA             NA             NA
2                NA           NA           NA             NA             NA
3                NA           NA           NA             NA             NA
4                NA           NA           NA             NA             NA
5                NA           NA           NA             NA             NA
6                NA           NA           NA             NA             NA
  MER1E_pers4 MERELOG_pers4 PERELOG_pers4 PER1E_pers4 LIENTYP_pers4
1          NA            NA            NA          NA            NA
2          NA            NA            NA          NA            NA
3          NA            NA            NA          NA            NA
4          NA            NA            NA          NA            NA
5          NA            NA            NA          NA            NA
6          NA            NA            NA          NA            NA
  LIENPERS_pers4 SEXE_pers5 ANAIS_pers5 AGE_pers5 AGEJANV_pers5 LNAIS_pers5
1             NA         NA          NA        NA            NA          NA
2             NA         NA          NA        NA            NA          NA
3             NA         NA          NA        NA            NA          NA
4             NA         NA          NA        NA            NA          NA
5             NA         NA          NA        NA            NA          NA
6             NA         NA          NA        NA            NA          NA
  DEPNAIS_pers5 ANARRIV_pers5 ANARRIV_pers5_C_1 AGARRIV_pers5 AGARRIV_pers5_C_1
1            NA            NA                NA            NA                NA
2            NA            NA                NA            NA                NA
3            NA            NA                NA            NA                NA
4            NA            NA                NA            NA                NA
5            NA            NA                NA            NA                NA
6            NA            NA                NA            NA                NA
  COUPLE_pers5 NOI_99_pers5 CONJOINT_pers5 ETAMATRI_pers5 MER1E_pers5
1           NA           NA             NA             NA          NA
2           NA           NA             NA             NA          NA
3           NA           NA             NA             NA          NA
4           NA           NA             NA             NA          NA
5           NA           NA             NA             NA          NA
6           NA           NA             NA             NA          NA
  MERELOG_pers5 PERELOG_pers5 PER1E_pers5 LIENTYP_pers5 LIENPERS_pers5
1            NA            NA          NA            NA             NA
2            NA            NA          NA            NA             NA
3            NA            NA          NA            NA             NA
4            NA            NA          NA            NA             NA
5            NA            NA          NA            NA             NA
6            NA            NA          NA            NA             NA
  SEXE_pers6 ANAIS_pers6 AGE_pers6 AGEJANV_pers6 LNAIS_pers6 DEPNAIS_pers6
1         NA          NA        NA            NA          NA            NA
2         NA          NA        NA            NA          NA            NA
3         NA          NA        NA            NA          NA            NA
4         NA          NA        NA            NA          NA            NA
5         NA          NA        NA            NA          NA            NA
6         NA          NA        NA            NA          NA            NA
  ANARRIV_pers6 ANARRIV_pers6_C_1 AGARRIV_pers6 AGARRIV_pers6_C_1 COUPLE_pers6
1            NA                NA            NA                NA           NA
2            NA                NA            NA                NA           NA
3            NA                NA            NA                NA           NA
4            NA                NA            NA                NA           NA
5            NA                NA            NA                NA           NA
6            NA                NA            NA                NA           NA
  NOI_99_pers6 CONJOINT_pers6 ETAMATRI_pers6 MER1E_pers6 MERELOG_pers6
1           NA             NA             NA          NA            NA
2           NA             NA             NA          NA            NA
3           NA             NA             NA          NA            NA
4           NA             NA             NA          NA            NA
5           NA             NA             NA          NA            NA
6           NA             NA             NA          NA            NA
  PERELOG_pers6 PER1E_pers6 LIENTYP_pers6 LIENPERS_pers6 SEXE_pers7 ANAIS_pers7
1            NA          NA            NA             NA         NA          NA
2            NA          NA            NA             NA         NA          NA
3            NA          NA            NA             NA         NA          NA
4            NA          NA            NA             NA         NA          NA
5            NA          NA            NA             NA         NA          NA
6            NA          NA            NA             NA         NA          NA
  AGE_pers7 AGEJANV_pers7 LNAIS_pers7 DEPNAIS_pers7 ANARRIV_pers7
1        NA            NA          NA            NA            NA
2        NA            NA          NA            NA            NA
3        NA            NA          NA            NA            NA
4        NA            NA          NA            NA            NA
5        NA            NA          NA            NA            NA
6        NA            NA          NA            NA            NA
  ANARRIV_pers7_C_1 AGARRIV_pers7 AGARRIV_pers7_C_1 COUPLE_pers7 NOI_99_pers7
1                NA            NA                NA           NA           NA
2                NA            NA                NA           NA           NA
3                NA            NA                NA           NA           NA
4                NA            NA                NA           NA           NA
5                NA            NA                NA           NA           NA
6                NA            NA                NA           NA           NA
  CONJOINT_pers7 ETAMATRI_pers7 MER1E_pers7 MERELOG_pers7 PERELOG_pers7
1             NA             NA          NA            NA            NA
2             NA             NA          NA            NA            NA
3             NA             NA          NA            NA            NA
4             NA             NA          NA            NA            NA
5             NA             NA          NA            NA            NA
6             NA             NA          NA            NA            NA
  PER1E_pers7 LIENTYP_pers7 LIENPERS_pers7 SEXE_pers8 ANAIS_pers8 AGE_pers8
1          NA            NA             NA         NA          NA        NA
2          NA            NA             NA         NA          NA        NA
3          NA            NA             NA         NA          NA        NA
4          NA            NA             NA         NA          NA        NA
5          NA            NA             NA         NA          NA        NA
6          NA            NA             NA         NA          NA        NA
  AGEJANV_pers8 LNAIS_pers8 DEPNAIS_pers8 ANARRIV_pers8 ANARRIV_pers8_C_1
1            NA          NA            NA            NA                NA
2            NA          NA            NA            NA                NA
3            NA          NA            NA            NA                NA
4            NA          NA            NA            NA                NA
5            NA          NA            NA            NA                NA
6            NA          NA            NA            NA                NA
  AGARRIV_pers8 AGARRIV_pers8_C_1 COUPLE_pers8 NOI_99_pers8 CONJOINT_pers8
1            NA                NA           NA           NA             NA
2            NA                NA           NA           NA             NA
3            NA                NA           NA           NA             NA
4            NA                NA           NA           NA             NA
5            NA                NA           NA           NA             NA
6            NA                NA           NA           NA             NA
  ETAMATRI_pers8 MER1E_pers8 MERELOG_pers8 PERELOG_pers8 PER1E_pers8
1             NA          NA            NA            NA          NA
2             NA          NA            NA            NA          NA
3             NA          NA            NA            NA          NA
4             NA          NA            NA            NA          NA
5             NA          NA            NA            NA          NA
6             NA          NA            NA            NA          NA
  LIENTYP_pers8 LIENPERS_pers8 A1 A2 A3 A4 A5 A6 A71 A72 A73 A74 A75 A8 A9
1            NA             NA  1  1  1  2  1  1   0   0   1   0   0  5  4
2            NA             NA  1  2  1  4  1  3   1   0   0   0   0  1  5
3            NA             NA  1  3  1  1  1  1   0   0   1   0   0  2  3
4            NA             NA  2  3  2 NA  1  1   1   0   0   0   0  5  2
5            NA             NA  2  3  2 NA  2 NA  NA  NA  NA  NA  NA  4  5
6            NA             NA  1  1  1  2  1  1   1   0   0   0   0  5  3
  Knitting Cards_games Gambling Cooking DIY Vegetable_garden Ornamental_garden
1        0           0        0       0   1                0                 0
2        0           0        0       0   0                0                 0
3        0           0        0       1   0                1                 0
4        1           0        0       1   0                1                 0
5        0           0        1       0   0                0                 0
6        0           1        0       1   1                1                 1
  Fishing_hunting Collection Vehicle_custom No_Amateur A1012 A1013 A1101 A1102
1               1          1              1          0     0     0    NA    NA
2               0          0              0          1     0     0    NA    NA
3               0          0              0          0     0     0    NA    NA
4               0          0              0          0     0     0    NA    NA
5               0          0              0          0     0     0     1     0
6               0          0              0          0     0     0     1     0
  A1103 A1104 A1105 A1106 A1107 A1108 A1109 A1110 A1111 A1112 A1113 A12 A13
1    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA   1   1
2    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA   1   1
3    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA   2  NA
4    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA   2  NA
5     0     0     0     0     0     0     0     0     0     0     0   2  NA
6     0     0     0     0     0     1     0     0     0     0     0   1   3
  Making_music Diary Writing Painting Montage Circus Pottery Theater Drawing
1            0     0       0        0       0      0       0       0       0
2            1     0       0        1       1      0       0       0       1
3            1     0       0        1       0      0       0       0       0
4            0     0       0        0       0      0       0       0       0
5            0     0       0        0       0      0       0       0       0
6            0     0       0        0       0      0       0       0       0
  Dancing Photography Genealogy Science None A1915 A1916 RECODE_A21 A20_musique
1       0           1         0       0    0     0     0          1          NA
2       0           1         0       1    0     0     0          4           8
3       0           0         0       0    0     0     0          2          44
4       0           0         0       0    1     0     0         NA          NA
5       0           0         0       0    1     0     0         NA          NA
6       0           0         0       0    1     0     0         NA          NA
  A21_musique A22_musique A23_musique A241_musique A242_musique A243_musique
1          NA          NA          NA           NA           NA           NA
2           2          15          NA           NA           NA           NA
3           1          NA           1            1            0            0
4          NA          NA          NA           NA           NA           NA
5          NA          NA          NA           NA           NA           NA
6          NA          NA          NA           NA           NA           NA
  A244_musique A245_musique A246_musique A25_musique A261_musique A262_musique
1           NA           NA           NA          NA           NA           NA
2           NA           NA           NA          NA            0            0
3            0            0            0          NA            1            0
4           NA           NA           NA          NA           NA           NA
5           NA           NA           NA          NA           NA           NA
6           NA           NA           NA          NA           NA           NA
  A263_musique A264_musique A265_musique A266_musique A267_musique A27_musique
1           NA           NA           NA           NA           NA            
2            1            0            0            0            0            
3            0            0            0            0            0         268
4           NA           NA           NA           NA           NA            
5           NA           NA           NA           NA           NA            
6           NA           NA           NA           NA           NA            
  A28_musique A2901_musique A2902_musique A2903_musique A2904_musique
1                        NA            NA            NA            NA
2                         1             1             0             0
3                         0             0             0             0
4                        NA            NA            NA            NA
5                        NA            NA            NA            NA
6                        NA            NA            NA            NA
  A2905_musique A2906_musique A2907_musique A2908_musique A2909_musique
1            NA            NA            NA            NA            NA
2             0             0             0             0             0
3             0             0             0             0             1
4            NA            NA            NA            NA            NA
5            NA            NA            NA            NA            NA
6            NA            NA            NA            NA            NA
  A2910_musique A2911_musique A2912_musique A2913_musique A20_journal
1            NA            NA            NA            NA          NA
2             0             0             0             0          NA
3             0             0             0             0          NA
4            NA            NA            NA            NA          NA
5            NA            NA            NA            NA          NA
6            NA            NA            NA            NA          NA
  A21_journal A22_journal A23_journal A241_journal A242_journal A243_journal
1          NA          NA          NA           NA           NA           NA
2          NA          NA          NA           NA           NA           NA
3          NA          NA          NA           NA           NA           NA
4          NA          NA          NA           NA           NA           NA
5          NA          NA          NA           NA           NA           NA
6          NA          NA          NA           NA           NA           NA
  A244_journal A245_journal A246_journal A25_journal A20_romans A21_romans
1           NA           NA           NA          NA         NA         NA
2           NA           NA           NA          NA         NA         NA
3           NA           NA           NA          NA         NA         NA
4           NA           NA           NA          NA         NA         NA
5           NA           NA           NA          NA         NA         NA
6           NA           NA           NA          NA         NA         NA
  A22_romans A23_romans A241_romans A242_romans A243_romans A244_romans
1         NA         NA          NA          NA          NA          NA
2         NA         NA          NA          NA          NA          NA
3         NA         NA          NA          NA          NA          NA
4         NA         NA          NA          NA          NA          NA
5         NA         NA          NA          NA          NA          NA
6         NA         NA          NA          NA          NA          NA
  A245_romans A246_romans A25_romans A20_peinture A21_peinture A22_peinture
1          NA          NA         NA           NA           NA           NA
2          NA          NA         NA            5            2           15
3          NA          NA         NA           39            1           NA
4          NA          NA         NA           NA           NA           NA
5          NA          NA         NA           NA           NA           NA
6          NA          NA         NA           NA           NA           NA
  A23_peinture A241_peinture A242_peinture A243_peinture A244_peinture
1           NA            NA            NA            NA            NA
2           NA            NA            NA            NA            NA
3            2            NA            NA            NA            NA
4           NA            NA            NA            NA            NA
5           NA            NA            NA            NA            NA
6           NA            NA            NA            NA            NA
  A245_peinture A246_peinture A25_peinture A20_montages A21_montages
1            NA            NA           NA           NA           NA
2            NA            NA           NA           15            1
3            NA            NA            2           NA           NA
4            NA            NA           NA           NA           NA
5            NA            NA           NA           NA           NA
6            NA            NA           NA           NA           NA
  A22_montages A23_montages A241_montages A242_montages A243_montages
1           NA           NA            NA            NA            NA
2           NA            2            NA            NA            NA
3           NA           NA            NA            NA            NA
4           NA           NA            NA            NA            NA
5           NA           NA            NA            NA            NA
6           NA           NA            NA            NA            NA
  A244_montages A245_montages A246_montages A25_montages A20_cirque A21_cirque
1            NA            NA            NA           NA         NA         NA
2            NA            NA            NA            2         NA         NA
3            NA            NA            NA           NA         NA         NA
4            NA            NA            NA           NA         NA         NA
5            NA            NA            NA           NA         NA         NA
6            NA            NA            NA           NA         NA         NA
  A22_cirque A23_cirque A241_cirque A242_cirque A243_cirque A244_cirque
1         NA         NA          NA          NA          NA          NA
2         NA         NA          NA          NA          NA          NA
3         NA         NA          NA          NA          NA          NA
4         NA         NA          NA          NA          NA          NA
5         NA         NA          NA          NA          NA          NA
6         NA         NA          NA          NA          NA          NA
  A245_cirque A246_cirque A25_cirque A20_poterie A21_poterie A22_poterie
1          NA          NA         NA          NA          NA          NA
2          NA          NA         NA          NA          NA          NA
3          NA          NA         NA          NA          NA          NA
4          NA          NA         NA          NA          NA          NA
5          NA          NA         NA          NA          NA          NA
6          NA          NA         NA          NA          NA          NA
  A23_poterie A241_poterie A242_poterie A243_poterie A244_poterie A245_poterie
1          NA           NA           NA           NA           NA           NA
2          NA           NA           NA           NA           NA           NA
3          NA           NA           NA           NA           NA           NA
4          NA           NA           NA           NA           NA           NA
5          NA           NA           NA           NA           NA           NA
6          NA           NA           NA           NA           NA           NA
  A246_poterie A25_poterie A20_theatre A21_theatre A22_theatre A23_theatre
1           NA          NA          NA          NA          NA          NA
2           NA          NA          NA          NA          NA          NA
3           NA          NA          NA          NA          NA          NA
4           NA          NA          NA          NA          NA          NA
5           NA          NA          NA          NA          NA          NA
6           NA          NA          NA          NA          NA          NA
  A241_theatre A242_theatre A243_theatre A244_theatre A245_theatre A246_theatre
1           NA           NA           NA           NA           NA           NA
2           NA           NA           NA           NA           NA           NA
3           NA           NA           NA           NA           NA           NA
4           NA           NA           NA           NA           NA           NA
5           NA           NA           NA           NA           NA           NA
6           NA           NA           NA           NA           NA           NA
  A25_theatre A20_dessin A21_dessin A22_dessin A23_dessin A241_dessin
1          NA         NA         NA         NA         NA          NA
2          NA          5          1         NA          1           0
3          NA         NA         NA         NA         NA          NA
4          NA         NA         NA         NA         NA          NA
5          NA         NA         NA         NA         NA          NA
6          NA         NA         NA         NA         NA          NA
  A242_dessin A243_dessin A244_dessin A245_dessin A246_dessin A25_dessin
1          NA          NA          NA          NA          NA         NA
2           0           0           1           0           0         NA
3          NA          NA          NA          NA          NA         NA
4          NA          NA          NA          NA          NA         NA
5          NA          NA          NA          NA          NA         NA
6          NA          NA          NA          NA          NA         NA
  A20_danse A21_danse A22_danse A23_danse A241_danse A242_danse A243_danse
1        NA        NA        NA        NA         NA         NA         NA
2        NA        NA        NA        NA         NA         NA         NA
3        NA        NA        NA        NA         NA         NA         NA
4        NA        NA        NA        NA         NA         NA         NA
5        NA        NA        NA        NA         NA         NA         NA
6        NA        NA        NA        NA         NA         NA         NA
  A244_danse A245_danse A246_danse A25_danse A3001_danse A3002_danse
1         NA         NA         NA        NA          NA          NA
2         NA         NA         NA        NA          NA          NA
3         NA         NA         NA        NA          NA          NA
4         NA         NA         NA        NA          NA          NA
5         NA         NA         NA        NA          NA          NA
6         NA         NA         NA        NA          NA          NA
  A3003_danse A3004_danse A3005_danse A3006_danse A3007_danse A3008_danse
1          NA          NA          NA          NA          NA          NA
2          NA          NA          NA          NA          NA          NA
3          NA          NA          NA          NA          NA          NA
4          NA          NA          NA          NA          NA          NA
5          NA          NA          NA          NA          NA          NA
6          NA          NA          NA          NA          NA          NA
  A3009_danse A3010_danse A20_photo A21_photo A22_photo A23_photo A241_photo
1          NA          NA        30         1        NA         2         NA
2          NA          NA        13         1        NA         2         NA
3          NA          NA        NA        NA        NA        NA         NA
4          NA          NA        NA        NA        NA        NA         NA
5          NA          NA        NA        NA        NA        NA         NA
6          NA          NA        NA        NA        NA        NA         NA
  A242_photo A243_photo A244_photo A245_photo A246_photo A25_photo
1         NA         NA         NA         NA         NA         2
2         NA         NA         NA         NA         NA         2
3         NA         NA         NA         NA         NA        NA
4         NA         NA         NA         NA         NA        NA
5         NA         NA         NA         NA         NA        NA
6         NA         NA         NA         NA         NA        NA
  A20_genealogie A21_genealogie A22_genealogie A23_genealogie A241_genealogie
1             NA             NA             NA             NA              NA
2             NA             NA             NA             NA              NA
3             NA             NA             NA             NA              NA
4             NA             NA             NA             NA              NA
5             NA             NA             NA             NA              NA
6             NA             NA             NA             NA              NA
  A242_genealogie A243_genealogie A244_genealogie A245_genealogie
1              NA              NA              NA              NA
2              NA              NA              NA              NA
3              NA              NA              NA              NA
4              NA              NA              NA              NA
5              NA              NA              NA              NA
6              NA              NA              NA              NA
  A246_genealogie A25_genealogie A20_activite_scientifique
1              NA             NA                        NA
2              NA             NA                        15
3              NA             NA                        NA
4              NA             NA                        NA
5              NA             NA                        NA
6              NA             NA                        NA
  A21_activite_scientifique A22_activite_scientifique A23_activite_scientifique
1                        NA                        NA                        NA
2                         1                        NA                         1
3                        NA                        NA                        NA
4                        NA                        NA                        NA
5                        NA                        NA                        NA
6                        NA                        NA                        NA
  A241_activite_scientifique A242_activite_scientifique
1                         NA                         NA
2                          0                          0
3                         NA                         NA
4                         NA                         NA
5                         NA                         NA
6                         NA                         NA
  A243_activite_scientifique A244_activite_scientifique
1                         NA                         NA
2                          0                          1
3                         NA                         NA
4                         NA                         NA
5                         NA                         NA
6                         NA                         NA
  A245_activite_scientifique A246_activite_scientifique
1                         NA                         NA
2                          0                          0
3                         NA                         NA
4                         NA                         NA
5                         NA                         NA
6                         NA                         NA
  A25_activite_scientifique A311 A312 A313 A314 A315 A316 A32 A32BIS A33
1                        NA    0    0    1    0    0    0   2     NA   1
2                        NA    1    1    1    0    0    0   2     14   2
3                        NA    1    0    0    0    0    0  NA     14   2
4                        NA   NA   NA   NA   NA   NA   NA  NA     NA  NA
5                        NA   NA   NA   NA   NA   NA   NA  NA     NA  NA
6                        NA   NA   NA   NA   NA   NA   NA  NA     NA  NA
  Video_games B2 B3 B401 B402 B403 B404 B405 B406 B407 B408 B409 B410 B5 B601
1           1  4  4    1    0    0    0    0    0    0    0    0    0  2    1
2           1  3  2    1    0    0    0    0    1    0    0    0    0  1    0
3           0 NA NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA NA   NA
4           0 NA NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA NA   NA
5           0 NA NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA NA   NA
6           0 NA NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA NA   NA
  B602 B603 B604 B605 B606 B607 B608 B609 B610 B611 B612 B613 B614 B7 TV C2
1    0    1    0    0    0    0    0    0    0    0    0    0    0  4  1  1
2    0    0    1    0    1    1    0    0    1    0    0    0    0  2  1  4
3   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA NA  1  2
4   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA NA  1  4
5   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA NA  1  1
6   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA NA  1  1
  C301 C302 C303 C304 C305 C306 C307 C308 C309 C310 C4 C5 C61 C62 C63 C64 C65
1    1    1    0    0    0    1    0    0    0    0 NA NA   1   0   0   0   0
2    1    0    0    0    0    0    0    0    0    0 28 30   1   0   0   1   0
3    1    1    0    0    0    0    0    0    0    0 NA NA   1   0   0   0   0
4    1    1    1    0    0    1    0    0    0    0 28 29   1   0   0   0   0
5    1    0    0    0    0    0    0    0    0    0 29 29   1   0   0   0   0
6    1    1    1    0    0    0    0    0    0    0  7 24   1   0   0   0   0
  C66 C67 C701 C702 C703 C704 C705 C706 C707 C708 C709 C710 C711 C712 C713 C8
1   0   0    1    0    0    0    0    1    1    0    1    0    0    0    0  2
2   0   0    1    1    0    0    0    0    1    0    1    0    0    0    0  4
3   0   0    0    0    0    0    0    0    1    0    1    0    0    0    0  4
4   0   0    1    1    1    1    0    0    0    0    1    1    0    0    0  1
5   0   0    1    1    0    1    0    0    0    0    0    0    0    0    0  4
6   0   0    1    0    0    0    0    0    1    0    1    0    0    0    0  4
  C10 C10_C_1 C11 C12 C12_C_1 C13 C14 C15 C161 C162 C163 C164 C165 C166 C167
1   1       3   1   1       4   2   4   3    1    0    0    0    0    0    0
2   1       0   2   1       3   2   3   1    0    1    1    1    0    0    0
3   1       1   1   1       3   2   3   5   NA   NA   NA   NA   NA   NA   NA
4   1       5   2   1       7   2   2   5   NA   NA   NA   NA   NA   NA   NA
5   1      24   2   1       5   1   3   5   NA   NA   NA   NA   NA   NA   NA
6   1       2   1   1       2   2   2   5   NA   NA   NA   NA   NA   NA   NA
  C1701 C1702 C1703 C1704 C1705 C1706 C1707 C1708 C1709 C1710 C1711 C1712 C1713
1     1     0     0     0     0     0     0     0     1     0     0     0     0
2     1     1     1     1     1     1     1     0     1     1     0     0     0
3    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
4    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
5    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
6    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
  C18 C19 C2001 C2002 C2003 C2004 C2005 C2006 C2007 C2008 C2009 C2010 C211 C212
1   4   1     1     0     0     0     0     0     0     0     0     0    1    0
2   1   2     1     0     0     0     0     1     0     0     0     0    0    1
3  NA   2     1     1     0     0     0     0     0     0     0     0    1    0
4  NA   4     0     0     1     0     0     0     0     0     0     0    1    0
5  NA   1     1     0     0     0     0     0     0     0     0     0    1    0
6  NA   1     1     1     0     0     0     0     0     0     0     0    1    0
  C213 C214 C215 C216 C217 C221 C222 C223 C224 C225 C226 C227 C228 C23 C24
1    0    0    0    0    0    1    0    1    1    0    0    0    0   3   2
2    0    0    0    0    0    0    1    0    0    1    0    0    0   1   1
3    0    0    0    0    0    0    0    1    0    0    0    0    0   3   1
4    0    0    0    0    0    0    0    1    0    0    0    0    0   3   2
5    0    0    0    0    0    0    0    1    0    0    0    0    0   3   2
6    0    0    0    0    0    0    0    1    0    0    0    0    0   3   2
  C2601 C2602 C2603 C2604 C2605 C2606 C2607 C2608 C2609 C2610 C2611 C2612 C2613
1     1     0     0     1     0     0     0     1     0     1     0     0     0
2     1     1     0     1     1     0     1     1     0     1     0     0     1
3     1     0     0     0     0     1     0     0     1     1     0     0     0
4     0     0     1     0     0     0     0     0     0     0     0     0     0
5     0     1     0     0     0     0     0     0     0     0     1     0     0
6     1     1     0     1     0     0     0     0     0     1     0     0     0
  C2614 C2615 C2616 C2617 C2618 C2701 C2702 C2703 C2704 C2705 C2706 C2707 C2708
1     0     0     0     0     0     1     0     0     1     0     0     0     0
2     0     0     0     0     0     1     1     0     0     1     0     0     1
3     0     0     0     0     0     0     0     0     0     0     0     0     0
4     0     0     0     0     0     0     0     1     0     0     0     1     0
5     0     0     0     0     0     0     1     0     0     0     0     0     0
6     0     0     0     0     0     0     1     0     1     0     0     0     0
  C2709 C2710 C2711 C2712 C2713 C2714 C2715 C2716 C2717 C2718 C2801 C2802 C2803
1     0     0     0     0     0     0     0     0     0     0     0     0     0
2     0     0     0     0     0     0     0     0     0     0     0     0     0
3     0     0     0     0     0     0     0     0     0     1     0     0     0
4     0     0     0     0     0     0     0     0     0     0     0     0     0
5     0     0     1     0     0     0     0     0     0     0     0     0     0
6     0     0     0     0     0     0     0     0     0     0     0     0     0
  C2804 C2805 C2806 C2807 C2808 C2809 C2810 C2811 C2812 C2813 C2814 C2815 C2816
1     0     0     0     0     0     0     0     0     0     0     0     1     1
2     0     0     1     0     0     0     0     0     0     0     0     0     0
3     0     0     0     0     0     0     0     0     0     0     0     0     1
4     0     0     0     0     1     0     0     0     1     0     0     0     0
5     0     0     0     0     1     0     0     0     0     0     0     0     0
6     0     0     0     0     1     0     0     0     0     0     0     1     0
  C2817 C2818 C2901 C2902 C2903 C2904 C2905 C2906 C2907 C2908 C2909 C2910 C2911
1     0     0     0     0     0     0     0     1     0     0     0     1     0
2     0     0     1     0     0     1     0     1     0     1     1     1     1
3     0     0     0     0     1     0     0     1     1     0     0     1     1
4     0     0     0     0     0     0     0     0     0     0     0     1     1
5     0     0     0     0     0     0     0     0     0     0     0     0     0
6     0     0     0     0     0     0     0     1     0     0     0     1     0
  C2912 C2913 C2914 C2915 C2916 C2917 C30 C31 C3201 C3202 C3203 C3204 C3205
1     1     0     1     0     0     0   2   2     1     0     0     0     0
2     0     0     1     0     0     0   1   2     1     0     0     0     0
3     1     0     0     0     0     0   1   5    NA    NA    NA    NA    NA
4     0     0     0     0     0     0   2   5    NA    NA    NA    NA    NA
5     0     0     1     0     0     0   3   5    NA    NA    NA    NA    NA
6     0     0     1     0     0     0   1   4     0     1     0     0     0
  C3206 C3207 C3208 C3209 C3210 C331 C332 C333 C334 C335 C336 C337 C341 C342
1     0     0     0     0     0    1    0    0    0    0    0    0    0    0
2     1     0     0     0     0    0    1    0    1    0    0    0    0    1
3    NA    NA    NA    NA    NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
4    NA    NA    NA    NA    NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
5    NA    NA    NA    NA    NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
6     0     0     0     0     0    1    0    0    0    0    0    0    0    0
  C343 C344 C345 C346 C347 C348 C35 C36 C3801 C3802 C3803 C3804 C3805 C3806
1    1    0    0    0    0    0   3   2     0     0     0     1     0     0
2    0    0    1    0    0    0   2   1     0     1     0     1     1     0
3   NA   NA   NA   NA   NA   NA  NA  NA    NA    NA    NA    NA    NA    NA
4   NA   NA   NA   NA   NA   NA  NA  NA    NA    NA    NA    NA    NA    NA
5   NA   NA   NA   NA   NA   NA  NA  NA    NA    NA    NA    NA    NA    NA
6    1    0    0    0    0    0   3   2     0     0     0     0     0     0
  C3807 C3808 C3809 C3810 C3811 C3812 C3813 C3814 C3815 C3816 C3817 C3818 C3901
1     0     0     0     1     0     0     0     0     0     0     0     0     0
2     1     1     0     1     0     0     1     0     0     0     0     0     0
3    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
4    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
5    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
6     0     0     0     1     0     1     0     0     0     0     0     0     0
  C3902 C3903 C3904 C3905 C3906 C3907 C3908 C3909 C3910 C3911 C3912 C3913 C3914
1     0     0     1     0     0     0     0     0     1     0     0     0     0
2     1     0     1     1     0     0     0     0     0     0     0     1     0
3    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
4    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
5    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
6     0     0     0     0     0     0     0     0     0     0     0     0     0
  C3915 C3916 C3917 C3918 C4001 C4002 C4003 C4004 C4005 C4006 C4007 C4008 C4009
1     0     0     0     0     0     0     0     0     0     0     0     0     0
2     0     0     0     0     0     0     0     0     0     0     0     0     0
3    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
4    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
5    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
6     0     0     0     1     0     0     0     0     0     0     0     0     0
  C4010 C4011 C4012 C4013 C4014 C4015 C4016 C4017 C4018 C4101 C4102 C4103 C4104
1     0     0     0     0     0     1     1     0     0     0     0     0     0
2     0     0     0     0     0     0     1     0     0     1     1     0     1
3    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
4    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
5    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
6     0     0     0     0     0     1     0     0     0     0     1     0     1
  C4105 C4106 C4107 C4108 C4109 C4110 C4111 C4112 C4113 C4114 C4115 C4116 C4117
1     0     0     0     0     0     0     0     0     0     1     0     0     0
2     0     0     0     0     1     0     0     0     0     0     0     0     0
3    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
4    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
5    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
6     0     0     0     0     0     0     0     0     1     1     0     0     0
  C42 D101 D102 D103 D104 D105 D106 D107 D108 D109 D110 D111 D112 D113 D114
1   4    0    0    0    0    0    0    0    0    1    1    0    0    0    0
2   1    1    1    1    1    1    1    1    1    1    1    1    0    1    1
3  NA    0    1    1    0    1    0    0    0    0    0    1    0    1    0
4  NA    0    0    0    0    0    0    0    0    0    0    0    1    1    0
5  NA    0    0    0    0    0    0    0    0    0    1    0    0    0    0
6   4    1    0    0    0    1    0    0    0    0    1    0    0    1    0
  D115 D116 D117 D2 D31 D32 D33 D34 D35 D36 D37 D38 D39 D41 D42 D43 D44 D5 D6
1    0    0    0  1   0   1   0   1   0   0   0   0   0   0   1   0   0  3  2
2    0    0    0  2   0   0   0   0   1   0   0   0   0  NA  NA  NA  NA  2  2
3    0    0    0  1   1   1   1   0   0   0   0   0   0  NA  NA  NA  NA  1  2
4    0    0    0  1   1   0   0   0   0   0   0   0   0  NA  NA  NA  NA  3  1
5    0    0    0  3   1   1   0   0   0   0   0   0   0  NA  NA  NA  NA  3  2
6    0    0    0  1   1   1   1   0   0   0   0   0   0  NA  NA  NA  NA  2  2
  D8 Radio E2 E2_C_1 E3      E4 E501 E502 E503 E504 E505 E506 E507 E508 E509
1  4     1  1      1  1 109.000    0    0    1    1    0    0    0    0    1
2  2     0 NA        NA      NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
3  1     1  1      2  1 182.718    0    0    0    1    0    0    0    0    0
4  1     1  1      2  3   5.000    0    0    0    0    0    0    0    0    0
5  4     1  2        NA 294.000    0    0    0    0    0    0    0    0    0
6  1     1  1      1  1 181.719    0    0    0    1    0    0    1    0    1
  E510 E511 E512 E513 E514 E6 E7 E81 E82 E83 E84 E85 E86 E87 E88 E89 E8BIS
1    0    0    0    0    0  2  1   1   0   0   0   0   1   0   0   0     1
2   NA   NA   NA   NA   NA NA  1   0   0   1   0   0   0   0   0   0     1
3    1    0    0    0    0  1  1   1   0   1   0   0   1   0   0   0     1
4    0    1    0    0    0  2  5   1   0   0   0   0   1   1   0   0     3
5    0    1    0    0    0  2  3   0   0   0   0   0   0   1   0   0     3
6    0    0    0    0    0  2  1   0   0   0   0   0   1   0   0   0     1
  E1001 E1002 E1003 E1004 E1005 E1006 E1007 E1008 E1009 E1010 E1011 E1012 E1013
1     0     0     0     1     0     0     0     0     1     0     0     0     0
2     0     0     0     0     0     0     1     0     0     0     0     0     0
3     1     0     0     1     0     0     0     0     1     1     1     0     0
4     1     0     0     0     0     0     0     0     0     0     1     0     1
5     1     0     0     0     0     0     0     0     0     1     0     0     0
6     1     0     1     0     0     0     0     0     1     1     0     0     0
  E1014 E1015 E1201 E1202 E1203 E1204 E1205 E1206 E1207 E1208 E1209 E1210 E1211
1     0     0     0     0     0     1     0     0     0     0     1     0     0
2     0     0     0     0     0     0     0     0     1     0     0     0     0
3     0     0     0     0     0     0     0     0     0     0     1     0     0
4     0     0     1     0     1     0     0     0     0     0     0     0     1
5     0     0     0     0     0     0     0     0     0     0     0     0     0
6     0     0     0     0     0     1     0     0     0     0     0     0     0
  E1212 E1213 E1214 E1215 E1301 E1302 E1303 E1304 E1305 E1306 E1307 E1308 E1309
1     0     0     0     0     0     0     0     0     0     1     1     0     0
2     0     0     0     0     0     0     0     0     0     0     0     0     0
3     0     0     0     0     0     0     0     0     0     0     1     0     0
4     0     0     0     0     0     0     0     0     0     0     0     1     0
5     0     0     1     0     0     0     0     0     0     0     0     0     0
6     0     0     0     0     0     0     0     0     0     0     1     1     0
  E1310 E1311 E1312 E1313 E1314 E1315 E1401 E1402 E1403 E1404 E1405 E1406 E1407
1     0     1     1     0     0     0     1     0     0     0     0     0     0
2     0     1     1     0     0     0     1     0     1     1     0     1     1
3     0     0     0     0     0     0     1     1     0     0     0     0     0
4     1     0     0     0     0     0     0     0     0     0     0     0     0
5     0     0     0     1     0     0     0     0     0     0     0     0     0
6     0     1     0     0     0     0     0     0     1     1     0     0     0
  E1408 E1409 E1410 E1411 E1412 E1413 E1414 E1415 E1416 E1417 E15 E17 E18 E19
1     0     0     1     1     0     0     0     0     0     0   1   2   4   1
2     0     0     0     0     1     0     1     1     0     0   1   1   2   1
3     0     0     1     1     0     0     0     1     0     0   1   2   3   1
4     0     0     1     1     0     0     1     1     0     0   1  NA  NA   1
5     0     0     1     0     0     0     0     0     0     0   1   4   4   4
6     0     0     0     1     0     0     1     0     0     0   1   3   4   1
  Library F21 F22 F23 F24 F25 F3 F3BIS01 F3BIS02 F3BIS03 F3BIS04 F3BIS05
1       1  NA  NA  NA  NA  NA  5      NA      NA      NA      NA      NA
2       0  NA  NA  NA  NA  NA  4       0       0       0       0       0
3       1  NA  NA  NA  NA  NA  5      NA      NA      NA      NA      NA
4       1  NA  NA  NA  NA  NA  5      NA      NA      NA      NA      NA
5       1  NA  NA  NA  NA  NA  5      NA      NA      NA      NA      NA
6       1  NA  NA  NA  NA  NA  5      NA      NA      NA      NA      NA
  F3BIS06 F3BIS07 F3BIS08 F3BIS09 F3BIS10 F4 F5 F601 F602 F603 F604 F605 F606
1      NA      NA      NA      NA      NA NA  2    0    1    1    0    0    0
2       0       1       0       0       0  4  4   NA   NA   NA   NA   NA   NA
3      NA      NA      NA      NA      NA NA  3    0    0    0    0    0    0
4      NA      NA      NA      NA      NA NA  3    0    0    0    0    0    0
5      NA      NA      NA      NA      NA NA  4   NA   NA   NA   NA   NA   NA
6      NA      NA      NA      NA      NA NA  4   NA   NA   NA   NA   NA   NA
  F607 F608 F609 F610 F611 F612 F613 F614 F615 F616 F617 F618 F619 F620 F701
1    0    0    0    0    0    0    0    0    1    0    0    0    0    0    0
2   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
3    0    1    1    0    0    0    0    1    0    1    0    0    0    0    0
4    0    0    0    0    0    0    0    0    0    0    1    0    0    0    0
5   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
6   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
  F702 F703 F704 F705 F706 F707 F708 F709 F710 F711 F712 F713 F714 F715 F716
1    1    1    0    0    0    0    0    0    0    0    0    0    0    1    0
2   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
3    0    0    0    0    0    0    0    1    0    0    0    0    0    0    0
4    0    0    0    0    0    0    0    0    0    0    0    0    0    0    1
5   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
6   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
  F717 F718 F719 F720 F801 F802 F803 F804 F805 F806 F807 F808 F809 F810 F811
1    0    0    0    0    0    0    0    0    0    0    0    0    0    0    1
2   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
3    0    0    0    0    0    0    1    0    0    0    0    0    0    0    1
4    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
5   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
6   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
  F812 F813 F814 F815 F816 F817 F818 F819 F820 F9 F11 F11BIS F11TER F121 F122
1    0    0    0    0    0    0    0    0    0  2   2      2      3    1    0
2   NA   NA   NA   NA   NA   NA   NA   NA   NA NA  NA     NA     NA   NA   NA
3    0    0    0    0    0    0    0    0    0  2   3      2      2    1    0
4    0    0    0    0    0    0    0    1    0  1   4      3      3    1    0
5   NA   NA   NA   NA   NA   NA   NA   NA   NA NA  NA     NA     NA   NA   NA
6   NA   NA   NA   NA   NA   NA   NA   NA   NA NA  NA     NA     NA   NA   NA
  F123 F124 F125 F126 F12BIS F13 F13_C_1 F14 F15 F15_C_1 F1601 F1602 F1603
1    0    0    0    0     NA   1      10  NA  NA       0     0     0     0
2   NA   NA   NA   NA     NA  NA       0  NA  NA       0    NA    NA    NA
3    0    0    0    0     NA   1      12   1   1       9     1     1     1
4    0    0    0    0     NA   1       3  NA  NA       0     0     0     0
5   NA   NA   NA   NA     NA  NA       0  NA  NA       0    NA    NA    NA
6   NA   NA   NA   NA     NA  NA       0  NA  NA       0    NA    NA    NA
  F1604 F1605 F1606 F1607 F1608 F1609 F1610 F1611 F1612 F1613 F1614 F1615 F1616
1     1     0     0     0     0     0     0     0     0     0     0     0     0
2    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
3     0     0     0     0     0     0     0     0     0     0     0     0     0
4     0     0     0     0     0     0     0     0     0     0     0     0     1
5    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
6    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
  F1617 F1618 F17 G2401 G2402 G2403 G2404 G2405 G2406 G2407 G2408 G2409 G2410
1     0     0   1     1     0     0     0     0     0     0     0     1     0
2    NA    NA  NA     0     0     0     0     0     0     0     0     0     0
3     0     0   1     1     0     1     1     0     0     0     0     1     1
4     0     0   4     1     0     0     0     0     0     0     0     0     0
5    NA    NA  NA     0     0     0     0     0     0     0     0     0     0
6    NA    NA  NA     1     0     0     1     0     0     0     0     0     0
  G2411 G2412 Concert G2414 G2415 G2501 G2502 G2503 G2504 G2505 G2506 G2507
1     0     0       1     0     0     0     0     0     0     0     0     0
2     0     0       0     0     0    NA    NA    NA    NA    NA    NA    NA
3     1     1       1     0     0     1     0     0     0     0     0     0
4     0     0       1     0     0     0     0     0     0     0     0     0
5     0     0       0     0     0    NA    NA    NA    NA    NA    NA    NA
6     0     0       1     0     0     0     0     0     1     0     0     0
  G2508 G2509 G2510 G2511 G2512 G2513 G2514 G2515 G26val_variet_francaise
1     0     0     0     0     0     1     0     0                      NA
2    NA    NA    NA    NA    NA    NA    NA    NA                      NA
3     0     0     0     0     1     0     0     0                       1
4     0     0     0     0     0     1     0     0                      NA
5    NA    NA    NA    NA    NA    NA    NA    NA                      NA
6     0     0     0     0     0     0     0     0                      NA
  G26val_musiques_monde G26val_musiques_tradi G26val_variet_internationale
1                    NA                    NA                           NA
2                    NA                    NA                           NA
3                    NA                    NA                           NA
4                    NA                    NA                           NA
5                    NA                    NA                           NA
6                    NA                    NA                            1
  G26val_rnb G26val_electro_techno G26val_hip_hop_rap G26val_metal_hard
1         NA                    NA                 NA                NA
2         NA                    NA                 NA                NA
3         NA                    NA                 NA                NA
4         NA                    NA                 NA                NA
5         NA                    NA                 NA                NA
6         NA                    NA                 NA                NA
  G26val_pop_rock G26val_jazz G26val_opera G26val_musique_classique
1              NA          NA           NA                       NA
2              NA          NA           NA                       NA
3              NA          NA           NA                        1
4              NA          NA           NA                       NA
5              NA          NA           NA                       NA
6              NA          NA           NA                       NA
  G26unit_variet_francaise G26unit_musiques_monde G26unit_musiques_tradi
1                       NA                     NA                     NA
2                       NA                     NA                     NA
3                        3                     NA                     NA
4                       NA                     NA                     NA
5                       NA                     NA                     NA
6                       NA                     NA                     NA
  G26unit_variet_internationale G26unit_rnb G26unit_electro_techno
1                            NA          NA                     NA
2                            NA          NA                     NA
3                            NA          NA                     NA
4                            NA          NA                     NA
5                            NA          NA                     NA
6                             3          NA                     NA
  G26unit_hip_hop_rap G26unit_metal_hard G26unit_pop_rock G26unit_jazz
1                  NA                 NA               NA           NA
2                  NA                 NA               NA           NA
3                  NA                 NA               NA           NA
4                  NA                 NA               NA           NA
5                  NA                 NA               NA           NA
6                  NA                 NA               NA           NA
  G26unit_opera G26unit_musique_classique G271 G272 G273 G274 G275 G276 G277
1            NA                        NA   NA   NA   NA   NA   NA   NA   NA
2            NA                        NA   NA   NA   NA   NA   NA   NA   NA
3            NA                         3    1    0    0    0    0    0    0
4            NA                        NA   NA   NA   NA   NA   NA   NA   NA
5            NA                        NA   NA   NA   NA   NA   NA   NA   NA
6            NA                        NA    1    0    0    0    0    0    0
  G278 G28 G29 G3001 G3002 G3003 G3004 G3005 G3006 G3007 G3008 G3009 G3010 G31
1   NA  NA  NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA  NA
2   NA  NA  NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA  NA
3    0   2   2     0     1     0     0     1     0     0     0     0     0   1
4   NA  NA  NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA  NA
5   NA  NA  NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA  NA
6    0   2   2     0     1     1     0     0     1     0     0     0     0   1
  G11 G12 G13 G14 G15 G16 G17 G18 G211 G212 G213 G214 G215 G216 G217 G218 G3A
1   0   0   1   1   1   0   0   0    0    0    1    0    0    0    0    0   2
2   0   0   0   1   0   0   0   0    0    0    0    0    0    1    0    0   1
3   0   1   1   1   1   0   0   0    0    0    1    1    0    0    0    0   1
4   0   0   1   0   0   0   0   0    0    0    0    0    0    1    0    0   2
5   0   0   0   0   0   1   0   0   NA   NA   NA   NA   NA   NA   NA   NA   2
6   0   0   1   1   1   0   0   0    0    0    0    1    0    0    0    0   1
  G3B G6BIS G4 G4_C_1 G5 G6 G701 G702 G703 G704 G705 G706 G707 G708 G709 G710
1   1     2 NA     NA NA NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
2  NA     2  1      6  3  2    1    1    0    0    1    0    1    0    0    0
3  NA     2  1      2  3  2    0    0    0    0    0    1    0    0    0    0
4   2     2 NA     NA NA NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
5   1     2 NA     NA NA NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
6  NA     2  1      6  3  2    1    1    0    1    1    0    0    0    0    0
  G711 G712 G713 G714 G715 G716 G717 G718 G8 G9 G1001 G1002 G1003 G1004 G1005
1   NA   NA   NA   NA   NA   NA   NA   NA NA NA    NA    NA    NA    NA    NA
2    0    0    1    0    0    0    0    0  1 NA     0     0     0     0     0
3    0    0    0    0    0    0    0    0  2  2     0     1     0     0     1
4   NA   NA   NA   NA   NA   NA   NA   NA NA NA    NA    NA    NA    NA    NA
5   NA   NA   NA   NA   NA   NA   NA   NA NA NA    NA    NA    NA    NA    NA
6    0    0    0    0    0    0    0    0  2  2     0     1     0     0     0
  G1006 G1007 G1008 G1009 G1010 G111 G121 G122 G123 G124 G125 G126 G127 G131
1    NA    NA    NA    NA    NA   NA    1    1    1    1    0    0    0    0
2     1     0     0     0     0    2    0    1    1    1    0    0    0    0
3     0     0     0     0     0    1    1    1    1    1    0    0    0    0
4    NA    NA    NA    NA    NA   NA    0    0    1    0    0    0    0    0
5    NA    NA    NA    NA    NA   NA    0    0    1    0    0    0    0    0
6     0     0     0     0     0    1    0    0    1    1    0    0    0    0
  G132 G133 G134 G135 G136 G137 G14val_danse G14val_cirque G14val_spectacle_rue
1    0    1    0    0    0    0           NA            NA                    2
2    0    0    0    1    0    0           NA            NA                   NA
3    0    0    0    1    0    0           NA            NA                   NA
4    0    1    0    0    0    0           NA            NA                    1
5    0    0    0    1    0    0           NA            NA                   NA
6    0    1    1    0    0    0           NA            NA                    1
  G14val_theatre G14unit_danse G14unit_cirque G14unit_spectacle_rue
1             NA            NA             NA                     3
2             NA            NA             NA                    NA
3             NA            NA             NA                    NA
4             NA            NA             NA                     3
5             NA            NA             NA                    NA
6              4            NA             NA                     3
  G14unit_theatre G161 G162 G163 G164 G165 G166 G167 G171 G172 G173 G174 G175
1              NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
2              NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
3              NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
4              NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
5              NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
6               3   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
  G176 G17B01 G17B02 G17B03 G17B04 G17B05 G17B06 G17B07 G17B08 G17B09 G17B10
1   NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
2   NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
3   NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
4   NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
5   NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
6   NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
  G181 G182 G183 G184 G185 G186 G187 G188 G189 G20A1 G20A2 G20A3 G20A4 G20A5
1    1    0    1    0    0    0    0    0    0    NA    NA    NA    NA    NA
2   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA
3   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA
4    1    0    0    0    0    0    0    0    0    NA    NA    NA    NA    NA
5   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA
6    1    0    1    0    0    0    0    0    0     0     0     1     1     0
  G20A6 G20A7 G20B G21 G2201 G2202 G2203 G2204 G2205 G2206 G2207 G2208 G2209
1    NA    NA   NA  NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
2    NA    NA   NA  NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
3    NA    NA   NA  NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
4    NA    NA   NA  NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
5    NA    NA   NA  NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
6     0     0    2   2     0     1     0     0     0     1     0     0     0
  G2210 G23 G32 G331 G332 G333 G334 G335 G336 G337 G338 G339 G351 G352 G353
1    NA   3   2   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
2    NA  NA   2   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
3    NA  NA   1    1    0    0    0    0    0    0    0    0    1    0    0
4    NA   4   2   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
5    NA  NA   2   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
6     0   1   2   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
  G354 G355 G356 G357 G36 G37 G3801 G3802 G3803 G3804 G3805 G3806 G3807 G3808
1   NA   NA   NA   NA  NA  NA    NA    NA    NA    NA    NA    NA    NA    NA
2   NA   NA   NA   NA  NA  NA    NA    NA    NA    NA    NA    NA    NA    NA
3    0    0    0    0   2   2     0     1     0     0     0     0     0     0
4   NA   NA   NA   NA  NA  NA    NA    NA    NA    NA    NA    NA    NA    NA
5   NA   NA   NA   NA  NA  NA    NA    NA    NA    NA    NA    NA    NA    NA
6   NA   NA   NA   NA  NA  NA    NA    NA    NA    NA    NA    NA    NA    NA
  G3809 G3810 G39 H101 H102 H103 H104 H105 H106 H107 H108 H109 H110 H111
1    NA    NA  NA    0    1    0    1    0    0    0    0    1    1    0
2    NA    NA  NA    1    1    1    1    0    1    1    1    1    1    1
3     0     0   2    0    0    1    1    0    1    1    0    1    1    0
4    NA    NA  NA    0    0    1    1    0    0    1    0    1    0    0
5    NA    NA  NA    0    0    1    1    0    0    0    0    0    0    0
6    NA    NA  NA    1    1    1    1    0    1    1    1    1    1    0
  Museums H113 H114 H201 H202 H203 H204 H205 H206 H207 H208 H209 H210 H211 H212
1       1    0    0    0    0    0    0    0    0    0    0    1    0    0    0
2       1    0    0    1    1    1    0    0    1    1    0    1    1    1    0
3       1    0    0    0    0    0    0    0    0    0    0    0    1    0    0
4       1    0    0    0    0    1    0    0    0    0    0    0    0    0    0
5       1    0    0    0    0    0    0    0    0    0    0    0    0    0    1
6       1    0    0    0    0    0    0    0    1    0    0    1    0    0    0
  H214 H215 H301 H302 H303 H304 H305 H306 H307 H308 H309 H310 H4 H4_C_1 H4F H51
1    0    0   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA NA     NA  NA  NA
2    0    0    1    1    1    0    1    0    0    0    0    0  1      5   3   1
3    0    0    0    0    0    0    1    0    0    0    0    0  1      1   3   1
4    0    0   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA NA     NA  NA  NA
5    0    0   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA NA     NA  NA  NA
6    0    0   NA   NA   NA   NA   NA   NA   NA   NA   NA   NA NA     NA  NA  NA
  H52 H53 H54 H55 H56 H57 H6 H7 H801 H802 H803 H804 H805 H806 H807 H808 H809
1  NA  NA  NA  NA  NA  NA NA NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
2   0   1   1   0   0   0  3  3    0    0    0    0    1    0    1    0    0
3   0   0   0   0   0   0  2  1    0    1    0    0    1    0    0    0    0
4  NA  NA  NA  NA  NA  NA NA NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
5  NA  NA  NA  NA  NA  NA NA NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
6  NA  NA  NA  NA  NA  NA NA NA   NA   NA   NA   NA   NA   NA   NA   NA   NA
  H810 H9 H1001 H1002 H1003 H1004 H1005 H1006 H1007 H1008 H1009 H1010 H11
1   NA NA     1     1     1     1     1     1     0     0     0     0   1
2    0  3     1     1     1     1     1     0     0     0     0     0   1
3    0  2     0     0     0     0     0     0     0     1     0     0  NA
4   NA NA     0     0     0     0     0     0     0     1     0     0  NA
5   NA NA     0     0     0     0     0     0     0     1     0     0  NA
6   NA NA     1     1     1     1     0     0     0     0     0     0   1
  H11_C_1 H11F H121 H122 H123 H124 H125 H126 H127 H13 H14 H1501 H1502 H1503
1      10    3    1    0    0    0    0    0    0   2   1     1     1     0
2      10    3    1    0    1    1    0    0    0   3   3     0     0     0
3      NA   NA   NA   NA   NA   NA   NA   NA   NA  NA  NA    NA    NA    NA
4      NA   NA   NA   NA   NA   NA   NA   NA   NA  NA  NA    NA    NA    NA
5      NA   NA   NA   NA   NA   NA   NA   NA   NA  NA  NA    NA    NA    NA
6       3    3    1    0    1    1    0    0    0   1  NA     0     1     0
  H1504 H1505 H1506 H1507 H1508 H1509 H1510 H16 I101 I102 I103 I104 I105 I106
1     0     1     1     0     0     0     0   1    1    1    1    1    0    0
2     0     1     0     1     0     0     0   2    0    1    0    1    1    1
3    NA    NA    NA    NA    NA    NA    NA  NA    1    1    0    1    1    0
4    NA    NA    NA    NA    NA    NA    NA  NA    1    1    0    1    0    0
5    NA    NA    NA    NA    NA    NA    NA  NA    1    1    0    0    0    0
6     0     0     1     0     0     0     0   1    0    1    1    1    0    0
  I107 I108 I109 I110 I111 I112 I113 I114 I115 I2 I3 Internet I5 I6 I71 I72 I73
1    1    1    0    0    1    1    0    0    0  1  3        1  2 NA   0   0   0
2    1    0    1    1    1    1    0    0    0  3  3        1  1  1   0   0   0
3    1    0    1    1    1    1    0    0    0  1  3        1  1  1   1   0   0
4    1    0    0    0    1    0    0    0    0  1 NA        0  2 NA  NA  NA  NA
5    0    0    0    0    1    0    0    0    0  1 NA        0  2 NA  NA  NA  NA
6    1    1    1    1    1    1    0    0    0  3  3        1  2 NA   1   0   0
  I74 I75 I76 I77 I78 I79 SITUA TRAVAIL ACTIVANTE STATUTECL STATUT CS2D
1   0   0   0   1   0   0     1      NA        NA         3      3   48
2   0   0   0   1   0   0     3       2         2        NA     NA   NA
3   0   0   0   0   0   0     1      NA        NA         8      2   33
4  NA  NA  NA  NA  NA  NA     5       2         1        NA     NA   NA
5  NA  NA  NA  NA  NA  NA     5       2         1        NA     NA   NA
6   0   0   0   0   0   0     1      NA        NA         6      6   37
  TYPEMPLOI TEMPTRAV SUPERVISION CLASSIF CLASSIF2 SALARIES
1         6       NA           1       4       NA       NA
2        NA       NA          NA      NA       NA       NA
3         6        1           3      NA        5       NA
4        NA       NA          NA      NA       NA       NA
5        NA       NA          NA      NA       NA       NA
6         6       NA           1      NA       NA        3
                ACTIVLIB STATUTECLANTE STATUTANTE CS2D_ante SUPERVISIONANTE
1  Transport automobiles            NA         NA        NA              NA
2                                   NA         NA        NA              NA
3 Bailleur public social            NA         NA        NA              NA
4                                    3          3        56               3
5                                    3          3        64               3
6             Restaurant            NA         NA        NA              NA
  CLASSIFANTE CLASSIFANTE2 RECHEMPLOI S10 S10_C_1 S11 S11_C_1 S12 S12_C_1
1          NA           NA          3   1       5   1      35   1      30
2          NA           NA         NA  NA      NA  NA          NA        
3          NA           NA          3   1       5   1      38   1     110
4           6           NA          3  NA      NA  NA          NA        
5           2           NA          3  NA      NA  NA          NA        
6          NA           NA          3   1       7   1      45   1       3
  SITUA_conj TRAVAIL_conj ACTIVANTE_conj STATUTECL_conj STATUT_conj CS2D_conj
1         NA           NA             NA             NA          NA        NA
2         NA           NA             NA             NA          NA        NA
3          1           NA             NA              1           1        42
4          5            2              1             NA          NA        NA
5         NA           NA             NA             NA          NA        NA
6          1           NA             NA              3           3        37
  TYPEMPLOI_conj TEMPTRAV_conj SUPERVISION_conj CLASSIF_conj CLASSIF2_conj
1             NA            NA               NA           NA            NA
2             NA            NA               NA           NA            NA
3              6             1                3           NA             5
4             NA            NA               NA           NA            NA
5             NA            NA               NA           NA            NA
6              6            NA                3            5            NA
  SALARIES_conj     ACTIVLIB_conj STATUTECLANTE_conj STATUTANTE_conj
1            NA                                   NA              NA
2            NA                                   NA              NA
3            NA        Coll\xe8ge                 NA              NA
4            NA                                    3               3
5            NA                                   NA              NA
6            NA Assurance maladie                 NA              NA
  CS2D_ante_conj SUPERVISIONANTE_conj CLASSIFANTE_conj CLASSIFANTE2_conj
1             NA                   NA               NA                NA
2             NA                   NA               NA                NA
3             NA                   NA               NA                NA
4             68                    3                1                NA
5             NA                   NA               NA                NA
6             NA                   NA               NA                NA
  RECHEMPLOI_conj AGDIP DATDIP DATDIP_C_1 DIPLOM DIPLOMACT FORMEL NAIM NAIP
1              NA    NA      1       1976      6        NA      2    1    1
2              NA    NA      1       2017      5         4      1   NA   NA
3               3    NA      1       1993     10        NA      2    1    1
4               3    NA     NA         NA      2        NA      2    2    2
5              NA    NA      1       1966      4        NA      2    1    1
6               3    NA      1       1983      6        NA      2    1    1
  NATIO1N1 NATIO1N2 NATIO1N3 NATIO1N4 NATIO1N5 NATIO1N6 NATIOM NATIOP SPECIAL
1        1        0        0        0        0        0      1      1      NA
2        1        0        0        0        0        0      1      1      NA
3        1        0        0        0        0        0      1      1     315
4        0        0        1        0        0        0      2      2      NA
5        1        0        0        0        0        0      1      1      NA
6        1        0        0        0        0        0      1      1      NA
  SPECIAL_CODE_CITE_13 SPECIALACT SPECIALACT_CODE_CITE_13 AGDIP_conj
1                   NA         NA                      NA         NA
2                   NA        708                     732         NA
3                  421         NA                      NA         NA
4                   NA         NA                      NA         NA
5                   NA         NA                      NA         NA
6                   NA         NA                      NA         NA
  DATDIP_conj DATDIP_C_1_conj DIPLOM_conj DIPLOMACT_conj FORMEL_conj NAIM_conj
1          NA              NA          NA             NA          NA        NA
2          NA              NA          NA             NA          NA        NA
3           1            1997          12             NA           2         1
4          NA              NA           1             NA           2         2
5          NA              NA          NA             NA          NA        NA
6           1            1981           7             NA           2         1
  NAIP_conj NATIO1N1_conj NATIO1N2_conj NATIO1N3_conj NATIO1N4_conj
1        NA            NA            NA            NA            NA
2        NA            NA            NA            NA            NA
3         1             1             0             0             0
4         2             0             0             1             0
5        NA            NA            NA            NA            NA
6         1             1             0             0             0
  NATIO1N5_conj NATIO1N6_conj NATIOM_conj NATIOP_conj SPECIAL_conj
1            NA            NA          NA          NA           NA
2            NA            NA          NA          NA           NA
3             0             0           1           1          805
4             0             0           2           2           NA
5            NA            NA          NA          NA           NA
6             0             0           1           1           NA
  SPECIAL_CODE_CITE_13_conj SPECIALACT_conj SPECIALACT_CODE_CITE_13_conj M1_SQ1
1                        NA              NA                           NA      3
2                        NA              NA                           NA      1
3                      1014              NA                           NA      1
4                        NA              NA                           NA      4
5                        NA              NA                           NA      4
6                        NA              NA                           NA      1
  M1_SQ2 M1_SQ3 M1_SQ4 M1_SQ5 M1_SQ7 M1_SQ8 M1_SQ9 M1_SQ10 M1_SQ11 M1_SQ12 M201
1      1      1      1      4      4      2      4       2       2       4    1
2      2      3      1      1      1      1      4       3       1       2    0
3      1      1      1      3      4      4      4       4       4       3    1
4      4      4      4      4      4      4      4       4       4       4    0
5      4      4      5      4      4      4      4       4       4       4    0
6      1      3      2      1      4      4      4       4       4       4    1
  M202 M203 M204 M205 M206 M207 M208 M209 M210 M211 M212 M213 M214 M215 M216
1    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
2    0    0    0    1    0    0    0    0    0    0    0    0    0    0    0
3    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
4    0    0    0    0    0    0    0    0    0    0    0    0    1    0    0
5    0    0    0    0    0    0    0    0    0    0    0    0    1    0    0
6    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
  M301 M302 M303 M304 M305 M306 M307 M308 M309 M310 M311 M312 M313 M314 M315
1    1    0    0    0    0    0    0    0    0    0    0    0    0    0    0
2    1    1    0    1    0    0    0    0    0    0    0    0    0    0    0
3    1    0    0    0    0    0    0    0    0    0    0    0    0    0    0
4    0    0    0    0    0    0    0    0    0    0    0    0    0    1    0
5    0    0    0    0    0    0    0    0    0    0    0    0    0    0    1
6    1    0    0    0    0    0    0    0    0    0    0    0    0    0    0
  M316 M401 M402 M403 M404 M405 M406 M407 M408 M409 M410 M7_1 M7_2 M7_3 M81 M82
1    0    1    1    0    0    0    0    0    0    0    0   NA   NA   NA  NA  NA
2    0    1    1    0    0    0    0    0    0    0    0   NA   NA   NA  NA  NA
3    0    1    1    0    0    0    0    0    0    0    0   NA   NA   NA  NA  NA
4    0    1    1    0    0    0    0    0    0    0    0   NA   NA   NA  NA  NA
5    0    1    1    0    0    0    0    0    0    0    0   NA   NA   NA  NA  NA
6    0    1    1    0    0    0    0    0    0    0    0   NA   NA   NA  NA  NA
  adulte_enfance1 adulte_enfance2 adultes_enfance M9_adulte1 M9_BIS1_adulte1
1              NA              NA              12         NA              NA
2               1               2              12          1              NA
3              NA              NA              12         NA              NA
4               1               2              12          6              NA
5               1               2              12          1              NA
6               1               2              12          1              NA
  M9_BIS2_adulte1 M9_adulte2 M9_BIS1_adulte2 M9_BIS2_adulte2 M121 M122 M123
1              NA         NA              NA              NA    1    0    0
2              NA          1              NA              NA    0    1    0
3              NA         NA              NA              NA    1    0    0
4              NA          6              NA              NA    0    1    0
5              NA          1              NA              NA    1    0    0
6              NA          1              NA              NA    0    1    0
  M124 M125 M14 M16 M17 M18 STATUTECLCD_PER STATUTCD_PER CSTOT_PER
1    0    0   2   1   1   1               3            3        65
2    0    0   2   2  NA   1               1            1        53
3    0    0   1   2  NA   1               1            1        52
4    0    0   1   1   4   1               7            7        21
5    0    0   2   1   1   1               3            3        67
6    0    0   1   1   2   1               7            7        21
  CLASSIFCD_PER1 CLASSIFCD_PER2 M19 M20 STATUTECLCD_MER STATUTCD_MER CSTOT_MER
1              2             NA   6   1               4            4        56
2             NA              4   7   1               2            2        52
3             NA              6   4   1               3            3        55
4             NA             NA   1   2              NA           NA        99
5              8             NA  14   1               3            3        54
6             NA             NA   6   1               5            5        21
  CLASSIFCD_MER1 CLASSIFCD_MER2 M21 CATLOGAC EMMENAG EMMENAG_C_1 STOC ACC
1              6             NA  14        1       1        1959    2   2
2             NA              6   3        1       1        2012    5   2
3              6             NA   4        1       1        2002    2   2
4             NA             NA   1        1       1        1991    2   2
5              6             NA  14        1       1        2003    2   2
6             NA             NA   2        1       1        1991    2   2
  C9_anglais C9_espagnol C9_portugais C9_italien C9_allemand C9_arabe
1        Non         Non          Non        Non         Non      Non
2                                                                    
3                                                                    
4        Non         Non          Oui        Non         Non      Non
5                                                                    
6                                                                    
  C9_autreslangues C25_anglais C25_espagnol C25_portugais C25_italien
1              Oui                                                   
2                          Oui          Oui           Non         Oui
3                          Oui          Non           Non         Non
4              Non                                                   
5                                                                    
6                                                                    
  C25_allemand C25_arabe C25_coreen C25_japonais C25_autreslangues C37_anglais
1                                                                             
2          Non       Non        Non          Non               Non         Non
3          Non       Non        Non          Non               Non            
4                                                                             
5                                                                             
6                                                                             
  C37_espagnol C37_italien C37_allemand C37_arabe C37_japonais
1                                                             
2          Oui         Non          Non       Non          Non
3                                                             
4                                                             
5                                                             
6                                                             
  C37_autreslangues D7_anglais D7_espagnol D7_italien D7_allemand D7_portugais
1                                                                             
2               Non                                                           
3                                                                             
4                          Non         Non        Non         Non          Oui
5                                                                             
6                                                                             
  D7_arabe D7_autreslangues E16_anglais E16_espagnol E16_italien E16_allemand
1                                   Oui          Non         Non          Non
2                                   Oui          Non         Non          Non
3                                   Oui          Non         Non          Non
4      Non              Non         Non          Non         Non          Non
5                                   Non          Non         Non          Non
6                                   Oui          Non         Non          Non
  E16_portugais E16_arabe E16_turc E16_chinois E16_coreen E16_japonais
1           Non       Non      Non         Non        Non          Non
2           Non       Non      Non         Non        Non          Non
3           Non       Non      Non         Non        Non          Non
4           Oui       Non      Non         Non        Non          Non
5           Non       Non      Non         Non        Non          Non
6           Non       Non      Non         Non        Non          Non
  E16_russe E16_autreslangues F10_anglais F10_espagnol F10_italien F10_allemand
1       Non               Non                                                  
2       Non               Non                                                  
3       Non               Non                                                  
4       Non               Non         Non          Non         Non          Non
5       Non               Non                                                  
6       Non               Non                                                  
  F10_portugais F10_arabe F10_autreslangues M13_anglais M13_espagnol
1                                                                   
2                                                   Oui          Non
3                                                                   
4           Oui       Non               Non         Non          Non
5                                                                   
6                                                   Oui          Non
  M13_italien M13_allemand M13_portugais M13_arabe M13_autreslangues
1                                                                   
2         Oui          Non           Non       Non               Non
3                                                                   
4         Non          Non           Oui       Non               Non
5                                                                   
6         Non          Non           Non       Non               Non
  M15_anglais M15_espagnol M15_italien M15_allemand M15_portugais M15_arabe
1                                                                          
2                                                                          
3         Oui          Non         Non          Oui           Non       Non
4         Non          Non         Non          Non           Oui       Non
5                                                                          
6         Oui          Non         Non          Non           Non       Non
  M15_autreslangues   Sex satisfaction Income Health Couple age_group  identity
1                     Men          Low Medium   Good     No   [54-67[ 0.8624142
2                     Men       Medium   High   Good     No   [15-38[ 0.5073268
3               Non   Men         High   High    Bad    Yes   [38-54[ 0.3504244
4               Non Women         High    Low Medium    Yes   [54-67[ 0.3681533
5                     Men         High    Low Medium     No   [54-67[ 0.4284777
6               Non   Men          Low   High   Good    Yes   [38-54[ 0.3848315
      indice identity_scale    distance distance_abs categories categories_abs
1  2.8024423 Very Masculine  3.36401698   3.36401698  Masculine    Medium_high
2  0.5427446              3  0.63666730   0.63666730   Feminine   Low Distance
3 -0.4557477              2 -0.56846635   0.56846635   Feminine   Low Distance
4 -0.3429253              2  0.41247337   0.41247337   Feminine   Low Distance
5  0.0409659              2  0.03104383   0.03104383   Feminine   Low Distance
6 -0.2367887              2 -0.30419303   0.30419303   Feminine   Low Distance
        score score_normalise    score_scale mean_score_by_gender
1 -4.52584900       0.1067749 Very Masculine            0.4137961
2 -0.80993757       0.3608291              2            0.4137961
3  2.24496525       0.5696906              3            0.4137961
4  4.48418742       0.7227846              5            0.5901366
5  0.09049424       0.4223909              2            0.4137961
6  1.11249266       0.4922643              3            0.4137961
  distance_to_mean_gender    score_2 score_normalise_2 distance_abs_score
1             0.307021220 -5.4681668         0.1263350         3.82750957
2             0.052967004 -2.3094860         0.3395942         0.38380971
3             0.155894524  1.1723856         0.5746737         1.32236409
4             0.132647980  3.8301811         0.7541155         0.37252086
5             0.008594876 -0.5929046         0.4554897         1.11934247
6             0.078468180 -0.2073913         0.4815177         0.03890948
  norm_status
1 Hors normes
2     Normaux
3     Normaux
4     Normaux
5     Normaux
6     Normaux</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer la proportion de "hors normes"</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>total_individuals <span class="ot">&lt;-</span> <span class="fu">nrow</span>(my_data_frame)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>hors_normes <span class="ot">&lt;-</span> <span class="fu">sum</span>(my_data_frame<span class="sc">$</span>norm_status <span class="sc">==</span> <span class="st">"Hors normes"</span>)</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>proportion_hors_normes <span class="ot">&lt;-</span> hors_normes <span class="sc">/</span> total_individuals</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>proportion_hors_normes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04710851</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer la répartition des individus "hors normes" par niveau de satisfaction</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>table_satisfaction_hors_normes <span class="ot">&lt;-</span> <span class="fu">table</span>(my_data_frame<span class="sc">$</span>norm_status, my_data_frame<span class="sc">$</span>satisfaction)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir en pourcentage</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>table_satisfaction_hors_normes_percent <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(table_satisfaction_hors_normes, <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>table_satisfaction_hors_normes_percent</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             
                  High      Low   Medium
  Hors normes 27.58621 47.35632 25.05747
  Normaux     34.09556 37.50853 28.39590</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation de la proportion d'individus "hors normes"</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">Status =</span> <span class="fu">c</span>(<span class="st">"Normaux"</span>, <span class="st">"Hors normes"</span>), </span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Proportion =</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">-</span> proportion_hors_normes, proportion_hors_normes)),</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Status, <span class="at">y =</span> Proportion, <span class="at">fill =</span> Status)) <span class="sc">+</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(Proportion)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Proportion d'individus Hors Normes vs Normaux"</span>,</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Statut"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>) <span class="sc">+</span></span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation avec boxplot pour la distance à la moyenne par niveau de satisfaction</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my_data_frame, <span class="fu">aes</span>(<span class="at">x =</span> satisfaction, <span class="at">y =</span> distance_abs_score, <span class="at">fill =</span> norm_status)) <span class="sc">+</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">"red"</span>, <span class="at">outlier.size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Normaux"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Hors normes"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot de la distance à la moyenne par niveau de satisfaction"</span>,</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Satisfaction"</span>, <span class="at">y =</span> <span class="st">"Distance à la moyenne (Distance absolue)"</span>) <span class="sc">+</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions de 'score_scale' par genre</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>table_score_gender <span class="ot">&lt;-</span> <span class="fu">table</span>(my_data_frame<span class="sc">$</span>score_scale, my_data_frame<span class="sc">$</span>Sex)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>table_score_gender_percent <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(table_score_gender, <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span>  <span class="co"># Calcul par genre</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>table_score_gender_percent</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                
                         Men       Women
  Very Masculine  0.43248438  0.00000000
  1               8.55358001  0.41403785
  2              46.44401730  8.28075710
  3              39.76453628 40.63485804
  4               4.42095147 32.63012618
  5               0.36040365 15.49684543
  Very Feminine   0.02402691  2.54337539</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions de 'satisfaction' par genre</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>table_satisfaction_gender <span class="ot">&lt;-</span> <span class="fu">table</span>(my_data_frame<span class="sc">$</span>satisfaction, my_data_frame<span class="sc">$</span>Sex)</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>table_satisfaction_gender_percent <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(table_satisfaction_gender, <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span>  <span class="co"># Calcul par genre</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>table_satisfaction_gender_percent</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        
              Men    Women
  High   35.15399 32.66917
  Low    35.80366 39.75143
  Medium 29.04235 27.57940</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation de la répartition des scores par genre</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">as.data.frame</span>(table_score_gender_percent), </span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Freq, <span class="at">fill =</span> Var2)) <span class="sc">+</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"pink"</span>)) <span class="sc">+</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Répartition des scores par genre"</span>,</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Score (1-7)"</span>, <span class="at">y =</span> <span class="st">"Proportion (%)"</span>) <span class="sc">+</span></span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">scale =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(Freq <span class="sc">/</span> <span class="dv">100</span>)), </span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau croisé des proportions de satisfaction par score_scale et genre</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>table_satisfaction_score_gender <span class="ot">&lt;-</span> <span class="fu">table</span>(my_data_frame<span class="sc">$</span>satisfaction, my_data_frame<span class="sc">$</span>score_scale, my_data_frame<span class="sc">$</span>Sex)</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les proportions par genre et score_scale</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>table_satisfaction_score_gender_percent <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(table_satisfaction_score_gender, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>table_satisfaction_score_gender_percent</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>, ,  = Men

        
         Very Masculine         1         2         3         4         5
  High         33.33333  28.08989  34.30052  37.46973  36.95652  40.00000
  Low          38.88889  44.10112  36.63212  33.23245  34.78261  26.66667
  Medium       27.77778  27.80899  29.06736  29.29782  28.26087  33.33333
        
         Very Feminine
  High         0.00000
  Low          0.00000
  Medium     100.00000

, ,  = Women

        
         Very Masculine         1         2         3         4         5
  High                   19.04762  30.47619  36.55340  29.28010  31.67939
  Low                    52.38095  42.14286  35.63107  42.64973  42.11196
  Medium                 28.57143  27.38095  27.81553  28.07018  26.20865
        
         Very Feminine
  High        29.45736
  Low         44.18605
  Medium      26.35659</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation avec un graphique à barres empilées</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">as.data.frame</span>(table_satisfaction_score_gender_percent), </span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Var2, <span class="at">y =</span> Freq, <span class="at">fill =</span> Var1)) <span class="sc">+</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span>  <span class="co"># Barres empilées</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"green"</span>)) <span class="sc">+</span>  <span class="co"># Couleurs pour chaque niveau de satisfaction</span></span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Répartition de la satisfaction par score et genre"</span>,</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Score (1-7)"</span>, <span class="at">y =</span> <span class="st">"Proportion (%)"</span>) <span class="sc">+</span></span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Var3) <span class="sc">+</span>  <span class="co"># Facette par genre</span></span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">scale =</span> <span class="dv">1</span>)) <span class="sc">+</span>  <span class="co"># Format de pourcentage</span></span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb156-12"><a href="#cb156-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(Freq <span class="sc">/</span> <span class="dv">100</span>)), </span>
<span id="cb156-13"><a href="#cb156-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>))  <span class="co"># Positionner les étiquettes au centre des barres</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(my_data_frame<span class="sc">$</span>score_scale)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Very Masculine              1              2              3              4 
            18            377           2353           3716           1839 
             5  Very Feminine 
           801            130 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des proportions de satisfaction par score_scale et genre</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>table_satisfaction_score_gender <span class="ot">&lt;-</span> <span class="fu">table</span>(my_data_frame<span class="sc">$</span>satisfaction, my_data_frame<span class="sc">$</span>score_scale, my_data_frame<span class="sc">$</span>Sex)</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des proportions par score_scale et genre</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>table_satisfaction_score_gender_percent <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(table_satisfaction_score_gender, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(table_satisfaction_score_gender_percent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>, ,  = Men

        
         Very Masculine         1         2         3         4         5
  High         33.33333  28.08989  34.30052  37.46973  36.95652  40.00000
  Low          38.88889  44.10112  36.63212  33.23245  34.78261  26.66667
  Medium       27.77778  27.80899  29.06736  29.29782  28.26087  33.33333
        
         Very Feminine
  High         0.00000
  Low          0.00000
  Medium     100.00000

, ,  = Women

        
         Very Masculine         1         2         3         4         5
  High                   19.04762  30.47619  36.55340  29.28010  31.67939
  Low                    52.38095  42.14286  35.63107  42.64973  42.11196
  Medium                 28.57143  27.38095  27.81553  28.07018  26.20865
        
         Very Feminine
  High        29.45736
  Low         44.18605
  Medium      26.35659</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir la table de proportions en dataframe</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>table_satisfaction_score_gender_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(table_satisfaction_score_gender_percent)</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Renommer les colonnes pour plus de clarté</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(table_satisfaction_score_gender_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Satisfaction"</span>, <span class="st">"Score"</span>, <span class="st">"Sex"</span>, <span class="st">"Proportion"</span>)</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir la table de proportions en dataframe</span></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>table_satisfaction_score_gender_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(table_satisfaction_score_gender_percent)</span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Renommer les colonnes pour plus de clarté</span></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(table_satisfaction_score_gender_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Satisfaction"</span>, <span class="st">"Score"</span>, <span class="st">"Sex"</span>, <span class="st">"Proportion"</span>)</span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation simple avec ggplot</span></span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(table_satisfaction_score_gender_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(Score), <span class="at">y =</span> Proportion, <span class="at">fill =</span> <span class="fu">factor</span>(Satisfaction))) <span class="sc">+</span></span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span>  <span class="co"># Barres empilées</span></span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Satisfaction par Score et Genre"</span>, </span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Score"</span>, <span class="at">y =</span> <span class="st">"Proportion (%)"</span>) <span class="sc">+</span></span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Sex)  <span class="co"># Facette par sexe</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CGNI_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(my_data_frame, <span class="at">file =</span> <span class="st">"my_data_frame.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-akerlof_economics_2000-1" class="csl-entry" role="listitem">
Akerlof, George A., and R. Kranton. 2000a. <span>“Economics and Identity.”</span> <em>Quarterly Journal of Economics</em> 115: 715–53. <a href="https://doi.org/10.1162/003355300554881">https://doi.org/10.1162/003355300554881</a>.
</div>
<div id="ref-akerlof_economics_2000" class="csl-entry" role="listitem">
Akerlof, George A., and Rachel E. Kranton. 2000b. <span>“Economics and Identity.”</span> <em>The Quarterly Journal of Economics</em> 115 (3): 715–53. <a href="https://www.jstor.org/stable/2586894">https://www.jstor.org/stable/2586894</a>.
</div>
<div id="ref-akerlof" class="csl-entry" role="listitem">
Akerlof, George A, and Rachel E Kranton. n.d. <span>“Identity and Schooling: Some Lessons for the Economics of Education,”</span> 36.
</div>
<div id="ref-austen-smith_economic_2005" class="csl-entry" role="listitem">
Austen-Smith, D., and Roland G. Fryer. 2005. <span>“An Economic Analysis of <span>‘Acting White’</span>.”</span> <em>Quarterly Journal of Economics</em> 120: 551–83. <a href="https://doi.org/10.1093/QJE/120.2.551">https://doi.org/10.1093/QJE/120.2.551</a>.
</div>
<div id="ref-benabou_incentives_2004" class="csl-entry" role="listitem">
Bénabou, R., and J. Tirole. 2004. <span>“Incentives and Prosocial Behavior.”</span> <em><span>IZA</span> Institute of Labor Economics Discussion Paper Series</em> null: null. <a href="https://doi.org/10.2139/ssrn.639043">https://doi.org/10.2139/ssrn.639043</a>.
</div>
<div id="ref-chakravarty_religious_2015" class="csl-entry" role="listitem">
Chakravarty, Surajeet, Miguel A. Fonseca, S. Ghosh, and S. Marjit. 2015. <span>“Religious Fragmentation , Social Identity and Cooperation : Evidence from an Artefactual Field Experiment in India ∗.”</span> <a href="https://doi.org/10.1016/j.euroecorev.2015.12.006">https://doi.org/10.1016/j.euroecorev.2015.12.006</a>.
</div>
<div id="ref-charness_identities_2014" class="csl-entry" role="listitem">
Charness, G., Ramón Cobo-Reyes, and Natalia Jiménez. 2014. <span>“Identities, Selection, and Contributions in a Public-Goods Game.”</span> <em>Games Econ. Behav.</em> 87: 322–38. <a href="https://doi.org/10.1016/J.GEB.2014.05.002">https://doi.org/10.1016/J.GEB.2014.05.002</a>.
</div>
<div id="ref-chen_group_2009" class="csl-entry" role="listitem">
Chen, Yan, and S. Li. 2009. <span>“Group Identity and Social Preferences.”</span> <em>The American Economic Review</em> 99: 431–57. <a href="https://doi.org/10.1257/AER.99.1.431">https://doi.org/10.1257/AER.99.1.431</a>.
</div>
<div id="ref-cipriani" class="csl-entry" role="listitem">
Cipriani, Enzo, Charles-Edouard Giguère, Eugénie Samson, Ioana Cotocea, and Robert-Paul Juster. n.d. <span>“Comment mesurer indirectement le genre en recherche sur les humains?”</span> 21.
</div>
<div id="ref-fryer_empirical_2010" class="csl-entry" role="listitem">
Fryer, Roland G., Roland G. Fryer, and Paul Torelli. 2010. <span>“An Empirical Analysis of <span>‘Acting White’</span>.”</span> <em>Journal of Public Economics</em> 94: 380–96. <a href="https://doi.org/10.1016/J.JPUBECO.2009.10.011">https://doi.org/10.1016/J.JPUBECO.2009.10.011</a>.
</div>
<div id="ref-octobre_loisirs_2008" class="csl-entry" role="listitem">
Octobre, Sylvie. 2008. <span>“Loisirs culturels et construction du genre au sein de la famille:”</span> <em>Agora débats/jeunesses</em> N° 47 (1): 98–110. <a href="https://doi.org/10.3917/agora.047.0098">https://doi.org/10.3917/agora.047.0098</a>.
</div>
<div id="ref-shih_domain-specific_2006" class="csl-entry" role="listitem">
Shih, Margaret, Todd L. Pittinsky, and Amy Trahan. 2006. <span>“Domain-Specific Effects of Stereotypes on Performance.”</span> <em>Self and Identity</em> 5 (1): 1–14. <a href="https://doi.org/10.1080/15298860500338534">https://doi.org/10.1080/15298860500338534</a>.
</div>
<div id="ref-trachman_tres_2022" class="csl-entry" role="listitem">
Trachman, Mathieu. 2022a. <span>“Très masculin, pas très féminine. Les variations sociales du genre:”</span> <em>Population &amp; Sociétés</em> N° 605 (10): 1–4. <a href="https://doi.org/10.3917/popsoc.605.0001">https://doi.org/10.3917/popsoc.605.0001</a>.
</div>
<div id="ref-trachman2022" class="csl-entry" role="listitem">
———. 2022b. <span>“Très masculin, pas très féminine. Les variations sociales du genre:”</span> <em>Population &amp; Sociétés</em> N° 605 (10): 14. <a href="https://doi.org/10.3917/popsoc.605.0001">https://doi.org/10.3917/popsoc.605.0001</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>